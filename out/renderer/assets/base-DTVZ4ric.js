import{j as e,r as s}from"./react-BohqOKG4.js";import{c as t}from"./clsx-BeLtu-UY.js";import{u as a,b as n,c as r,d as l}from"./@tanstack-3eZgfo06.js";import{l as i}from"./react-device-detect-CHs-JbVH.js";import{L as o}from"./react-lrc-DiTqQUZS.js";import{u as c,a as d,s as u,S as m,b as x,c as h,T as f,d as p,e as g,f as j,g as y,B as v,h as b,i as N,j as w,k,R as C,l as S,m as P,n as A,o as I,D as E,p as L,q as R,r as M,t as z,v as T,w as O,x as q,L as D,y as F,z as B,A as G,C as W,E as V,F as $,G as _,H as U,I as K,J as H,K as Y,M as Q,N as Z,O as J,P as X,Q as ee,U as se,V as te,W as ae,X as ne,Y as re,Z as le,_ as ie,$ as oe,a0 as ce,a1 as de,a2 as ue,a3 as me,a4 as xe,a5 as he,a6 as fe,a7 as pe,a8 as ge,a9 as je,aa as ye,ab as ve,ac as be,ad as Ne,ae as we,af as ke,ag as Ce,ah as Se,ai as Pe,aj as Ae,ak as Ie,al as Ee,am as Le,an as Re,ao as Me,ap as ze,aq as Te,ar as Oe,as as qe,at as De,au as Fe,av as Be,aw as Ge,ax as We}from"./index-Dw_5HS3q.js";import{u as Ve}from"./react-i18next-CJXO39OJ.js";import{P as $e,a as _e,b as Ue}from"./popover-CzAMUpib.js";import{a0 as Ke,a1 as He,a2 as Ye,a3 as Qe,a4 as Ze,a5 as Je,a6 as Xe,a7 as es,a8 as ss,a9 as ts,aa as as,ab as ns,ac as rs}from"./@radix-ui-LgTM4vlv.js";import{i as ls,X as is,j as os,e as cs,k as ds,l as us,m as ms,n as xs,o as hs,p as fs,q as ps,V as gs,r as js,s as ys,t as vs,A as bs,u as Ns,v as ws,w as ks,x as Cs,y as Ss,f as Ps,z as As,c as Is,B as Es,C as Ls,U as Rs,K as Ms,D as zs,I as Ts,J as Os,N as qs,d as Ds,O as Fs,Q as Bs,T as Gs,W as Ws,Y as Vs,Z as $s,_ as _s,$ as Us,a0 as Ks,a1 as Hs}from"./lucide-react-DrCvGt71.js";import{b as Ys}from"./react-lazy-load-image-component-DTPOgetJ.js";import{L as Qs}from"./react-router-dom-DLqO9Z-p.js";import{A as Zs,T as Js,a as Xs,b as et,R as st}from"./song-title-ClQcdcyq.js";import{D as tt}from"./data-table-list-CEoMo1BX.js";import{P as at,u as nt,a as rt,b as lt,C as it,E as ot}from"./play-button-BMYlYUiF.js";import{c as ct,a as dt,b as ut}from"./convertSecondsToTime-B1d9sDyx.js";import{D as mt}from"./vaul-DZIvWKBt.js";import{p as xt,g as ht}from"./podcasts-CyXJRW_v.js";import{M as ft}from"./react-fast-marquee-WxGvm3at.js";import{b as pt,f as gt,g as jt,a as yt,h as vt,O as bt}from"./react-router-C-_aAzNf.js";import{u as Nt}from"./react-hotkeys-hook-qKPfarcW.js";import{r as wt}from"./react-dom-DeCT9Zg9.js";import{r as kt}from"./@chriscodesthings-bGFwLvh6.js";import{E as Ct}from"./equalizer-bars-BP_G2EY6.js";import{D as St}from"./dot-Ccno5lbS.js";import{B as Pt}from"./react-toastify-Dcxz3wpx.js";import{a as At}from"./standardized-audio-context-DomkRFkE.js";import{A as It,a as Et,b as Lt,c as Rt,d as Mt,e as zt,f as Tt,g as Ot}from"./alert-dialog-Dv-UtMUK.js";import{q as qt}from"./queryKeys-DxXuT4IC.js";import{L as Dt,F as Ft,a as Bt,b as Gt,c as Wt,d as Vt,e as $t,f as _t}from"./form-Db6hBv4K.js";import{c as Ut}from"./use-debounce-CVLZIJWc.js";import{C as Kt,a as Ht,b as Yt,c as Qt,d as Zt,e as Jt,f as Xt}from"./command-9rYDq5Wc.js";import{g as ea}from"./podcasts-CYE4JVOZ.js";import{u as sa}from"./use-song-list-BzlADPub.js";import{o as ta}from"./lodash-DSAJ3Ow_.js";import{t as aa}from"./@hookform-CXDBdaWi.js";import{u as na}from"./react-hook-form-C23o4OKy.js";import{T as ra}from"./textarea-C40WEtvn.js";import{o as la,b as ia,s as oa}from"./zod-DxP4i6Pi.js";import{P as ca}from"./options-hS6iO596.js";import{r as da}from"./gridTools-sj1_E2oR.js";import{s as ua}from"./scrollPageToTop-WHsCYcia.js";import"./crypto-js-jXt9otfP.js";import"./ua-parser-js-oxSasMdn.js";import"./resize-observer-polyfill-C7U_o75s.js";import"./clrc-CLpXzmdn.js";import"./i18next-CM37CVQ3.js";import"./i18next-browser-languagedetector-F0gxWJsw.js";import"./tailwind-extended-shadows-merge-DdKC4l0c.js";import"./tailwind-merge-5Glu2Zmz.js";import"./class-variance-authority-DO3vQtTq.js";import"./zustand-Bqgea8iK.js";import"./immer-Dwi4ZIhD.js";import"./use-sync-external-store-C4iHanJs.js";import"./dayjs-BG2b1roC.js";import"./idb-keyval-PpvEIwUC.js";import"./fast-average-color-Dy3p1ZbH.js";import"./react-country-flag-DV3c0LTu.js";import"./@remix-run-C5FxfqAA.js";import"./scheduler-CuPG8W_I.js";import"./aria-hidden-DyxP-6dL.js";import"./react-remove-scroll-yCREhh_0.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BNI7vDx9.js";import"./react-style-singleton-C1oTdtRg.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-DQWw4Coi.js";import"./use-callback-ref-DIudPNPV.js";import"./@floating-ui-VDk0qcgD.js";import"./cover-image-zpWg5P0A.js";import"./cmdk-DpOb1GNg.js";import"./automation-events-CuFXW5ty.js";function ma(){const{currentSong:s}=c(),{t:t}=Ve(),{artist:n,title:r,duration:l}=s,{data:i,isLoading:o}=a({queryKey:["get-lyrics",n,r,l],queryFn:()=>x.lyrics.getLyrics({artist:n,title:r,duration:l})}),d=t("fullscreen.noLyrics"),u=t("fullscreen.loadingLyrics");return o?e.jsx(fa,{children:u}):i&&i.value?function(e){const s=e.value?.trim()??"";return s.startsWith("[00:")||s.startsWith("[01:")||s.startsWith("[02:")}(i)?e.jsx(xa,{lyrics:i}):e.jsx(ha,{lyrics:i}):e.jsx(fa,{children:d})}function xa({lyrics:a}){const n=d(),[r,l]=s.useState(0);setTimeout(()=>{let e=1e3*(n?.currentTime||0);e===r&&(e+=1),l(e)},50);return e.jsx("div",{className:"w-full h-full text-center font-semibold text-2xl 2xl:text-3xl px-2 lrc-box maskImage-big-player-lyrics",children:e.jsx(o,{lrc:a.value,recoverAutoScrollInterval:1500,currentMillisecond:r,id:"sync-lyrics-box",className:t("h-full overflow-y-auto",!i.isSafari&&"scroll-smooth"),verticalSpace:!0,lineRenderer:({active:s,line:a})=>e.jsx("p",{onClick:()=>{return e=a.startMillisecond,void(n&&(n.currentTime=e/1e3));var e},className:t("drop-shadow-lg my-5 cursor-pointer hover:opacity-100 duration-500","transition-[opacity,transform] motion-reduce:transition-none",s?"opacity-100 scale-125":"opacity-50"),children:a.content})})})}function ha({lyrics:a}){const{currentSong:n}=c(),r=s.useRef(null),l=a.value.split("\n");return s.useEffect(()=>{if(r.current){r.current.querySelector(u).scrollTo({top:0,behavior:"smooth"})}},[n]),e.jsx(m,{type:"always",className:"w-full h-full overflow-y-auto text-center font-semibold text-xl 2xl:text-2xl px-2 scroll-smooth",thumbClassName:"secondary-thumb-bar",ref:r,children:l.map((s,a)=>e.jsx("p",{className:t("leading-10 drop-shadow-lg text-balance",0===a&&"mt-6",a===l.length-1&&"mb-10"),children:s},a))})}function fa({children:s}){return e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsx("p",{className:"leading-10 drop-shadow-lg text-center font-semibold text-xl 2xl:text-2xl",children:s})})}const pa=s.forwardRef(({className:a,tooltipValue:n,variant:r="default",...l},i)=>{const o=e=>{e.preventDefault()},[c,d]=s.useState(!1);return e.jsxs(Ke,{ref:i,className:h("relative h-3 flex w-full touch-none select-none items-center cursor-pointer",a),onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),...l,children:[e.jsx(He,{className:t("relative h-1 w-full grow overflow-hidden rounded-full select-none","default"===r&&"bg-secondary","secondary"===r&&"bg-muted-foreground/70"),onContextMenu:o,children:e.jsx(Ye,{className:t("absolute h-full select-none rounded","default"===r&&"bg-primary","secondary"===r&&"bg-secondary-foreground"),onContextMenu:o})}),e.jsx(ga,{open:c&&void 0!==n,variant:r,value:n??"",align:"center",children:e.jsx(Qe,{className:t("block opacity-0 h-3 w-3 cursor-pointer select-none rounded-full","border-2 ring-offset-background transition-[background-color,opacity]","focus-visible:outline-none focus-visible:ring-transparent","disabled:pointer-events-none disabled:opacity-50 transform-gpu",c&&"opacity-100","default"===r&&"bg-foreground border-foreground","secondary"===r&&"bg-secondary-foreground border-secondary-foreground"),onKeyDown:e=>e.preventDefault()})})]})});function ga({open:a,value:n,variant:r,children:l,position:i,...o}){const c=s.useRef(null),d=s.useMemo(()=>{if(!i||!c.current)return;const e=c.current.getBoundingClientRect().width;return i-e/2},[i]);return e.jsx(f,{delayDuration:0,children:e.jsxs(p,{open:a,children:[e.jsx(g,{asChild:!0,children:l}),e.jsx(j,{ref:c,className:t("px-2 py-1","default"===r&&"bg-background","secondary"===r&&"bg-secondary-foreground border-muted-foreground/50 text-secondary font-semibold text-base"),sticky:"always",hideWhenDetached:!0,onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onPointerUp:e=>e.stopPropagation(),style:{cursor:"default"},alignOffset:d,...o,children:e.jsx("p",{children:n})})]})})}function ja(a){const{className:n,tooltipValue:r,tooltipTransformer:l,variant:i="default",onValueChange:o,...c}=a,d=s.useRef(null),u=s.useRef(null),[m,x]=s.useState(!1),[f,p]=s.useState(0),[g,j]=s.useState(0),y=a.max??0,v=s.useMemo(()=>m&&(void 0!==r||void 0!==l),[m,l,r]),b=s.useMemo(()=>void 0===l&&r?r:l?l(f):"",[f,l,r]),N=(e,s)=>{const t=e/s*y,a=Math.max(0,Math.round(t)),n=Math.max(0,Math.round(e))+1;j(n),p(a),u.current=null},w=e=>{o&&o([e]),p(e),(e=>{if(!d.current)return;const{width:s}=d.current.getBoundingClientRect(),t=e/y*100/100*s,a=Math.max(0,t)+1;j(a)})(e)},k=e=>{e.preventDefault()};return e.jsxs(Ke,{ref:d,className:h("relative h-3 flex w-full touch-none select-none items-center cursor-pointer",n),onMouseOver:e=>{const[s,t]=[e.clientX,e.clientY],a=((e,s)=>{if(!d.current)return;const t=d.current.getBoundingClientRect(),{right:a,left:n,top:r,bottom:l}={left:t.left-2,right:t.right,top:t.top-1.5,bottom:t.bottom+1};return{isInside:e>=n&&e<=a&&s>=r&&s<=l,left:n,right:a,top:r,bottom:l,width:t.width}})(s,t);if(!a)return;const{isInside:n,left:r,width:l}=a;n&&(u.current||(u.current=requestAnimationFrame(()=>N(s-r,l))),x(!0))},onMouseOut:()=>x(!1),onMouseMove:e=>{if(!d.current)return;const s=d.current.getBoundingClientRect(),t=e.clientX-s.left,a=s.width;u.current||(u.current=requestAnimationFrame(()=>N(t,a)))},onValueChange:([e])=>w(e),...c,children:[e.jsx(ga,{open:v,variant:i,value:b,position:g,align:"start",sideOffset:8,children:e.jsx(He,{className:t("relative h-1 w-full grow overflow-hidden rounded-full select-none","default"===i&&"bg-secondary","secondary"===i&&"bg-muted-foreground/70"),onContextMenu:k,children:e.jsx(Ye,{className:t("absolute h-full select-none transition-[border-radius]","default"===i&&"bg-primary","secondary"===i&&"bg-secondary-foreground",m?"rounded-none":"rounded"),onContextMenu:k})})}),e.jsx(Qe,{className:t("block opacity-0 h-3 w-3 cursor-pointer select-none rounded-full","border-2 transition-[background-color,opacity]","focus-visible:outline-none focus-visible:ring-transparent","disabled:pointer-events-none disabled:opacity-50 transform-gpu",m&&"opacity-100","default"===i&&"bg-foreground border-foreground","secondary"===i&&"bg-secondary-foreground border-secondary-foreground"),onKeyDown:e=>e.preventDefault()})]})}function ya(){const{useSongColorOnBigPlayer:s}=y();return e.jsx(ba,{children:e.jsxs(e.Fragment,{children:[e.jsx(Na,{showSeparator:!1}),s&&e.jsx(ka,{}),!s&&e.jsx(Ca,{})]})})}function va(){const{useSongColorOnQueue:s}=y();return e.jsx(ba,{children:e.jsxs(e.Fragment,{children:[e.jsx(wa,{showSeparator:!1}),s&&e.jsx(ka,{})]})})}function ba({children:s}){return e.jsxs($e,{children:[e.jsx(_e,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"icon",className:"size-10 rounded-full hover:bg-foreground/20 data-[state=open]:bg-foreground/20",children:e.jsx(ls,{className:"size-4",strokeWidth:2.5})})}),e.jsx(Ue,{className:"w-80 p-0",align:"end",children:e.jsx("div",{className:"flex flex-col",children:s})})]})}function Na(s){const{t:t}=Ve(),{useSongColorOnBigPlayer:a,setUseSongColorOnBigPlayer:n}=y();return e.jsx(Sa,{text:t("settings.appearance.colors.group"),...s,children:e.jsx(b,{checked:a,onCheckedChange:()=>n(!a)})})}function wa(s){const{t:t}=Ve(),{useSongColorOnQueue:a,setUseSongColorOnQueue:n}=y();return e.jsx(Sa,{text:t("settings.appearance.colors.group"),...s,children:e.jsx(b,{checked:a,onCheckedChange:()=>n(!a)})})}function ka(s){const{t:t}=Ve(),{currentSongColorIntensity:a,setCurrentSongIntensity:n}=y(),r=`${Math.round(100*a)}%`;return e.jsx(Sa,{text:t("settings.appearance.colors.queue.intensity"),...s,children:e.jsx(pa,{defaultValue:[a],min:.3,max:1,step:.05,tooltipValue:r,onValueChange:([e])=>n(e)})})}function Ca(s){const{t:t}=Ve(),{bigPlayerBlur:a,setBigPlayerBlurValue:n}=y();return e.jsx(Sa,{text:t("settings.appearance.colors.bigPlayer.blurSize"),...s,children:e.jsx(pa,{defaultValue:[a.value],min:a.settings.min,max:a.settings.max,step:a.settings.step,tooltipValue:`${a.value}px`,onValueChange:([e])=>n(e)})})}function Sa({text:s,className:t,children:a,showSeparator:n=!0,...r}){return e.jsxs(e.Fragment,{children:[n&&e.jsx(N,{}),e.jsxs("div",{className:h("flex items-center justify-between p-3",t),...r,children:[e.jsx("span",{className:"text-sm flex-1 text-balance",children:s}),e.jsx("div",{className:"w-2/5 flex items-center justify-end",children:a})]})]})}pa.displayName=Ke.displayName;const Pa=Ze;function Aa(){const{currentSong:s}=c(),{closeDrawer:t}=w(),a=k(s.coverArt,"song","900");return e.jsxs("div",{className:"mr-12 hidden lg:block w-[260px] lg:w-[320px] 2xl:w-[380px]",children:[e.jsx(Pa,{ratio:1,className:"shadow-header-image rounded-md overflow-hidden bg-accent",children:e.jsx(Ys.LazyLoadImage,{id:"song-info-image",src:a,effect:"opacity",alt:`${s.artist} - ${s.title}`,className:"rounded-md aspect-square object-cover text-transparent",width:"100%",height:"100%"})}),e.jsxs("div",{className:"flex flex-col items-center justify-center mt-6 px-1",children:[e.jsx("h4",{className:"scroll-m-20 text-xl font-semibold tracking-tight text-center text-balance drop-shadow-md",children:s.albumId?e.jsx(Qs,{to:C.ALBUM.PAGE(s.albumId),className:"hover:underline",onClick:t,children:s.title}):e.jsx(e.Fragment,{children:s.title})}),e.jsx("div",{className:"leading-5 mt-1 text-foreground/70 drop-shadow-md flex items-center justify-center flex-wrap gap-1",children:e.jsx(Ia,{song:s})})]})]})}function Ia({song:s}){const{closeDrawer:t}=w(),{artist:a,artistId:n,artists:r}=s;if(r&&r.length>1){const s=r.slice(0,Zs);return e.jsx(e.Fragment,{children:s.map(({id:a,name:n},r)=>e.jsxs("div",{children:[e.jsx(Ea,{id:a,name:n,onClick:t}),r<s.length-1&&","]},a))})}return e.jsx(Ea,{id:n,name:a,onClick:t})}function Ea({id:s,name:t,className:a,...n}){return e.jsx(Qs,{className:h(a,s?"hover:underline hover:text-foreground":"pointer-events-none"),to:C.ARTIST.PAGE(s??""),...n,children:t})}function La({row:s}){const{removeSongFromQueue:t}=S();return e.jsx(v,{variant:"ghost",className:"w-8 h-8 p-1 rounded-full hover:bg-background hover:shadow-sm",onClick:e=>{e.stopPropagation(),t(s.original.id)},onDoubleClick:e=>e.stopPropagation(),children:e.jsx(is,{className:"w-5 h-5"})})}function Ra(){const{t:t}=Ve(),a=A(),n=I(),{clearPlayerState:r,setSongList:l}=S(),i=s.useMemo(()=>[{id:"index",accessorKey:"index",style:{width:48,minWidth:48},header:"",cell:({row:s,table:t})=>{const a=s.index+1,n=s.original;return e.jsx(at,{trackNumber:a,trackId:n.id,handlePlayButton:()=>t.options.meta?.handlePlaySong?.(s)})}},{id:"title",accessorKey:"title",style:{flex:1,minWidth:150},header:"",cell:({row:s})=>e.jsx(Js,{song:s.original})},{id:"artist",accessorKey:"artist",style:{width:"30%",maxWidth:"30%"},header:"",cell:({row:s})=>{const{artist:t,artistId:a,artists:n}=s.original,{closeDrawer:r}=P.getState().actions;return n&&n.length>1?e.jsx(Xs,{artists:n,onClickLink:r}):a?e.jsx(et,{artistId:a,onClick:r,children:t}):s.original.artist}},{id:"album",accessorKey:"album",style:{width:"24%",minWidth:"14%",maxWidth:"24%"},className:"hidden lg:flex",enableSorting:!0,sortingFn:"customSortFn",header:"",cell:({row:s})=>{const{closeDrawer:t}=P.getState().actions;return e.jsx(Qs,{to:C.ALBUM.PAGE(s.original.albumId),className:"hover:underline truncate text-foreground/70 hover:text-foreground",onContextMenu:e=>{e.stopPropagation(),e.preventDefault()},onClick:t,children:s.original.album})}},{id:"duration",accessorKey:"duration",style:{width:80,maxWidth:80,minWidth:80},header:"",cell:({row:e})=>{const{duration:s}=e.original;return ct(s??0)}},{id:"remove",style:{width:60,maxWidth:60,minWidth:60},cell:({row:s})=>e.jsx(La,{row:s})}],[]),o=s.useMemo(()=>a.length,[a]),c=s.useMemo(()=>{let e=0;return a.forEach(s=>e+=s.duration),dt(e)},[a]);return e.jsxs("div",{className:"flex flex-1 flex-col h-full min-w-[300px]",children:[e.jsx(E,{className:"sr-only",children:t("queue.title")}),e.jsxs("div",{className:"flex items-center justify-between h-8 mb-2",children:[e.jsxs("div",{className:"flex gap-2 h-6 items-center text-foreground/70",children:[e.jsx("p",{className:"text-foreground",children:t("queue.title")}),e.jsx("p",{children:"•"}),e.jsx("p",{className:"text-sm",children:t("playlist.songCount",{count:o})}),e.jsx("p",{children:"•"}),e.jsx("p",{className:"text-sm",children:t("playlist.duration",{duration:c})})]}),e.jsx("div",{children:e.jsxs(v,{variant:"ghost",className:"px-4 h-8 rounded-full py-0 flex items-center justify-center hover:bg-foreground/20",onClick:r,children:[e.jsx(os,{className:"mr-1 w-5 h-5"}),e.jsx("span",{className:"text-sm",children:t("queue.clear")})]})})]}),e.jsx(N,{className:"bg-muted-foreground/20"}),e.jsx("div",{className:"w-full h-full overflow-auto",children:e.jsx(tt,{data:a,columns:i,columnFilter:["index","title","album","duration","remove"],showHeader:!1,handlePlaySong:e=>l(a,e.index),scrollToIndex:!0,currentSongIndex:n,allowRowSelection:!1,showContextMenu:!1,pageType:"queue"})})]})}const Ma=({shouldScaleBackground:s=!0,...t})=>e.jsx(mt.Root,{shouldScaleBackground:s,...t});Ma.displayName="Drawer";const za=mt.Trigger,Ta=mt.Portal,Oa=s.forwardRef(({className:s,...t},a)=>e.jsx(mt.Close,{ref:a,...t,className:h("outline-none focus-visible:outline-none focus-visible:ring-transparent",s)}));Oa.displayName=mt.Close.displayName;const qa=s.forwardRef(({className:s,...t},a)=>e.jsx(mt.Overlay,{ref:a,className:h("fixed inset-0 z-50 bg-black/80",s),...t}));qa.displayName=mt.Overlay.displayName;const Da=s.forwardRef(({className:s,children:t,showHandle:a=!0,...n},r)=>e.jsxs(Ta,{children:[e.jsx(qa,{}),e.jsxs(mt.Content,{ref:r,className:h("fixed inset-x-0 bottom-0 z-40 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",s),...n,children:[a&&e.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),t]})]}));Da.displayName="DrawerContent";const Fa=s.forwardRef(({className:s,...t},a)=>e.jsx(mt.Title,{ref:a,className:h("text-lg font-semibold leading-none tracking-tight",s),...t}));Fa.displayName=mt.Title.displayName;function Ba({active:s,children:t,className:a,...n}){return e.jsx("div",{className:h("w-full h-full absolute inset-0 opacity-0 pointer-events-none transition-opacity duration-300 bg-black/0",s&&"opacity-100 pointer-events-auto",a),...n,children:t})}function Ga({...s}){return e.jsx("div",{...s,children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"-rotate-45 absolute",style:{top:2},children:e.jsx("path",{d:"M5 12h14"})}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:14,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"-rotate-45 absolute",style:{top:7,left:2},children:e.jsx("path",{d:"M5 12h14"})})]})})}function Wa({size:s=24,...t}){return e.jsxs("svg",{width:s,height:s,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",...t,children:[e.jsx("path",{d:"M17 2l4 4-4 4",strokeWidth:t.strokeWidth??2,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M3 11v-1a4 4 0 014-4h14M7 22l-4-4 4-4",strokeWidth:t.strokeWidth??2,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 13v1a4 4 0 01-4 4H3M10 10l2-1v6",strokeWidth:t.strokeWidth??2,strokeLinecap:"round",strokeLinejoin:"round"})]})}s.forwardRef(({className:s,...t},a)=>e.jsx(mt.Description,{ref:a,className:h("text-sm text-muted-foreground",s),...t})).displayName=mt.Description.displayName;const Va={main:"w-9 h-9 p-0 rounded-full bg-secondary-foreground hover:scale-105 transition-transform will-change-transform",mainIcon:"text-secondary fill-secondary",secondary:"relative w-9 h-9 p-0 rounded-full text-secondary-foreground hover:text-secondary-foreground data-[state=active]:text-primary hover:bg-transparent hover:scale-110 transition-transform will-change-transform",secondaryIconFilled:"text-secondary-foreground fill-secondary-foreground",activeDot:"mini-player-button-active",style:{backfaceVisibility:"hidden"},removeRing:"focus-visible:ring-0 focus-visible:ring-transparent ring-0 ring-offset-transparent"};let $a=!1;function _a({children:a,gap:n}){const r=s.useRef(null),l=s.useRef(null),[i,o]=s.useState(!1),[c,d]=s.useState(!1),[u,m]=s.useState(""),[x,h]=s.useState(""),f=s.useCallback(()=>{if(!r.current||!l.current)return;const e=r.current.offsetWidth,s=l.current.offsetWidth>e;i&&!s&&m(Math.random().toString()),o(s)},[r,l,i]);return s.useLayoutEffect(()=>{const e=()=>{requestAnimationFrame(f)};return f(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[f]),s.useEffect(()=>{o(!1),d(!1),m(Math.random().toString()),h(Math.random().toString()),f()},[f,a]),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-full overflow-hidden whitespace-nowrap opacity-0 absolute left-0 right-0 bottom-0 pointer-events-none",ref:r,children:e.jsx("div",{className:"inline-flex",ref:l,children:a})},x),e.jsx("div",{children:e.jsx(ft,{className:t(i&&!c&&"maskImage-marquee-fade",c&&"maskImage-marquee-fade-finished"),speed:30,play:i,loop:2,delay:3,pauseOnHover:!0,onFinish:()=>{d(!0)},children:e.jsx("div",{className:n,children:a})},u)})]})}function Ua({song:s}){const{artistId:t,artist:a,artists:n}=s,r=pt();function l(e){e&&r(C.ARTIST.PAGE(e))}if(n&&n.length>1){const s=n.slice(0,Zs);return e.jsx("div",{className:"flex items-center gap-1 text-xs mini-player:text-[11px] maskImage-marquee-fade-finished",children:s.map(({id:t,name:a},n)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ka,{id:t,name:a,onClick:()=>l(t)}),n<s.length-1&&","]},t))})}return e.jsx(Ka,{id:t,name:a,onClick:()=>l(t)})}function Ka({id:s,name:t,className:a,...n}){return e.jsx("span",{className:h("w-fit max-w-full truncate text-xs font-normal text-foreground/70","mini-player:text-[11px] mini-player:font-light",a,s&&"hover:underline hover:text-foreground cursor-pointer"),...n,children:t})}function Ha({className:s,volume:t,size:a=24,...n}){const r=t>=50,l=t>0,i=0===t,o="opacity 300ms ease";return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:h("lucide lucide-volume2",s),...n,children:[e.jsx("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),e.jsx("path",{d:"M22 9L16 15",style:{transition:o,opacity:i?1:0}}),e.jsx("path",{d:"M16 9L22 15",style:{transition:o,opacity:i?1:0}}),e.jsx("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",style:{transition:o,opacity:l?1:0}}),e.jsx("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",style:{transition:o,opacity:r?1:0}})]})}function Ya(){const e=A();return{useAudioHotkeys:(s,t)=>{Nt(s,t,{preventDefault:!0,enabled:e.length>0})}}}function Qa({children:s}){return e.jsxs($e,{children:[e.jsx(_e,{asChild:!0,children:e.jsx(v,{variant:"ghost",className:"rounded-full w-10 h-10 p-2 text-secondary-foreground data-[state=open]:bg-accent",children:s})}),e.jsx(Ue,{className:"w-fit h-10 px-4 py-0 flex items-center rounded-full",side:"left",align:"center",children:e.jsx(Ja,{className:"w-24"})})]})}function Za({className:t,...a}){const{volume:n,setVolume:r,handleVolumeWheel:l}=V(),i=s.useRef(0),o=0===n;return e.jsx(v,{...a,variant:"ghost",size:"icon",className:h("p-1 w-7 h-7 hover:bg-transparent",t),onClick:function(){if(!i)return;const e=i.current,s=o?e>=1?e:100:0;i.current=n,r(s)},onWheel:function(e){const s=e.deltaY>0;l(s)}})}function Ja({disabled:s,className:t,...a}){const{volume:n,setVolume:r,handleVolumeWheel:l}=V(),{min:i,max:o,step:c}=_();return e.jsx(pa,{className:h("cursor-pointer w-32",t,s&&"pointer-events-none opacity-50"),"data-testid":"player-volume-slider",tooltipValue:n.toString(),...a,value:[n],min:i,max:o,step:c,disabled:s,onValueChange:([e])=>r(e),onWheel:function(e){const s=e.deltaY>0;l(s)}})}const Xa=s.memo(function(){const s=z(),a=T(),n=O(),{hasPrev:r,hasNext:l}=q(),{isPlayingOneSong:i,toggleShuffle:o,playNextSong:c,playPrevSong:d,togglePlayPause:u,toggleLoop:m}=S();return e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{size:"icon",variant:"ghost","data-state":a&&"active",className:t(Va.secondary,Va.removeRing,a&&Va.activeDot,"mini-player:hidden"),style:{...Va.style},onClick:()=>o(),disabled:i()||!l,children:e.jsx(ds,{size:18})}),e.jsx(v,{size:"icon",variant:"ghost",className:t(Va.secondary,Va.removeRing,"mini-player:hidden"),style:{...Va.style},onClick:()=>d(),disabled:!r,children:e.jsx(us,{className:Va.secondaryIconFilled,width:20})}),e.jsx(v,{size:"icon",variant:"link",className:h(Va.main,Va.removeRing,"mini-player:w-8 mini-player:h-8"),style:{...Va.style},onClick:()=>u(),children:s?e.jsx(ms,{className:Va.mainIcon,size:20,strokeWidth:.75,strokeLinecap:"square",strokeLinejoin:"round"}):e.jsx(xs,{className:Va.mainIcon,size:18,strokeWidth:1})}),e.jsx(v,{size:"icon",variant:"ghost",className:t(Va.secondary,Va.removeRing,"mini-player:w-8 mini-player:h-8"),style:{...Va.style},onClick:()=>c(),disabled:!l&&n!==D.All,children:e.jsx(hs,{className:Va.secondaryIconFilled,size:20})}),e.jsxs(v,{size:"icon",variant:"ghost","data-state":n!==D.Off&&"active",className:t(Va.secondary,Va.removeRing,n!==D.Off&&Va.activeDot,"mini-player:hidden"),onClick:()=>m(),style:{...Va.style},children:[n===D.Off&&e.jsx(fs,{size:18}),n===D.All&&e.jsx(fs,{size:18}),n===D.One&&e.jsx(Wa,{size:18})]})]})}),en=s.memo(function(){const s=F(),{starCurrentSong:a}=S();return e.jsx(v,{size:"icon",variant:"ghost",className:t(Va.secondary,Va.removeRing,"mini-player:hidden"),onClick:a,style:{...Va.style},children:e.jsx(ps,{className:t(s&&"text-red-500 fill-red-500"),size:18})})}),sn=s.memo(function(){const t=B(),[a,n]=s.useState(t),r=d(),l=G(),{setProgress:i}=S(),o=s.useCallback(e=>{$a=!1,r&&(r.currentTime=e)},[r]),c=s.useCallback(e=>{$a=!0,n(e)},[]),u=s.useCallback(e=>{o(e),i(e),n(e)},[i,o]),m=s.useCallback(()=>{a!==t&&(o(a),i(a))},[a,t,i,o]),x=ct($a?a:t);return e.jsxs("div",{className:"flex items-center flex-col",children:[e.jsxs("div",{className:"w-full flex justify-between text-foreground/70",children:[e.jsx("div",{className:"min-w-[40px] text-left text-[11px] font-light drop-shadow-md",children:x}),e.jsx("div",{className:"min-w-[40px] text-right text-[11px] font-light drop-shadow-md",children:ct(l??0)})]}),e.jsx(pa,{variant:"secondary",defaultValue:[0],value:$a?[a]:[t],max:l,step:1,className:"w-full h-4",onValueChange:([e])=>c(e),onValueCommit:([e])=>u(e),onPointerUp:m,onMouseUp:m})]})}),tn=s.memo(function(){const s=W();return e.jsx("div",{className:"min-w-[20%] h-full max-w-full aspect-square flex items-center justify-center rounded",children:e.jsx(Ys.LazyLoadImage,{src:k(s.coverArt,"song","500"),width:"100%",height:"100%",loading:"eager",className:"aspect-square object-cover object-center w-full max-w-full bg-skeleton text-transparent rounded shadow-md","data-testid":"track-image",alt:`${s.artist} - ${s.title}`})})}),an=s.memo(function(){const s=pt(),t=W();return e.jsxs("div",{className:"flex flex-col flex-1 justify-center max-w-full overflow-hidden",children:[e.jsx(_a,{gap:"mr-2",children:e.jsx("span",{className:h("text-base font-medium hover:underline cursor-pointer","mid-player:text-sm mini-player:text-xs mini-player:font-normal"),"data-testid":"track-title",onClick:function(){s(C.ALBUM.PAGE(t.albumId))},children:t.title})}),e.jsx(Ua,{song:t})]})}),nn=s.memo(function(){return e.jsxs("div",{className:"flex justify-between items-center gap-2 text-foreground/70",children:[e.jsx(gs,{className:"w-6 h-6 drop-shadow-lg",strokeWidth:1.75}),e.jsx(Ja,{variant:"secondary",className:"w-full",tooltipValue:void 0}),e.jsx(js,{className:"w-6 h-6 drop-shadow-lg",strokeWidth:1.75})]})});const rn=s.memo(function({pipWindow:e,children:t}){const{theme:a}=U();return s.useEffect(()=>{e&&(function(e,s){s.document.documentElement.classList.remove(...K),s.document.documentElement.classList.add(e)}(a,e),function(e){e.document.head.innerHTML=document.head.innerHTML}(e))},[e,a]),e?wt.createPortal(t,e.document.body):null}),ln=s.memo(function(){const{currentSongColor:s}=y();return e.jsxs("div",{className:"w-screen h-screen max-h-screen grid grid-rows-1 mid-player:grid-rows-floating-player gap-2 mid-player:gap-1 p-1 mid-player:p-2 mini-player:p-1.5 pb-4 mid-player:pb-4 relative",children:[e.jsxs("div",{className:t("w-full h-full gap-2 grid grid-rows-floating-player","mid-player:grid-rows-1 mid-player:grid-cols-mid-player-info mid-player:items-center","mini-player:grid-rows-1 mini-player:grid-cols-mini-player mini-player:items-center"),children:[e.jsx("div",{className:t("w-full h-full mid-player:aspect-square mini-player:aspect-square","flex flex-col items-center justify-center gap-2","default-gradient rounded-md mini-player:rounded","transition-[background-image,background-color] duration-1000 overflow-hidden","mid-player:!bg-transparent mid-player:from-transparent mid-player:to-transparent","mini-player:!bg-transparent mini-player:from-transparent mini-player:to-transparent"),style:{backgroundColor:s??void 0},children:e.jsxs("div",{className:t("flex w-full h-full relative p-3 justify-center items-center group bg-transparent","mid-player:min-h-fit mid-player:max-h-full mid-player:p-0 mid-player:aspect-square","mini-player:min-h-fit mini-player:max-h-full mini-player:p-0 mini-player:aspect-square"),children:[e.jsx(tn,{}),e.jsxs("div",{className:t("flex flex-col w-full gap-4 absolute inset-0","bg-gradient-to-b from-background/70 via-background/50 via-50% to-background to-90%","opacity-0 group-hover:opacity-100","transition-opacity duration-300","mid-player:hidden mini-player:hidden"),children:[e.jsx("div",{className:"flex flex-col flex-1 px-2 justify-center items-center absolute inset-0",children:e.jsx(Xa,{})}),e.jsx("div",{className:"mb-auto px-2 pt-0.5",children:e.jsx(nn,{})}),e.jsx("div",{className:"mt-auto px-2 pb-0.5",children:e.jsx(sn,{})})]})]})}),e.jsxs("div",{className:t("min-w-12 h-12 flex items-center justify-between pb-2 pl-1 mini-player:h-10","mid-player:pl-0 mini-player:pl-0 mid-player:pb-0 mini-player:pb-0.5 mid-player:flex-1"),children:[e.jsx(an,{}),e.jsx(en,{})]}),e.jsx("div",{className:"hidden mini-player:flex",children:e.jsx(Xa,{})})]}),e.jsx("div",{className:"hidden mid-player:flex justify-center items-center h-10 max-h-10",children:e.jsx(Xa,{})}),e.jsx(Ga,{className:"absolute w-5 h-5 bottom-0 right-0 text-foreground/50"})]})});function on(){return e.jsx("div",{className:"absolute inset-0 w-full h-full z-0 overflow-hidden",children:i.isSafari?e.jsx(dn,{}):e.jsx(cn,{})})}function cn(){const{coverArt:t}=W(),a=k(t,"song","300"),[n,r]=s.useState(a),{bigPlayerBlur:l}=y(),i=s.useMemo(()=>a,[a]);return s.useEffect(()=>{const e=new Image;e.src=i,e.onload=()=>{r(i)}},[i]),e.jsxs("div",{className:"relative w-full h-full transition-colors duration-1000 bg-black/0",children:[e.jsx("div",{className:"absolute -inset-10 bg-cover bg-center z-0 transition-[background-image] duration-1000",style:{backgroundImage:`url(${n})`,filter:`blur(${l.value}px)`}}),e.jsx("div",{className:"bg-background/50 absolute inset-0 w-full h-full z-0 transition-colors duration-1000"})]})}function dn(){const{coverArt:t,title:a}=W(),n=k(t,"song","300"),{bigPlayerBlur:r}=y(),{currentSongColor:l,currentSongColorIntensity:i}=y(),o=s.useMemo(()=>{if(l)return M(l,i)},[l,i]);return e.jsxs("div",{className:"relative w-full h-full flex items-center transition-colors duration-1000",style:{backgroundColor:o},children:[e.jsx(Ys.LazyLoadImage,{src:n,alt:a,effect:"opacity",width:"100%",className:"w-full bg-contain"},t),e.jsx("div",{className:"absolute bg-background/50 inset-0 z-10",style:{WebkitBackdropFilter:`blur(${r.value}px)`,backdropFilter:`blur(${r.value}px)`}})]})}function un(){const{currentSongColor:a,currentSongColorIntensity:n}=y(),r=s.useMemo(()=>{if(a)return M(a,n)},[a,n]);return e.jsx("div",{className:"absolute inset-0 w-full h-full z-0 overflow-hidden",children:e.jsxs("div",{className:t("relative w-full h-full",H&&"bg-black/0"),children:[e.jsx("div",{className:t("absolute inset-0 w-full h-full z-[1]","transition-[background-image] duration-1000 default-gradient")}),e.jsx("div",{className:"absolute inset-0 w-full h-full z-0 transition-[background-color] duration-1000",style:{backgroundColor:r}})]})})}function mn(){return e.jsx(v,{variant:"ghost",size:"icon",className:"size-10 rounded-full hover:bg-foreground/20",asChild:!0,children:e.jsx("div",{children:e.jsx(cs,{className:"size-7"})})})}function xn(){return Y?e.jsx("div",{className:"absolute h-header left-0 right-[94px] electron-drag z-10"}):null}function hn(){const s=z(),a=T(),n=O(),{hasPrev:r,hasNext:l}=q(),{isPlayingOneSong:i,toggleShuffle:o,playNextSong:c,playPrevSong:d,togglePlayPause:u,toggleLoop:m}=S();return e.jsxs(e.Fragment,{children:[e.jsx(v,{size:"icon",variant:"ghost","data-state":a&&"active",className:t(fn.secondary,a&&fn.activeDot),style:{...fn.style},onClick:()=>o(),disabled:i()||!l,children:e.jsx(ds,{className:fn.secondaryIcon})}),e.jsx(v,{size:"icon",variant:"ghost",className:fn.secondary,style:{...fn.style},onClick:()=>d(),disabled:!r,children:e.jsx(us,{className:fn.secondaryIconFilled})}),e.jsx(v,{size:"icon",variant:"link",className:fn.main,style:{...fn.style},onClick:()=>u(),children:s?e.jsx(ms,{className:fn.mainIcon,strokeWidth:1}):e.jsx(xs,{className:fn.mainIcon})}),e.jsx(v,{size:"icon",variant:"ghost",className:fn.secondary,style:{...fn.style},onClick:()=>c(),disabled:!l&&n!==D.All,children:e.jsx(hs,{className:fn.secondaryIconFilled})}),e.jsxs(v,{size:"icon",variant:"ghost","data-state":n!==D.Off&&"active",className:t(fn.secondary,n!==D.Off&&fn.activeDot),onClick:()=>m(),style:{...fn.style},children:[n===D.Off&&e.jsx(fs,{className:fn.secondaryIcon}),n===D.All&&e.jsx(fs,{className:fn.secondaryIcon}),n===D.One&&e.jsx(Wa,{className:fn.secondaryIcon})]})]})}const fn={main:"w-12 h-12 sm:w-14 sm:h-14 rounded-full shadow-lg bg-secondary-foreground hover:scale-105 transition-transform will-change-transform",mainIcon:"w-5 h-5 sm:w-6 sm:h-6 text-secondary fill-secondary",secondary:"relative w-10 h-10 sm:w-12 sm:h-12 rounded-full text-secondary-foreground hover:text-secondary-foreground data-[state=active]:text-primary hover:bg-transparent hover:scale-110 transition-transform will-change-transform",secondaryIcon:"w-5 h-5 sm:w-6 sm:h-6 drop-shadow-lg",secondaryIconFilled:"w-5 h-5 sm:w-6 sm:h-6 text-secondary-foreground fill-secondary-foreground drop-shadow-lg",activeDot:"player-button-active",style:{backfaceVisibility:"hidden"}};function pn(){const{starCurrentSong:s}=S(),a=F();return e.jsx(v,{size:"icon",variant:"ghost",className:fn.secondary,onClick:s,style:{...fn.style},children:e.jsx(ps,{className:t("w-6 h-6 drop-shadow-lg",a&&"text-red-500 fill-red-500")})})}let gn=!1;function jn(){const t=B(),[a,n]=s.useState(t),r=d(),l=G(),{setProgress:i}=S(),o=s.useCallback(e=>{gn=!1,r&&(r.currentTime=e)},[r]),c=s.useCallback(e=>{gn=!0,n(e)},[]),u=s.useCallback(e=>{o(e),i(e),n(e)},[i,o]),m=s.useCallback(()=>{a!==t&&(o(a),i(a))},[a,t,i,o]),x=ct(gn?a:t);return e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"min-w-[40px] sm:min-w-[50px] max-w-[50px] sm:max-w-[60px] text-right drop-shadow-lg text-sm sm:text-base",children:x}),e.jsx(ja,{variant:"secondary",defaultValue:[0],value:gn?[a]:[t],tooltipTransformer:ct,max:l,step:1,className:"w-full h-4",onValueChange:([e])=>c(e),onValueCommit:([e])=>u(e),onPointerUp:m,onMouseUp:m}),e.jsx("div",{className:"min-w-[40px] sm:min-w-[50px] max-w-[50px] sm:max-w-[60px] text-left drop-shadow-lg text-sm sm:text-base",children:ct(l??0)})]})}function yn({className:s}){const{volume:t}=V();return e.jsxs("div",{className:`flex justify-center items-center gap-1 text-secondary-foreground ${s}`,children:[e.jsx(Za,{className:fn.secondary,children:e.jsx(Ha,{volume:t,className:fn.secondaryIcon})}),e.jsx(Ja,{variant:"secondary",className:"h-3"})]})}function vn(){return e.jsxs("div",{className:"w-full",children:[e.jsx(jn,{}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2 sm:gap-4 mt-2 sm:mt-5",children:[e.jsx("div",{className:"hidden sm:flex w-[200px] justify-start",children:e.jsx(pn,{})}),e.jsx("div",{className:"flex flex-1 justify-center items-center gap-1 sm:gap-2",children:e.jsx(hn,{})}),e.jsx("div",{className:"hidden sm:flex w-[200px] justify-end",children:e.jsx(yn,{})})]}),e.jsxs("div",{className:"flex sm:hidden items-center justify-between mt-2 px-2",children:[e.jsx(pn,{}),e.jsx(yn,{className:"sm:hidden"})]})]})}const bn=Je,Nn=s.forwardRef(({className:s,...t},a)=>e.jsx(Xe,{ref:a,className:h("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t}));Nn.displayName=Xe.displayName;const wn=s.forwardRef(({className:s,...t},a)=>e.jsx(es,{ref:a,className:h("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));wn.displayName=es.displayName;const kn=s.forwardRef(({className:s,...t},a)=>e.jsx(ss,{ref:a,className:h("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));function Cn({song:s,isPlaying:a,index:n,style:r,...l}){const i=k(s.coverArt,"song","100");return e.jsxs("div",{className:t(["flex items-center w-[calc(100%-10px)] h-16 text-sm rounded-md cursor-pointer","bg-black/0 hover:bg-foreground/20","data-[state=active]:bg-foreground data-[state=active]:text-secondary"]),style:{backfaceVisibility:"visible",willChange:"background-color",...r},...l,children:[e.jsx("div",{className:"w-[54px] h-full flex items-center justify-center text-center font-medium flex-shrink-0",children:a?e.jsx("div",{className:"w-6 flex items-center",children:e.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:e.jsx(Ct,{size:20,className:"text-secondary mb-1"})})}):e.jsx("div",{className:"w-6 h-6 text-center flex justify-center items-center drop-shadow-lg",children:e.jsx("p",{children:n+1})})}),e.jsxs("div",{className:"flex flex-1 items-center min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-accent rounded mr-2 flex-shrink-0",children:e.jsx(Ys.LazyLoadImage,{src:i,className:"w-10 h-10 rounded text-transparent",alt:`${s.title} - ${s.artist}`})}),e.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[e.jsx("span",{className:"font-semibold truncate",children:s.title}),e.jsx("div",{className:"truncate",children:e.jsx(Sn,{song:s})})]})]}),e.jsx("div",{className:"w-[70px] sm:w-[100px] text-center flex-shrink-0",children:ct(s.duration)})]})}function Sn({song:s}){const{artist:t,artists:a}=s;if(a&&a.length>1){const s=a.slice(0,Zs);return e.jsx("div",{className:"flex items-center gap-1 font-normal opacity-70 truncate",children:s.map(({id:t,name:a},n)=>e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("p",{className:"truncate",children:a}),n<s.length-1&&","]},t))})}return e.jsx("p",{className:"font-normal text-sm opacity-70 truncate",children:t})}kn.displayName=ss.displayName;const Pn=s.memo(function(){const{coverArt:t,artist:a,title:n}=P(({songlist:e})=>e.currentSong),r=s.useMemo(()=>k(t,"song","800"),[t]);return e.jsx("div",{className:"w-full sm:w-auto sm:2xl:w-[33%] h-auto sm:h-full max-w-[240px] max-h-[240px] sm:max-w-[450px] sm:max-h-[450px] 2xl:max-w-[550px] 2xl:max-h-[550px] items-end flex aspect-square mx-auto sm:mx-0",children:e.jsx(Pa,{ratio:1,className:"rounded-lg 2xl:rounded-2xl overflow-hidden bg-accent",children:e.jsx(Ys.LazyLoadImage,{src:r,effect:"opacity",alt:`${a} - ${n}`,className:"aspect-square object-cover shadow-custom-5",width:"100%",height:"100%"})})})});function An({song:s}){const{artist:t,artists:a}=s;if(a&&a.length>1){const s=a.slice(0,Zs);return e.jsx("div",{className:"flex items-center gap-1",children:s.map(({id:t,name:a},n)=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"truncate drop-shadow-lg",children:a}),n<s.length-1&&","]},t))})}return e.jsx("p",{className:"truncate drop-shadow-lg",children:t})}const In=s.memo(function(){const{setSongList:t}=S(),{currentList:a,currentSongIndex:r,currentSong:l}=c(),i=z(),o=s.useRef(null),d=n({count:a.length,getScrollElement:()=>o.current?o.current.querySelector("[data-radix-scroll-area-viewport]"):null,estimateSize:()=>64,overscan:5});return s.useEffect(()=>{r>=0&&d.scrollToIndex(r,{align:"start"})},[r,d]),0===a.length?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("span",{children:"No songs in queue"})}):e.jsx(m,{ref:o,type:"always",className:"min-h-full h-full overflow-auto",thumbClassName:"secondary-thumb-bar",children:e.jsx("div",{style:{height:`${d.getTotalSize()}px`,width:"100%",position:"relative"},children:d.getVirtualItems().map(s=>{const n=a[s.index];return e.jsx(Cn,{"data-row-index":s.index,"data-state":l.id===n.id?"active":"inactive",index:s.index,song:n,isPlaying:l.id===n.id&&i,onClick:()=>{l.id!==n.id&&t(a,s.index)},style:{position:"absolute",top:0,transform:`translateY(${s.start}px)`}},n.id)})})})}),En=s.memo(function(){const s=P(e=>e.songlist.currentSong);return e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:justify-start h-auto sm:h-full sm:min-h-full sm:max-h-full gap-2 sm:gap-4 2xl:gap-6 flex-1 pt-2 overflow-hidden",children:[e.jsx(Pn,{}),e.jsxs("div",{className:"flex flex-col w-full sm:w-[66%] max-w-full h-auto sm:h-full sm:max-h-[450px] 2xl:max-h-[550px] justify-center sm:justify-end text-center sm:text-left overflow-hidden px-4 sm:px-0",children:[e.jsx(_a,{gap:"mr-6",children:e.jsx("h2",{className:"scroll-m-20 text-2xl sm:text-4xl 2xl:text-5xl font-bold tracking-tight py-1 sm:py-2 2xl:py-3 drop-shadow-lg",children:s.title})}),e.jsxs("div",{className:"text-sm sm:text-base 2xl:text-lg flex gap-1 text-foreground/70 justify-center sm:justify-start truncate maskImage-marquee-fade-finished",children:[e.jsx("p",{className:"truncate drop-shadow-lg text-foreground",children:s.album}),e.jsx(St,{className:"text-foreground/70"}),e.jsx(An,{song:s})]}),e.jsxs("div",{className:"flex gap-2 mt-1 sm:mt-2 2xl:mt-3 mb-[1px] justify-center sm:justify-start",children:[s.genre&&e.jsx(Q,{variant:"neutral",children:s.genre}),s.year&&e.jsx(Q,{variant:"neutral",children:s.year})]})]})]})}),Ln=s.memo(ma),Rn=s.memo(vn),Mn=(e,s)=>`translate3d(${{queue:{queue:"0",playing:"-120%",lyrics:"-240%"},playing:{queue:"120%",playing:"0",lyrics:"-120%"},lyrics:{queue:"240%",playing:"120%",lyrics:"0"}}[s][e]}, 0, 0)`,zn="absolute inset-0 mt-0 h-[calc(100%-64px)] overflow-y-auto transition-transform duration-300 overscroll-none",Tn="w-full data-[state=active]:bg-foreground data-[state=active]:text-secondary text-foreground drop-shadow-sm";function On(){const[t,a]=s.useState("playing"),{t:n}=Ve();return e.jsxs(bn,{value:t,onValueChange:e=>a(e),className:"w-full h-full min-h-full",children:[e.jsxs(Nn,{className:"w-full bg-foreground/20 mb-4",children:[e.jsx(wn,{value:"queue",className:Tn,children:n("fullscreen.queue")}),e.jsx(wn,{value:"playing",className:Tn,children:n("fullscreen.playing")}),e.jsx(wn,{value:"lyrics",className:Tn,children:n("fullscreen.lyrics")})]}),e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx(kn,{value:"queue",className:zn,style:{backfaceVisibility:"hidden",transform:Mn(t,"queue")},forceMount:!0,children:e.jsx(In,{})}),e.jsx(kn,{value:"playing",className:"absolute inset-0 mt-0 h-[calc(100%-64px)] transition-transform duration-300 overscroll-none overflow-hidden",style:{backfaceVisibility:"hidden",transform:Mn(t,"playing")},forceMount:!0,children:e.jsxs("div",{className:"flex flex-col h-full justify-center sm:justify-start px-0",children:[e.jsx(En,{}),e.jsx("div",{className:"sm:hidden mt-auto pb-2 px-2",children:e.jsx(Rn,{})})]})}),e.jsx(kn,{value:"lyrics",className:zn,style:{backfaceVisibility:"hidden",transform:Mn(t,"lyrics")},forceMount:!0,children:e.jsx(Ln,{})})]})]})}const qn=s.memo(function(){const{useSongColorOnBigPlayer:s}=y();return s?e.jsx(un,{}):e.jsx(on,{})});function Dn({children:t,open:a,onOpenChange:n}){const{enterFullscreenWindow:r,exitFullscreenWindow:l}=Z(),{autoFullscreenEnabled:i}=J();return s.useEffect(()=>()=>{X()?l().then(()=>{ee(!1)}):se()},[]),e.jsxs(Ma,{fixed:!0,dismissible:!0,handleOnly:!1,disablePreventScroll:!0,modal:!1,open:a,onOpenChange:async function(e){n?.(e),X()&&ee(e),i&&(X()?e?await r():await l():e?te():se())},children:[e.jsx(za,{asChild:!0,children:t}),e.jsx(Fa,{className:"sr-only",children:"Big Player"}),e.jsxs(Da,{className:"h-screen w-screen rounded-t-none border-none select-none cursor-default mt-0",showHandle:!1,"aria-describedby":void 0,children:[e.jsx(qn,{}),e.jsx(xn,{}),e.jsxs("div",{className:"absolute inset-0 flex flex-col p-0 sm:p-0 2xl:p-8 pt-4 sm:pt-10 2xl:pt-12 w-full h-full gap-4 bg-black/0 z-10",children:[e.jsxs("div",{className:"flex gap-2 items-center w-full h-[40px] px-4 sm:px-16 z-20 justify-end",children:[e.jsx(ya,{}),e.jsx(Oa,{children:e.jsx(mn,{})})]}),e.jsx("div",{className:"w-full flex-1 overflow-hidden px-4 sm:px-16",children:e.jsx("div",{className:"h-full",children:e.jsx(On,{})})}),e.jsx("div",{className:"hidden sm:block h-[150px] min-h-[150px] px-16 py-2",children:e.jsx("div",{className:"flex items-center",children:e.jsx(vn,{})})})]})]})]})}function Fn({song:s}){const{artists:t,artistId:a,artist:n}=s;if(t&&t.length>1){const s=t.slice(0,Zs);return e.jsx("div",{className:"flex items-center gap-1 text-[10px] sm:text-xs text-muted-foreground w-full maskImage-marquee-fade-finished",children:s.map(({id:t,name:a},n)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(Bn,{id:t,name:a}),n<s.length-1&&","]},t))})}return e.jsx(Bn,{id:a,name:n})}function Bn({id:s,name:t}){return e.jsx(Qs,{to:C.ARTIST.PAGE(s??""),className:h("w-fit inline-flex",!s&&"pointer-events-none"),"data-testid":"track-artist-url",children:e.jsx("span",{className:h("text-[10px] sm:text-xs text-muted-foreground text-nowrap",s&&"hover:underline hover:text-foreground"),children:t})})}function Gn({className:s,tooltip:t,...a}){return e.jsx($,{text:t,children:e.jsx(v,{variant:"ghost",className:h("relative rounded-full size-10 p-0 [&_svg]:pointer-events-none [&_svg]:size-[18px] [&_svg]:shrink-0",s),...a})})}const Wn=s.memo(Ys.LazyLoadImage),Vn=s.memo(_a);const $n=[{label:"0.25x",value:.25},{label:"0.5x",value:.5},{label:"0.75x",value:.75},{label:"1.0x",value:1},{label:"1.25x",value:1.25},{label:"1.5x",value:1.5},{label:"1.75x",value:1.75},{label:"2.0x",value:2}];function _n({open:s,onOpenChange:t,children:a}){const{t:n}=Ve(),{mainDrawerState:r}=w(),{queueState:l,toggleQueueAction:i}=L(),{clearPlayerState:o}=S(),c=r&&l;function d(){t&&t(!1)}return e.jsxs($e,{open:s,onOpenChange:t,children:[e.jsx(ts,{asChild:!0,children:a}),e.jsx(Ue,{side:"top",className:"p-1 w-fit !pointer-events-auto",children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs(Un,{onClick:function(){d(),i()},children:[c?e.jsx(cs,{className:"w-4 h-4"}):e.jsx(Ps,{className:"w-4 h-4"}),e.jsx("span",{children:n(c?"queue.close":"queue.open")})]}),e.jsxs(Un,{onClick:function(){d(),o()},children:[e.jsx(os,{className:"w-4 h-4"}),e.jsx("span",{children:n("queue.clear")})]})]})})]})}function Un({className:s,children:t,...a}){return e.jsx(v,{...a,role:"menuitem",variant:"ghost",size:"sm",className:h("px-2 py-1.5 rounded cursor-default h-8 min-w-full flex items-center justify-start gap-2",s),children:t})}const Kn=s.memo(function({song:t,isFullscreenOpen:a,setIsFullscreenOpen:n}){const{t:r}=Ve(),{setCurrentSongColor:l,currentSongColor:i}=y(),o=s.useCallback(()=>document.getElementById("track-song-image"),[]),c=s.useCallback(async()=>{const e=o();if(!e)return;let s=kt(!0);try{s=(await ae(e)).hex,ne.info("[TrackInfo] - Getting Image Average Color",{color:s})}catch{ne.error("[TrackInfo] - Unable to get image average color.")}s!==i&&l(s)},[i,l,o]);return t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"group relative",children:[e.jsx("div",{className:"w-12 h-12 sm:w-[70px] sm:h-[70px] sm:min-w-[70px] sm:max-w-[70px] aspect-square bg-cover bg-center bg-skeleton rounded overflow-hidden shadow-md",children:e.jsx(Ys.LazyLoadImage,{id:"track-song-image",src:k(t.coverArt,"song","400"),width:"100%",height:"100%",crossOrigin:"anonymous",className:"aspect-square object-cover w-full h-full cursor-pointer bg-skeleton text-transparent","data-testid":"track-image",alt:`${t.artist} - ${t.title}`,onLoad:c,onError:function(){const e=o();e&&(e.crossOrigin=null)}},t.id)}),e.jsx(Dn,{open:a,onOpenChange:n,children:e.jsx(v,{variant:"secondary",size:"icon",className:"hidden sm:block cursor-pointer w-8 h-8 shadow-md rounded-full opacity-0 sm:group-hover:opacity-100 transition-opacity ease-in-out absolute top-1 right-1 focus-visible:opacity-100","data-testid":"track-fullscreen-button",children:e.jsx($,{text:r("fullscreen.switchButton"),align:"start",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ns,{className:"w-4 h-4"})})})})})]}),e.jsxs("div",{className:"flex flex-col justify-center w-full overflow-hidden ml-1",children:[e.jsx(_a,{gap:"mr-2",children:e.jsx(Qs,{to:C.ALBUM.PAGE(t.albumId),tabIndex:-1,children:e.jsx("span",{className:"text-xs sm:text-sm font-medium hover:underline cursor-pointer","data-testid":"track-title",children:t.title})})}),e.jsx(Fn,{song:t})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-12 h-12 sm:w-[70px] sm:h-[70px] flex justify-center items-center bg-muted rounded",children:e.jsx(bs,{"data-testid":"song-no-playing-icon",className:"size-5 sm:size-6"})}),e.jsx("div",{className:"flex flex-col justify-center",children:e.jsx("span",{className:"text-xs sm:text-sm font-medium","data-testid":"song-no-playing-label",children:r("player.noSongPlaying")})})]})}),Hn=s.memo(function({radio:t}){const{t:a}=Ve();return e.jsxs(s.Fragment,{children:[e.jsx("div",{className:"w-12 h-12 sm:w-[70px] sm:h-[70px] flex justify-center items-center bg-foreground/20 rounded",children:e.jsx(vs,{className:"w-7 h-7 sm:w-12 sm:h-12",strokeWidth:1,"data-testid":"radio-icon"})}),e.jsx("div",{className:"flex flex-col justify-center",children:t?e.jsxs(s.Fragment,{children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium","data-testid":"radio-name",children:t.name}),e.jsx("span",{className:"text-[10px] sm:text-xs font-light text-muted-foreground","data-testid":"radio-label",children:a("radios.label")})]}):e.jsx("span",{className:"text-xs sm:text-sm font-medium","data-testid":"radio-no-playing",children:a("player.noRadioPlaying")})})]})}),Yn=s.memo(function({podcast:t}){const[a,n]=s.useState(!1);return e.jsxs(s.Fragment,{children:[e.jsx("div",{className:"w-12 h-12 sm:w-[70px] sm:h-[70px] sm:min-w-[70px] sm:max-w-[70px] aspect-square bg-cover bg-center bg-skeleton rounded overflow-hidden shadow-md",children:e.jsx(Wn,{src:a?"/default_podcast_art.png":t.image_url,width:"100%",height:"100%",className:"aspect-square object-cover w-full h-full text-transparent","data-testid":"podcast-image",alt:t.title,onError:()=>n(!0)})}),e.jsxs("div",{className:"flex flex-col justify-center w-full overflow-hidden",children:[e.jsx(Vn,{gap:"mr-2",children:e.jsx(Qs,{to:C.EPISODES.PAGE(t.id),children:e.jsx("span",{className:"text-xs sm:text-sm font-medium hover:underline cursor-pointer","data-testid":"podcast-episode-title",children:t.title})})}),e.jsx(Qs,{to:C.PODCASTS.PAGE(t.podcast_id),className:"w-fit inline-flex max-w-full","data-testid":"podcast-title",children:e.jsx("span",{className:"text-[10px] sm:text-xs font-regular text-muted-foreground hover:underline max-w-full truncate",children:t.podcast.title})})]})]})}),Qn=s.memo(function({song:a,radio:n,podcast:r,audioRef:l}){const{t:i}=Ve(),{isSong:o,isPodcast:c}=re(),d=T(),{hasPrev:u,hasNext:m}=q(),x=O(),h=z(),{isPlayingOneSong:f,toggleShuffle:p,toggleLoop:g,togglePlayPause:j,playPrevSong:y,playNextSong:v}=S(),{useAudioHotkeys:b}=Ya();b("space",j),b("mod+left",y),b("mod+right",v),b("mod+s",p),b("mod+r",g);const N=s.useCallback(e=>{const s=l.current;s&&(s.currentTime+=e)},[l]);s.useEffect(()=>{c?ce.setPodcastHandlers({handleSeekAction:N}):ce.setHandlers()},[N,c,h]);const w=i(d?"player.tooltips.shuffle.disable":"player.tooltips.shuffle.enable"),k=i("player.tooltips.previous"),C=i("player.tooltips.next"),P=i("player.tooltips.rewind",{amount:15}),A=i("player.tooltips.forward",{amount:30}),I=i(h?"player.tooltips.pause":"player.tooltips.play"),E={0:i("player.tooltips.repeat.enable"),1:i("player.tooltips.repeat.enableOne"),2:i("player.tooltips.repeat.disable")}[x],L=!m&&x!==D.All,R=!a&&!n&&!r;return e.jsxs("div",{className:"flex w-full gap-1 justify-center items-center mb-1",children:[o&&e.jsx(Gn,{className:t(d&&"player-button-active"),disabled:!a||f()||!m,onClick:p,"data-testid":"player-button-shuffle",tooltip:w,children:e.jsx(ds,{className:t(d?"text-primary":"text-secondary-foreground")})}),e.jsx(Gn,{disabled:R||!u,onClick:y,"data-testid":"player-button-prev",tooltip:k,children:e.jsx(us,{className:"text-secondary-foreground fill-secondary-foreground"})}),c&&e.jsxs(Gn,{onClick:()=>N(-15),"data-testid":"player-button-skip-backward",tooltip:P,children:[e.jsx("span",{className:"text-secondary-foreground font-light text-[8px] absolute",children:"15"}),e.jsx(ws,{className:"text-secondary-foreground"})]}),e.jsx(Gn,{variant:"default",disabled:!a&&!n&&!c,onClick:j,"data-testid":"player-button-"+(h?"pause":"play"),tooltip:I,children:h?e.jsx(ms,{className:"fill-primary-foreground"}):e.jsx(xs,{className:"fill-primary-foreground"})}),c&&e.jsxs(Gn,{onClick:()=>N(30),"data-testid":"player-button-skip-forward",tooltip:A,children:[e.jsx("span",{className:"text-secondary-foreground font-light text-[8px] absolute",children:"30"}),e.jsx(ks,{className:"text-secondary-foreground"})]}),e.jsx(Gn,{disabled:R||L,onClick:v,"data-testid":"player-button-next",tooltip:C,children:e.jsx(hs,{className:"text-secondary-foreground fill-secondary-foreground"})}),o&&e.jsxs(Gn,{className:t(x!==D.Off&&"player-button-active"),disabled:!a,onClick:g,"data-testid":"player-button-loop",tooltip:E,children:[x===D.Off&&e.jsx(fs,{className:"text-secondary-foreground"}),x===D.All&&e.jsx(fs,{className:"text-primary"}),x===D.One&&e.jsx(Wa,{className:"text-primary"})]})]})}),Zn=s.memo(function({audioRef:a}){const n=B(),[r,l]=s.useState(n),[i,o]=s.useState(!1),d=G(),u=z(),{currentSong:m,currentList:h,podcastList:f,currentSongIndex:p}=c(),{isSong:g,isPodcast:j}=re(),{setProgress:y,setUpdatePodcastProgress:v,getCurrentPodcastProgress:b}=S(),N=pe(),w=s.useRef(!1),k=s.useRef(!1),C=g&&0===h.length;s.useEffect(()=>{i||l(n)},[n,i]);const P=s.useCallback(e=>{N||a.current&&(ne.info("Seeking to:",e),a.current.currentTime=e)},[a,N]),A=s.useCallback(e=>{o(!0),l(e)},[]),I=s.useCallback(e=>{ne.info("Seek completed:",e),o(!1),N||P(e),y(e),l(e)},[N,y,P]),E=s.useCallback(()=>{i&&(ne.info("Seek fallback triggered:",r),o(!1),r!==n&&(N||P(r),y(r)))},[i,N,r,n,y,P]),L=s.useMemo(()=>ct(d??0),[d]),R=s.useCallback(async e=>{await x.scrobble.send(e)},[]),M=s.useRef(0);s.useEffect(()=>{!N&&g&&u&&m?.id&&(0!==n||k.current||(x.scrobble.send(m.id,!1),k.current=!0),0!==n||u||(k.current=!1))},[g,u,m?.id,n,N]),s.useEffect(()=>{k.current=!1},[]),s.useEffect(()=>{if(!i&&u&&!N&&g&&g){0===n/d*100?(w.current=!1,M.current=0):(M.current+=1,(M.current>=d/2||M.current>=240)&&!w.current&&(R(m.id),w.current=!0))}},[n,d,g,R,m.id,u,N,i]),s.useEffect(()=>{if(N||!j||!f)return;if(0===n)return;if(!(n/30%1==0))return;const e=f[p]??null;if(!e)return;const s=b();n!==s&&(v(n),xt.saveEpisodeProgress(e.id,n).then(()=>{ne.info("Progress sent:",n)}).catch(e=>{ne.error("Error sending progress",e)}))},[p,b,j,f,n,v,N]);const T=ct(i?r:n),O=s.useMemo(()=>r>=3600||n>=3600,[r,n]),q=s.useMemo(()=>d>=3600,[d]);return e.jsxs("div",{className:t("flex w-full justify-center items-center gap-2",C&&"opacity-50"),children:[e.jsx("small",{className:t("text-xs text-muted-foreground text-right",O?"min-w-14":"min-w-10"),"data-testid":"player-current-time",children:T}),!C||j?e.jsx(ja,{defaultValue:[0],value:i?[r]:[n],tooltipTransformer:ct,max:d,step:1,className:"cursor-pointer w-[32rem]",onValueChange:([e])=>A(e),onValueCommit:([e])=>I(e),onPointerUp:E,onMouseUp:E,onTouchEnd:E,"data-testid":"player-progress-slider"}):e.jsx(ja,{defaultValue:[0],max:100,step:1,disabled:!0,className:"cursor-pointer w-[32rem] pointer-events-none"}),e.jsx("small",{className:t("text-xs text-muted-foreground text-left",q?"min-w-14":"min-w-10"),"data-testid":"player-duration-time",children:L})]})}),Jn=s.memo(function({disabled:s}){const{t:a}=Ve(),n=F(),{title:r,artist:l}=P(e=>e.songlist.currentSong),{starCurrentSong:i}=S(),o=a("player.tooltips."+(n?"dislike":"like"),{song:r,artist:l});return e.jsx($,{text:o,children:e.jsx(v,{variant:"ghost",className:"rounded-full w-10 h-10 p-3 text-secondary-foreground",disabled:s,onClick:i,"data-testid":"player-like-button",children:e.jsx(ps,{className:t("w-5 h-5",n&&"text-red-500 fill-red-500"),"data-testid":"player-like-icon"})})})}),Xn=s.memo(function({disabled:a}){const{t:n}=Ve(),{mainDrawerState:r}=w(),{queueState:l,toggleQueueAction:i}=L(),[o,c]=s.useState(!1),d=r&&l;return e.jsx(_n,{open:o,onOpenChange:c,children:e.jsx("div",{children:e.jsx($,{text:n("queue.title"),children:e.jsx(v,{variant:"ghost",className:t("rounded-full w-10 h-10 p-2 text-secondary-foreground relative",d&&"player-button-active"),disabled:a,onClick:function(){i()},onContextMenu:e=>{e.preventDefault(),c(!o)},children:e.jsx(Ss,{className:t("w-4 h-4",d&&"text-primary")})})})})})}),er=s.memo(function({disabled:s}){const{t:t}=Ve(),{clearPlayerState:a}=S();return e.jsx($,{text:t("queue.clear"),children:e.jsx(v,{variant:"ghost",className:"rounded-full w-10 h-10 p-2 text-secondary-foreground",disabled:s,onClick:a,children:e.jsx(os,{className:"w-4 h-4"})})})}),sr=s.memo(function({disabled:a,audioRef:n}){const{t:r}=Ve(),{volume:l,handleVolumeWheel:i}=V(),{useAudioHotkeys:o}=Ya();o("mod+up",()=>i(!1)),o("mod+down",()=>i(!0)),s.useEffect(()=>{n.current&&(n.current.volume=l/100)},[n,l]);const c=r(0===l?"player.tooltips.volume.unmute":"player.tooltips.volume.mute");return e.jsxs("div",{className:t(a&&"opacity-50"),children:[e.jsx("div",{className:"flex 2xl:hidden",children:e.jsx(Qa,{children:e.jsx(Ha,{volume:l,size:18})})}),e.jsxs("div",{className:"hidden 2xl:flex gap-2 pr-2 items-center",children:[e.jsx($,{text:c,disabled:a,children:e.jsx("div",{className:"h-10 flex items-center",children:e.jsx(Za,{disabled:a,children:e.jsx("div",{className:"text-secondary-foreground",children:e.jsx(Ha,{volume:l,size:18})})})})}),e.jsx(Ja,{disabled:a})]})]})}),tr=s.memo(function(){const{t:s}=Ve(),t=P(e=>e.playerState.currentPlaybackRate),{setPlaybackRate:a}=S(),n=$n.find(e=>e.value===t),r=n?.label??"";return e.jsxs(de,{children:[e.jsx(ue,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",className:"focus-visible:ring-transparent data-[state=open]:bg-accent p-2",children:e.jsx("span",{className:"text-foreground text-sm font-normal",children:r})})}),e.jsxs(me,{children:[$n.map(({label:s,value:n})=>e.jsx(xe,{checked:n===t,onCheckedChange:()=>a(n),children:s},n)),1!==t&&e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsx(fe,{onClick:()=>a(1),children:s("table.sort.reset")})]})]})]})}),ar=s.memo(function({disabled:s}){const{t:a}=Ve(),{mainDrawerState:n}=w(),{lyricsState:r,toggleLyricsAction:l}=R(),i=n&&r;return e.jsx($,{text:a("fullscreen.lyrics"),children:e.jsx(v,{variant:"ghost",size:"icon",className:t("rounded-full w-10 h-10 p-2 text-secondary-foreground relative",i&&"player-button-active"),onClick:function(){l()},disabled:s,children:e.jsx(Cs,{className:t("w-4 h-4",i&&"text-primary")})})})}),nr=s.memo(function(){const{t:a}=Ve(),n=A(),[r,l]=s.useState(window.documentPictureInPicture.window),i=s.useCallback(async()=>{if(r)r.close();else{const e=await window.documentPictureInPicture.requestWindow({width:300,height:300});l(e)}},[r]);s.useEffect(()=>{const e=()=>{l(null)};return r?.addEventListener("pagehide",e),()=>{r?.removeEventListener("pagehide",e)}},[r]);const o=0===n.length,c=a(r?"player.tooltips.miniPlayer.close":"player.tooltips.miniPlayer.open");return e.jsxs(e.Fragment,{children:[e.jsx($,{text:c,children:e.jsx(v,{variant:"ghost",size:"icon",onClick:i,className:t("relative rounded-full",r&&"text-primary hover:text-primary player-button-active"),onFocus:e=>e.preventDefault(),disabled:o,children:e.jsx(ys,{className:"w-4 h-4"})})}),e.jsx(rn,{pipWindow:r,children:e.jsx(ln,{})})]})}),rr=s.memo(function({audioRef:t,replayGain:a,src:n,...r}){const{t:l}=Ve(),[i,o]=s.useState(1),[c,d]=s.useState(void 0),{replayGainEnabled:u,replayGainError:m}=le(),{isSong:x,isRadio:h,isPodcast:f}=re(),{setPlayingState:p}=S(),{setReplayGainEnabled:g,setReplayGainError:j}=oe(),{volume:y}=V(),v=z(),{active:b}=ie(),N=!b;s.useEffect(()=>{n&&n!==c&&(ne.info("Audio source changed",{src:n,useNativeAudio:N,isRemoteControlActive:b}),d(n))},[n,c,N,b]);const w=s.useMemo(()=>{const e=y/100;if(N)return 1*e;if(!a||!u)return 1*e;return e*function({gain:e,peak:s,preAmp:t}){const a=Math.pow(10,(e+t)/20);return Math.min(a,1/s)}(a)},[a,u,y,N]),{resumeContext:k,setupGain:C}=function(e){const{isSong:t}=re(),{replayGainError:a,replayGainEnabled:n}=le(),{active:r}=ie(),l=!r,i=s.useRef(null),o=s.useRef(null),c=s.useRef(null),d=s.useCallback(()=>{if(l)return void ne.info("Using native HTML5 audio (no AudioContext)");if(!e||!t||a)return;i.current||(i.current=new At);const s=i.current;o.current||(o.current=s.createMediaElementSource(e)),c.current||(c.current=s.createGain(),o.current.connect(c.current),c.current.connect(s.destination))},[e,t,a,l]),u=s.useCallback(async()=>{if(l)return;const e=i.current;if(e&&t){if(ne.info("AudioContext State",{state:e.state}),"suspended"===e.state)try{await e.resume(),ne.info("AudioContext resumed successfully")}catch(s){ne.error("Failed to resume AudioContext",s)}"closed"===e.state&&d()}},[t,d,l]),m=s.useCallback((e,s)=>{if(!l&&i.current&&c.current){const t=i.current.currentTime;ne.info("Replay Gain Status",{enabled:n,gainValue:e,...s}),c.current.gain.setValueAtTime(e,t)}},[n,l]),x=s.useCallback(()=>{o.current&&(o.current.disconnect(),o.current=null),c.current&&(c.current.disconnect(),c.current=null),i.current&&(i.current.close(),i.current=null)},[]);return s.useEffect(()=>{a&&x()},[a,x]),s.useEffect(()=>()=>x(),[]),s.useEffect(()=>{e&&d()},[e,d]),s.useEffect(()=>{const e=async()=>{const e=i.current;if(e&&t&&!document.hidden&&"suspended"===e.state)try{await e.resume(),ne.info("AudioContext resumed after visibility change")}catch(s){ne.error("Failed to resume AudioContext on visibility change",s)}};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[t]),{audioContextRef:i,sourceNodeRef:o,gainNodeRef:c,setupAudioContext:d,resumeContext:u,setupGain:m,resetRefs:x}}(t.current),P=N||!x||m;s.useEffect(()=>{if(t.current)return N?(t.current.volume=y/100,void ne.info("Native audio volume set:",y/100)):void(P||w!==i&&(C(w,a),o(w)))},[t,P,w,i,a,C,N,y]);const A=s.useCallback(()=>{const e=t.current;if(!e)return;const s={src:e.src,networkState:e.networkState,readyState:e.readyState,error:e.error?{code:e.error.code,message:e.error.message}:null};ne.error("Audio load error",s),e.error?.code===MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED&&u?(Pt.error(l("warnings.songError")),g(!1),j(!0),window.location.reload()):e.error?.code!==MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED&&Pt.error(l("warnings.songError"))},[t,u,g,j,l]),I=s.useCallback(()=>{t.current&&(Pt.error(l("radios.error")),p(!1))},[t,p,l]);s.useEffect(()=>{(x||f)&&async function(){const e=t.current;if(e)try{if(v){x&&!N&&await k();const s=e.play();void 0!==s&&s.catch(e=>{ne.error("Play was prevented:",e)})}else if(e.pause(),e.currentTime>0){const s=e.currentTime;e.currentTime=s}}catch(s){ne.error("Audio playback failed",s),A()}}()},[t,A,v,x,f,k,N]),s.useEffect(()=>{h&&async function(){const e=t.current;e&&(v?(e.load(),await e.play()):e.pause())}()},[t,v,h]);const E=s.useMemo(()=>x?A:h?I:void 0,[I,A,h,x]),L=s.useMemo(()=>{if(!N&&x&&!m)return"anonymous"},[x,m,N]);return e.jsx("audio",{ref:t,...r,src:c,crossOrigin:L,onError:E,playsInline:!0,preload:"auto"})});function lr(e,s=2){if(0===e)return"0 Bytes";const t=Math.max(0,s),a=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,a)).toFixed(t)).toLocaleString("en",{minimumFractionDigits:t,maximumFractionDigits:t})} ${["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"][a]}`}function ir({title:s,children:t}){const{t:a}=Ve();return e.jsxs("div",{className:"grid grid-cols-4 py-1 px-2 text-sm text-muted-foreground odd:bg-background-foreground",children:[e.jsx("div",{className:"py-1 flex items-center",children:a(`table.columns.${s}`)}),e.jsx("div",{className:"py-1 col-span-3 flex items-center !select-text flex-wrap gap-1",children:t})]})}function or(){const{canGoBack:a,canGoForward:n,goBack:r,goForward:l}=(()=>{const e=jt(),t=pt(),[a,n]=s.useState(!1),[r,l]=s.useState(!1);return s.useEffect(()=>{n(!1),l(!1);const e=()=>{n(window.history.state?.idx>0),l(window.history.state?.idx<window.history.length-1)};return e(),window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[e]),{canGoBack:a,canGoForward:r,goBack:()=>{a&&t(-1)},goForward:()=>{r&&t(1)}}})(),{mainDrawerState:i}=w();return e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:t("w-8 h-8",!a&&!i&&"cursor-not-allowed"),children:e.jsx(v,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-md",disabled:!a||i,onClick:r,children:e.jsx(Es,{className:"w-6 h-6",strokeWidth:1.5})})}),e.jsx("div",{className:t("w-8 h-8",!n&&!i&&"cursor-not-allowed"),children:e.jsx(v,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-md",disabled:!n||i,onClick:l,children:e.jsx(Ls,{className:"w-6 h-6",strokeWidth:1.5})})})]})}function cr({open:s,onOpenChange:t}){const{t:n}=Ve(),{name:r,version:l,url:i}=ke(),{data:o,isLoading:c}=a({queryKey:[qt.update.serverInfo],queryFn:x.ping.pingInfo});return e.jsx(ve,{open:s,onOpenChange:t,children:e.jsxs(be,{className:"p-0 overflow-hidden gap-0 cursor-default","aria-describedby":void 0,children:[e.jsx(E,{className:"sr-only",children:n("menu.about")}),e.jsx(Ne,{children:e.jsxs("div",{className:"flex gap-2 items-center justify-center w-full py-4 bg-gradient-to-b from-accent to-background",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20width='868'%20height='868'%20viewBox='0%200%20868%20868'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d_16_14)'%3e%3crect%20x='22'%20y='11'%20width='824'%20height='824'%20rx='184'%20fill='url(%23paint0_radial_16_14)'/%3e%3c/g%3e%3cpath%20d='M720%20423C720%20580.401%20592.401%20708%20435%20708C277.599%20708%20150%20580.401%20150%20423C150%20265.599%20277.599%20138%20435%20138C592.401%20138%20720%20265.599%20720%20423Z'%20stroke='%2320B358'%20stroke-width='30'/%3e%3cpath%20d='M699%20424C699%20555.947%20591.822%20663%20459.5%20663C327.178%20663%20220%20555.947%20220%20424C220%20292.053%20327.178%20185%20459.5%20185C591.822%20185%20699%20292.053%20699%20424Z'%20stroke='%2320B358'%20stroke-width='30'/%3e%3cpath%20d='M679%20426C679%20533.729%20591.886%20621%20484.5%20621C377.114%20621%20290%20533.729%20290%20426C290%20318.271%20377.114%20231%20484.5%20231C591.886%20231%20679%20318.271%20679%20426Z'%20stroke='%2320B358'%20stroke-width='30'/%3e%3cpath%20d='M659%20424.5C659%20507.067%20592.067%20574%20509.5%20574C426.933%20574%20360%20507.067%20360%20424.5C360%20341.933%20426.933%20275%20509.5%20275C592.067%20275%20659%20341.933%20659%20424.5Z'%20stroke='%2320B358'%20stroke-width='30'/%3e%3cdefs%3e%3cfilter%20id='filter0_d_16_14'%20x='0'%20y='0'%20width='868'%20height='868'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='11'/%3e%3cfeGaussianBlur%20stdDeviation='11'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.28%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_16_14'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_16_14'%20result='shape'/%3e%3c/filter%3e%3cradialGradient%20id='paint0_radial_16_14'%20cx='0'%20cy='0'%20r='1'%20gradientUnits='userSpaceOnUse'%20gradientTransform='translate(41222%2041211)%20scale(82400)'%3e%3cstop%20offset='0.655'%20stop-color='%23060E23'/%3e%3cstop%20offset='1'%20stop-color='%232DAC5C'/%3e%3c/radialGradient%3e%3c/defs%3e%3c/svg%3e",alt:"Aonsoku",className:"size-12 drop-shadow grayscale"}),e.jsx("h1",{className:"font-semibold text-2xl drop-shadow",children:r})]})}),e.jsxs("div",{className:"w-full h-full p-6 gap-6 grid grid-cols-4",children:[e.jsxs("div",{className:"flex flex-col gap-6 col-span-3 border-r",children:[e.jsxs("div",{className:"flex flex-col gap-2 h-full text-sm",children:[e.jsx("span",{className:"font-medium",children:n("about.client")}),e.jsx("div",{className:"flex flex-col gap-1 justify-center text-muted-foreground",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("p",{children:n("about.version")}),e.jsx("div",{className:"text-xs font-medium bg-primary/60 text-foreground px-2 rounded-full border border-primary flex items-center justify-center",children:l})]})})]}),e.jsxs("div",{className:"flex flex-col gap-2 h-full text-sm",children:[e.jsx("span",{className:"font-medium",children:n("about.server")}),c&&e.jsx("p",{children:n("generic.loading")}),o&&!c&&e.jsxs("div",{className:"flex flex-col gap-1 justify-center text-muted-foreground",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{children:n("about.type")}),e.jsx("div",{className:"text-xs font-medium bg-primary/60 text-foreground px-2 rounded-full border border-primary flex items-center justify-center",children:o.type})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{children:n("about.version")}),e.jsx("div",{className:"text-xs font-medium bg-primary/60 text-foreground px-2 rounded-full border border-primary flex items-center justify-center",children:o.serverVersion})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{children:n("about.apiVersion")}),e.jsx("div",{className:"text-xs font-medium bg-primary/60 text-foreground px-2 rounded-full border border-primary flex items-center justify-center",children:o.version})]})]})]})]}),e.jsx("div",{children:e.jsxs("a",{className:"w-full px-2 py-1 rounded-md bg-primary/60 hover:bg-primary/50 border border-primary text-sm font-medium flex items-center justify-center",href:i,target:"_blank",rel:"nofollow noreferrer",children:[e.jsx("img",{src:"data:image/svg+xml,%3csvg%20width='98'%20height='96'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M48.854%200C21.839%200%200%2022%200%2049.217c0%2021.756%2013.993%2040.172%2033.405%2046.69%202.427.49%203.316-1.059%203.316-2.362%200-1.141-.08-5.052-.08-9.127-13.59%202.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015%204.934.326%207.523%205.052%207.523%205.052%204.367%207.496%2011.404%205.378%2014.235%204.074.404-3.178%201.699-5.378%203.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283%200-5.378%201.94-9.778%205.014-13.2-.485-1.222-2.184-6.275.486-13.038%200%200%204.125-1.304%2013.426%205.052a46.97%2046.97%200%200%201%2012.214-1.63c4.125%200%208.33.571%2012.213%201.63%209.302-6.356%2013.427-5.052%2013.427-5.052%202.67%206.763.97%2011.816.485%2013.038%203.155%203.422%205.015%207.822%205.015%2013.2%200%2018.905-11.404%2023.06-22.324%2024.283%201.78%201.548%203.316%204.481%203.316%209.126%200%206.6-.08%2011.897-.08%2013.526%200%201.304.89%202.853%203.316%202.364%2019.412-6.52%2033.405-24.935%2033.405-46.691C97.707%2022%2075.788%200%2048.854%200z'%20fill='%23fff'/%3e%3c/svg%3e",alt:"Github",className:"size-4 mr-2"}),"Github"]})})]})]})})}function dr({modifier:s,text:t,className:a=""}){return e.jsxs("kbd",{className:h("pointer-events-none text-muted-foreground h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[12px] font-medium sm:flex",a),children:[void 0!==s&&e.jsx("span",{className:"text-[11px]",children:s}),t]})}const ur=i.isMacOs?"":"+",mr=i.isMacOs?"⌘":"Ctrl",xr=i.isMacOs?"⌃":"Ctrl",hr=i.isMacOs?"⇧":"Shift",fr=[mr,"/"],pr=[hr,xr,"Q"];function gr(e){return e.join(ur)}const jr=[{id:"playback",label:"shortcuts.playback.label",shortcuts:[{label:"shortcuts.playback.play",shortcuts:["Space"]},{label:"shortcuts.playback.shuffle",shortcuts:[mr,"S"]},{label:"shortcuts.playback.repeat",shortcuts:[mr,"R"]},{label:"shortcuts.playback.previous",shortcuts:[mr,"←"]},{label:"shortcuts.playback.next",shortcuts:[mr,"→"]},{label:"shortcuts.playback.raiseVolume",shortcuts:[mr,"↑"]},{label:"shortcuts.playback.lowerVolume",shortcuts:[mr,"↓"]}]},{id:"navigation",label:"shortcuts.navigation.label",shortcuts:[{label:"settings.label",shortcuts:[mr,","]}]}];function yr({title:s,shortcuts:t}){const{t:a}=Ve();return e.jsxs("div",{className:"space-y-3",children:[e.jsx("span",{className:"font-medium block",children:s}),e.jsx("div",{className:"space-y-2",children:t.map(({label:s,shortcuts:t})=>e.jsxs("div",{className:"flex items-center justify-between relative text-muted-foreground",children:[e.jsx("p",{className:"text-sm",children:a(s)}),e.jsx("div",{className:"flex gap-1",children:t.map(s=>e.jsx(dr,{text:s,className:"text-sm px-1.5 h-6"},s))})]},s))})]})}function vr({open:s,onOpenChange:t}){const{t:a}=Ve();return e.jsx(ve,{open:s,onOpenChange:t,children:e.jsxs(be,{className:"p-0 gap-0","aria-describedby":void 0,children:[e.jsxs(Ne,{className:"p-6 border-b-[1px] border-b-border mb-0",children:[e.jsx(E,{children:a("shortcuts.modal.title")}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx("p",{children:a("shortcuts.modal.description.first")}),fr.map(s=>e.jsx(dr,{text:s,className:"text-base px-1.5 h-6 antialiased"},s)),e.jsx("p",{children:a("shortcuts.modal.description.last")})]})]}),e.jsx("div",{className:"px-6 pt-4 pb-6 max-h-[400px] overflow-y-auto space-y-4",children:jr.map(s=>e.jsx(yr,{title:a(s.label),shortcuts:s.shortcuts},s.id))})]})})}const br=s.forwardRef(({className:s,...t},a)=>e.jsx(as,{ref:a,className:h("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...t}));br.displayName=as.displayName;s.forwardRef(({className:s,...t},a)=>e.jsx(rs,{ref:a,className:h("aspect-square h-full w-full",s),...t})).displayName=rs.displayName;const Nr=s.forwardRef(({className:s,...t},a)=>e.jsx(ns,{ref:a,className:h("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...t}));function wr({openDialog:s,setOpenDialog:t}){const{removeConfig:a}=Ce(),n=Se(e=>e.actions.setLogoutDialogState),r=pt(),{clearPlayerState:l,resetConfig:i}=S(),{t:o}=Ve();return e.jsx(It,{open:s,children:e.jsxs(Et,{children:[e.jsxs(Lt,{children:[e.jsx(Rt,{children:o("logout.dialog.title")}),e.jsx(Mt,{children:o("logout.dialog.description")})]}),e.jsxs(zt,{children:[e.jsx(Tt,{onClick:()=>t(!s),children:o("logout.dialog.cancel")}),e.jsx(Ot,{onClick:function(e){e.preventDefault(),a(),l(),i(),n(!1),r(C.SERVER_CONFIG,{replace:!0})},children:o("logout.dialog.confirm")})]})]})})}function kr(){const s=Se(e=>e.data.logoutDialogState),t=Se(e=>e.actions.setLogoutDialogState);return e.jsx(wr,{openDialog:s,setOpenDialog:t})}function Cr({open:t,onOpenChange:a}){const{t:n}=Ve(),r=Pe(),{status:l,ip:i,port:o,password:c,error:d,remoteDevice:u,playerState:m,currentSong:h}=Ae(e=>({status:e.status,ip:e.ip,port:e.port,password:e.password,error:e.error,remoteDevice:e.remoteDevice,playerState:e.playerState,currentSong:e.currentSong})),f=Ae(e=>e.actions),[p,g]=s.useState(null),[j,y]=s.useState(!1),b="connecting"===l||"authenticating"===l,N="connected"===l,w=r.running;s.useEffect(()=>{if(!h?.id)return void g(null);(async()=>{y(!0);try{const e=await x.songs.getSong(h.id);e&&g(e)}catch(e){console.error("Failed to fetch song info:",e)}finally{y(!1)}})()},[h?.id]);const C=s.useMemo(()=>{switch(l){case"connected":return n("lanControl.remote.status.connected");case"connecting":return n("lanControl.remote.status.connecting");case"authenticating":return n("lanControl.remote.status.authenticating");case"error":return n("lanControl.remote.status.error");default:return n("lanControl.remote.status.disconnected")}},[l,n]),S=p?.title||h?.title||n("lanControl.remote.emptyTitle"),P=p?.artist||h?.artist||n("lanControl.remote.emptyArtist"),A=p?.album||h?.album||"",I=p?.coverArt?k(p.coverArt):null;return e.jsx(ve,{open:t,onOpenChange:a,children:e.jsxs(be,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ne,{children:[e.jsx(E,{children:n("lanControl.remote.title")}),e.jsx(Ie,{children:n("lanControl.remote.description")})]}),w&&e.jsx("div",{className:"rounded-md border border-yellow-200 bg-yellow-50 px-4 py-3 text-sm text-yellow-800 dark:border-yellow-900 dark:bg-yellow-900/20 dark:text-yellow-300",children:n("lanControl.remote.serverRunning")}),e.jsxs("div",{className:"space-y-6 mt-6",children:[e.jsxs("section",{className:"grid gap-4 sm:grid-cols-[1fr_auto] sm:items-end",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2 sm:items-end",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(Dt,{htmlFor:"remote-ip",children:n("lanControl.remote.ip")}),e.jsx(Ee,{id:"remote-ip",value:i,placeholder:"192.168.1.100",onChange:e=>f.setIp(e.target.value),disabled:b,spellCheck:!1,autoComplete:"off"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(Dt,{htmlFor:"remote-port",children:n("lanControl.remote.port")}),e.jsx(Ee,{id:"remote-port",type:"number",value:o,placeholder:"5299",onChange:e=>f.setPort(parseInt(e.target.value,10)||5299),disabled:b,autoComplete:"off"})]})]}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2 sm:items-center",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(Dt,{htmlFor:"remote-password",children:n("lanControl.remote.password")}),e.jsx(Ee,{id:"remote-password",value:c,maxLength:6,placeholder:"ABC123",onChange:e=>f.setPassword(e.target.value),disabled:b,autoComplete:"off"})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:items-end",children:[e.jsx(Dt,{className:"text-xs uppercase tracking-wide",children:n("lanControl.remote.status.label")}),e.jsx(Q,{variant:N?"default":"error"===l?"destructive":"secondary",className:"capitalize",children:C})]})]}),u&&N&&e.jsxs("div",{className:"rounded-md border border-border/60 bg-muted/40 px-4 py-3 text-sm text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-foreground",children:u.name??n("lanControl.remote.unknownDevice")}),u.version&&e.jsx("span",{className:"ml-2 text-xs",children:n("lanControl.remote.version",{version:u.version})})]}),d&&e.jsx("div",{className:"rounded-md border border-destructive/40 bg-destructive/10 px-4 py-3 text-sm text-destructive",children:d})]}),e.jsxs("div",{className:"flex gap-2 sm:flex-col",children:[e.jsx(v,{variant:"default",onClick:()=>{f.clearError(),f.connect()},disabled:b||w,children:n(b?"lanControl.remote.actions.connecting":"lanControl.remote.actions.connect")}),e.jsx(v,{variant:"outline",onClick:()=>{f.disconnect()},disabled:!N&&"error"!==l,children:n("lanControl.remote.actions.disconnect")})]})]}),e.jsxs("section",{className:"grid gap-4 rounded-lg border border-border/60 bg-muted/40 p-4",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-sm",children:n("lanControl.remote.nowPlaying")}),m&&e.jsx("div",{className:"text-xs text-muted-foreground",children:n("lanControl.remote.volume",{volume:m.volume})})]}),e.jsxs("div",{className:"flex gap-3",children:[I&&e.jsx("div",{className:"shrink-0",children:e.jsx("img",{src:I,alt:S,className:"h-20 w-20 rounded object-cover"})}),e.jsxs("div",{className:"grid gap-1 flex-1 min-w-0",children:[e.jsx("span",{className:"text-base font-medium truncate",children:j?e.jsx("span",{className:"text-muted-foreground",children:n("lanControl.remote.loadingSong")}):S}),e.jsx("span",{className:"text-sm text-muted-foreground truncate",children:P}),A&&e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:A})]})]}),m&&e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:ct(m.currentTime??0)}),e.jsx("span",{children:ct(m.duration??0)})]})]})]})]})})}function Sr(){const{username:t,url:a,lockUser:n}=Le(),r=Se(e=>e.actions.setLogoutDialogState),{t:l}=Ve(),i=Pe(),[o,c]=s.useState(!1),[d,u]=s.useState(!1),[m,x]=s.useState(!1);Nt("shift+ctrl+q",()=>r(!0)),Nt("mod+/",()=>c(e=>!e));const h=ze?"end":"center",f=i.running;return e.jsxs(e.Fragment,{children:[e.jsx(kr,{}),e.jsx(vr,{open:o,onOpenChange:c}),e.jsx(cr,{open:d,onOpenChange:u}),e.jsx(Cr,{open:m,onOpenChange:x}),e.jsxs(de,{children:[e.jsx(ue,{className:"user-dropdown-trigger",children:e.jsx(br,{className:"w-8 h-8 rounded-full cursor-pointer",children:e.jsx(Nr,{className:"text-sm bg-transparent hover:bg-accent",children:e.jsx(Rs,{className:"w-4 h-4"})})})}),e.jsxs(me,{align:h,className:"min-w-64",children:[e.jsx(Re,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:t}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:a})]})}),e.jsx(he,{}),e.jsxs(fe,{onClick:()=>c(!0),children:[e.jsx(Ms,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:l("shortcuts.modal.title")}),e.jsx(Me,{children:gr(fr)})]}),!f&&e.jsxs(fe,{onClick:()=>x(!0),children:[e.jsx(zs,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:l("lanControl.remote.menu")})]}),e.jsx(he,{}),e.jsxs(fe,{onClick:()=>u(!0),children:[e.jsx(Ts,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:l("menu.about")})]}),!n&&e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsxs(fe,{onClick:()=>r(!0),children:[e.jsx(Os,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:l("menu.serverLogout")}),e.jsx(Me,{children:gr(pr)})]})]})]})]})]})}function Pr(){const{t:s}=Ve(),{openDialog:t,setOpenDialog:a}=Te();return Nt("mod+comma",()=>{a(!t)}),e.jsx($,{text:s("settings.label"),side:"bottom",children:e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>a(!0),className:"h-8 w-8 p-0 rounded-md",children:e.jsx(qs,{className:"w-4 h-4"})})})}function Ar(){s.useEffect(()=>{const e=()=>{const e=document.documentElement,s=getComputedStyle(e).getPropertyValue("--background").trim().match(/^(\d+\.?\d*)\s+(\d+\.?\d*)%\s+(\d+\.?\d*)%$/);if(s){const[,e,t,a]=s,n=function(e,s,t){s/=100,t/=100;const a=(1-Math.abs(2*t-1))*s,n=a*(1-Math.abs(e/60%2-1)),r=t-a/2;let l=0,i=0,o=0;e>=0&&e<60?(l=a,i=n,o=0):e>=60&&e<120?(l=n,i=a,o=0):e>=120&&e<180?(l=0,i=a,o=n):e>=180&&e<240?(l=0,i=n,o=a):e>=240&&e<300?(l=n,i=0,o=a):e>=300&&e<360&&(l=a,i=0,o=n);const c=e=>{const s=Math.round(255*(e+r)).toString(16);return 1===s.length?"0"+s:s};return`#${c(l)}${c(i)}${c(o)}`}(Number(e),Number(t),Number(a));Ir(n)}else{const e=getComputedStyle(document.body).backgroundColor;if(e){Ir(function(e){const s=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)$/);if(!s)return"#000000";const t=e=>{const s=e.toString(16);return 1===s.length?"0"+s:s};return`#${t(Number(s[1]))}${t(Number(s[2]))}${t(Number(s[3]))}`}(e))}}};e();const s=setTimeout(e,100);return()=>clearTimeout(s)},[])}function Ir(e){let s=document.querySelector('meta[name="theme-color"]');s||(s=document.createElement("meta"),s.setAttribute("name","theme-color"),document.head.appendChild(s)),s.setAttribute("content",e)}function Er({children:s}){return e.jsx("div",{className:"flex flex-col pt-1.5",children:s})}function Lr({children:s}){return e.jsx("div",{className:"flex justify-between py-0.5 px-4 text-xs font-medium text-muted-foreground",children:s})}function Rr({className:s,children:t,...a}){return e.jsx(v,{className:h("text-xs p-0 m-0 h-fit underline-offset-1",s),size:"sm",variant:"link",...a,children:t})}Nr.displayName=ns.displayName;const Mr=Ys.trackWindowScroll(({scrollPosition:s,effect:t="opacity",...a})=>{const n=ta(a,"forwardRef");return e.jsx("div",{className:"flex items-center",children:e.jsx(Ys.LazyLoadImage,{effect:t,scrollPosition:s,...n})})});function zr({coverArt:s,coverArtType:t,title:a,artist:n,onClick:r}){return e.jsxs("div",{className:"flex w-full justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2 w-[420px]",children:[e.jsx(Mr,{src:k(s,t,"100"),width:40,height:40,className:"aspect-square object-cover rounded shadow",alt:`${n} - ${a}`}),e.jsxs("div",{className:"flex flex-col justify-center w-full",children:[e.jsx("span",{className:"font-medium text-sm truncate w-[370px]",children:a}),e.jsx("span",{className:"text-xs text-muted-foreground",children:n})]})]}),e.jsx("div",{className:"flex",children:e.jsx(v,{variant:"outline",size:"sm",className:"w-7 h-7 p-[6px] rounded-full hover:bg-background",onClick:e=>{e.preventDefault(),e.stopPropagation(),r()},children:e.jsx(xs,{className:"w-4 h-4 fill-foreground"})})})]})}function Tr({query:s,albums:t,runCommand:a}){const{t:n}=Ve(),r=pt(),{getAlbumSongs:l}=sa(),{setSongList:i}=S();return e.jsxs(Er,{children:[e.jsxs(Lr,{children:[e.jsx("span",{children:n("sidebar.albums")}),e.jsx(Rr,{onClick:()=>a(()=>r(C.ALBUMS.SEARCH(s))),children:n("generic.seeMore")})]}),e.jsx(Kt,{children:t.length>0&&t.map(s=>e.jsx(Ht,{value:`album-${s.id}`,className:"border mb-1",onSelect:()=>{a(()=>r(C.ALBUM.PAGE(s.id)))},children:e.jsx(zr,{coverArt:s.coverArt,coverArtType:"album",title:s.name,artist:s.artist,onClick:()=>async function(e){const s=await l(e);s&&i(s,0)}(s.id)})},`album-${s.id}`))})]})}function Or({artists:s,runCommand:t}){const{t:a}=Ve(),n=pt(),{getArtistAllSongs:r}=sa(),{setSongList:l}=S();return e.jsxs(Er,{children:[e.jsx(Lr,{children:e.jsx("span",{children:a("sidebar.artists")})}),e.jsx(Kt,{children:s.length>0&&s.map(s=>e.jsx(Ht,{value:`artist-${s.id}`,className:"border mb-1",onSelect:()=>{t(()=>n(C.ARTIST.PAGE(s.id)))},children:e.jsx(zr,{coverArt:s.coverArt,coverArtType:"artist",title:s.name,artist:a("artist.info.albumsCount",{count:s.albumCount}),onClick:()=>async function(e){const s=await r(e.name);s&&l(s,0)}(s)})},`artist-${s.id}`))})]})}const qr=la({name:oa().min(2,{message:"playlist.form.validations.nameLength"}),comment:oa(),isPublic:ia()}),Dr={name:"",comment:"",isPublic:!0};function Fr(){const{t:t}=Ve(),{data:a,setData:n,playlistDialogState:i,setPlaylistDialogState:o}=lt(),c=0===Object.keys(a).length,d=na({resolver:aa(qr),defaultValues:Dr});s.useEffect(()=>{c?d.reset(Dr):d.reset({name:a.name??"",comment:a.comment??"",isPublic:a.public})},[a,d,c]);const u=r(),m=l({mutationFn:x.playlists.createWithDetails,onSuccess:()=>{u.invalidateQueries({queryKey:[qt.playlist.all]}),Pt.success(t("playlist.form.create.toast.success"))},onError:()=>{Pt.error(t("playlist.form.create.toast.success"))}}),h=l({mutationFn:x.playlists.update,onSuccess:()=>{Promise.all([u.invalidateQueries({queryKey:[qt.playlist.all]}),u.invalidateQueries({queryKey:[qt.playlist.single,a.id]})]),Pt.success(t("playlist.form.edit.toast.success"))},onError:()=>{Pt.error(t("playlist.form.edit.toast.error"))}});function f(){n({})}return e.jsx(ve,{defaultOpen:!1,open:i,onOpenChange:e=>{e||f(),o(e)},children:e.jsx(be,{className:"max-w-[500px]","aria-describedby":void 0,children:e.jsx(Ft,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(async function({name:e,comment:s,isPublic:t}){c?await m.mutateAsync({name:e,comment:s,isPublic:t?"true":"false"}):await h.mutateAsync({playlistId:a.id,name:e,comment:s,isPublic:t?"true":"false"}),o(!1),f()}),children:[e.jsx(Ne,{children:e.jsx(E,{children:t(`playlist.form.${c?"create":"edit"}.title`)})}),e.jsxs("div",{className:"my-4 space-y-4",children:[e.jsx(Bt,{control:d.control,name:"name",render:({field:s})=>e.jsxs(Gt,{children:[e.jsx(Wt,{className:"required",children:t("playlist.form.labels.name")}),e.jsx(Vt,{children:e.jsx(Ee,{...s,id:"playlist-name"})}),e.jsx($t,{})]})}),e.jsx(Bt,{control:d.control,name:"comment",render:({field:s})=>e.jsxs(Gt,{children:[e.jsx(Wt,{children:t("playlist.form.labels.comment")}),e.jsx(Vt,{children:e.jsx(ra,{...s,placeholder:t("playlist.form.labels.commentDescription"),className:"resize-none"})}),e.jsx($t,{})]})}),e.jsx(Bt,{control:d.control,name:"isPublic",render:({field:s})=>e.jsxs(Gt,{className:"flex flex-row items-center justify-between rounded-lg border p-4 bg-accent/40",children:[e.jsxs("div",{children:[e.jsx(Wt,{children:t("playlist.form.labels.isPublic")}),e.jsx(_t,{className:"my-1",children:t("playlist.form.labels.isPublicDescription")})]}),e.jsx(Vt,{children:e.jsx(b,{id:"playlist-is-public",checked:s.value,onCheckedChange:s.onChange,className:"ml-4"})})]})})]}),e.jsx(Oe,{children:e.jsx(v,{type:"submit",children:t(`playlist.form.${c?"create":"edit"}.button`)})})]})})})})}function Br(){const{setPlaylistDialogState:s}=lt(),{t:t}=Ve();return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx($,{text:t("playlist.form.create.title"),children:e.jsx(v,{size:"icon",variant:"ghost",className:"w-6 h-6 p-[5px]",onClick:()=>s(!0),children:e.jsx(Ds,{strokeWidth:3})})})})}function Gr({isActive:s}){const{t:a}=Ve();return e.jsx(Qs,{to:C.EPISODES.LATEST,className:t("w-full",s&&"pointer-events-none"),children:e.jsx($,{text:a("podcasts.form.latestEpisodes"),side:"right",delay:50,children:e.jsx(v,{variant:s?"secondary":"ghost",className:"w-full h-fit flex flex-col justify-center items-center gap-1",children:e.jsx(Fs,{className:"w-4 h-4"})})})})}const Wr=s.memo(Bs),Vr=s.memo(function({item:a}){const n=yt(),{t:r}=Ve(),[l,i]=s.useState(!1),o=s.useCallback(e=>n.pathname===e,[n.pathname]),c=o(a.route),d=o(C.EPISODES.LATEST);return s.useLayoutEffect(()=>{!l&&d&&i(!0)},[d,l]),e.jsxs("div",{"data-open":l,className:t("flex flex-col relative","transition-[max-height] duration-300 ease-in-out","data-[open=false]:max-h-9 data-[open=true]:max-h-[72px]"),children:[e.jsxs(Qs,{to:a.route,tabIndex:-1,className:t("z-10 block relative rounded-md",c&&"pointer-events-none"),children:[e.jsxs(v,{variant:c?"secondary":"ghost",size:"sm",className:"w-full justify-start",children:[e.jsx(a.icon,{className:"size-4 mr-2"}),r(a.title),e.jsx(Q,{variant:"beta",className:"ml-2",children:r("generic.beta")})]}),e.jsx(v,{size:"icon",onClick:e=>{e.preventDefault(),e.stopPropagation(),l&&d||i(e=>!e)},className:"absolute right-2.5 top-2 p-0 w-5 h-5 z-20 pointer-events-auto",children:e.jsx(Ls,{"data-visible":l,className:t("size-4 transition-transform duration-150","data-[visible=true]:rotate-90 ease-in-out"),strokeWidth:2.5})})]}),e.jsx("div",{"data-visible":l,className:t("py-1 overflow-hidden ease-in-out","transition-[transform,opacity] duration-300","data-[visible=false]:-translate-y-9","data-[visible=false]:opacity-0","data-[visible=false]:pointer-events-none"),children:e.jsx("div",{className:"ml-5 mr-2 pl-2 border-l",children:e.jsx(Qs,{to:C.EPISODES.LATEST,tabIndex:-1,className:t("block",d&&"pointer-events-none"),children:e.jsx(v,{variant:d?"secondary":"ghost",size:"sm",className:"w-full justify-start text-sm font-normal px-2 h-7",tabIndex:l?0:-1,children:r("podcasts.form.latestEpisodes")})})})})]})}),$r=s.memo(it),_r=s.memo(ca);function Ur({playlists:a}){const n=yt(),r=s.useCallback(e=>n.pathname===C.PLAYLIST.PAGE(e),[n.pathname]);return e.jsx(s.Fragment,{children:a.map(a=>e.jsx(s.Fragment,{children:e.jsx(Qs,{to:C.PLAYLIST.PAGE(a.id),className:"block",tabIndex:-1,onClick:e=>{r(a.id)&&e.preventDefault()},children:e.jsx($r,{options:e.jsx(_r,{variant:"context",playlist:a,showPlay:!0}),children:e.jsxs(v,{variant:r(a.id)?"secondary":"ghost",size:"sm",className:t("w-full justify-start",r(a.id)&&"cursor-default hover:bg-accent"),children:[e.jsx(Wr,{className:"mr-2 min-h-4 min-w-4 h-4 w-4"}),e.jsx("span",{className:"w-full truncate text-left",children:a.name})]})})})},a.id))})}function Kr(){const{t:s}=Ve(),{data:t}=a({queryKey:[qt.playlist.all],queryFn:x.playlists.getAll});return e.jsxs("div",{className:"flex flex-col flex-grow overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 pb-2",children:[e.jsx(Yr,{className:"mb-0",children:s("sidebar.playlists")}),e.jsx(Br,{})]}),e.jsx("div",{className:"flex flex-col overflow-y-auto",children:e.jsx(m,{id:"playlists",className:"px-4 pb-2",children:void 0!==t&&t.length>0?e.jsx(Ur,{playlists:t}):e.jsx(ot,{})})})]})}function Hr({className:s,...t}){return e.jsx("div",{className:h("px-4 py-2 pt-0",s),...t})}function Yr({className:s,...t}){return e.jsx("h2",{className:h("mb-2 px-2 text-lg font-semibold tracking-tight flex justify-between items-center",s),...t})}const Qr=s.memo(Bs),Zr=s.memo(Cs),Jr=s.memo(Gs),Xr=s.memo(vs),el=s.memo(Ws),sl=s.memo(Vs),tl=s.memo(ps),al=s.memo(function({list:a}){const n=yt(),{t:r}=Ve(),l=Se().pages.hideRadiosSection,i=Se().podcasts.active,o=s.useCallback(e=>n.pathname===e,[n.pathname]);return e.jsx(e.Fragment,{children:a.map(s=>l&&s.id===nl.Radios?null:i||s.id!==nl.Podcasts?i&&s.id===nl.Podcasts?e.jsx(Vr,{item:s},s.id):e.jsx(Qs,{to:s.route,tabIndex:-1,className:t("block",o(s.route)&&"pointer-events-none"),onClick:()=>{da({name:s.id})},children:e.jsxs(v,{variant:o(s.route)?"secondary":"ghost",size:"sm",className:"w-full justify-start",children:[e.jsx(s.icon,{className:"w-4 h-4 mr-2"}),r(s.title)]})},s.id):null)})});var nl=(e=>(e.Home="home",e.Artists="artists",e.Songs="songs",e.Favorites="favorites",e.Albums="albums",e.Playlists="playlists",e.Podcasts="podcasts",e.Radios="radios",e))(nl||{});const rl=[],ll=[{id:"artists",title:"sidebar.artists",route:C.LIBRARY.ARTISTS,icon:Zr},{id:"songs",title:"sidebar.songs",route:C.LIBRARY.SONGS,icon:Jr},{id:"albums",title:"sidebar.albums",route:C.LIBRARY.ALBUMS,icon:el},{id:"favorites",title:"sidebar.favorites",route:C.LIBRARY.FAVORITES,icon:tl},{id:"playlists",title:"sidebar.playlists",route:C.LIBRARY.PLAYLISTS,icon:Qr},{id:"podcasts",title:"sidebar.podcasts",route:C.LIBRARY.PODCASTS,icon:sl},{id:"radios",title:"sidebar.radios",route:C.LIBRARY.RADIOS,icon:Xr}];function il({runCommand:s}){const{t:t}=Ve(),a=pt(),n=Se().pages.hideRadiosSection,r=Se().podcasts.active,l=[...rl,...ll];return e.jsx(Kt,{heading:t("command.pages"),children:l.map(({id:l,route:i,title:o})=>n&&l===nl.Radios?null:r||l!==nl.Podcasts?e.jsx(Ht,{onSelect:()=>{da({name:l}),s(()=>a(i))},children:t(o)},i):null)})}const ol={GotoPage:{className:"from-cyan-500 to-blue-500",icon:e.jsx(Us,{})},ChangeTheme:{className:"from-purple-500 to-pink-500",icon:e.jsx(_s,{})},Playlists:{className:"from-blue-600 to-violet-600",icon:e.jsx(Bs,{})},CreatePlaylist:{className:"from-teal-400 to-emerald-600",icon:e.jsx(Ds,{})},ServerManagement:{className:"from-rose-400 to-red-500",icon:e.jsx($s,{})}};function cl({children:s,variant:a}){const{className:n,icon:r}=ol[a];return e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:t("bg-gradient-to-r rounded p-1 text-white",n),children:r}),s]})}function dl({pages:s,setPages:t,runCommand:a}){const{t:n}=Ve(),{setPlaylistDialogState:r}=lt();return e.jsxs(Kt,{heading:n("command.commands.heading"),children:[e.jsx(Ht,{onSelect:()=>t([...s,"GOTO"]),children:e.jsx(cl,{variant:"GotoPage",children:n("command.commands.pages")})}),e.jsx(Ht,{onSelect:()=>t([...s,"THEME"]),children:e.jsx(cl,{variant:"ChangeTheme",children:n("command.commands.theme")})}),e.jsx(Ht,{onSelect:()=>t([...s,"PLAYLISTS"]),children:e.jsx(cl,{variant:"Playlists",children:n("sidebar.playlists")})}),e.jsx(Ht,{onSelect:()=>a(()=>r(!0)),children:e.jsx(cl,{variant:"CreatePlaylist",children:n("playlist.form.create.title")})}),e.jsx(Ht,{onSelect:async()=>t([...s,"SERVER"]),children:e.jsx(cl,{variant:"ServerManagement",children:n("server.management")})})]})}function ul({runCommand:s}){const{t:t}=Ve(),n=pt(),{data:r}=a({queryKey:[qt.playlist.all],queryFn:x.playlists.getAll});return r&&0!==r.length?e.jsx(Kt,{heading:t("sidebar.playlists"),children:r.map(t=>e.jsx(Ht,{value:t.name,onSelect:()=>s(()=>n(C.PLAYLIST.PAGE(t.id))),children:e.jsx(ml,{playlist:t})},t.id))}):null}function ml({playlist:s}){const{t:t}=Ve(),a=s.songCount>0,n=dt(s.duration),r=a?t("playlist.songCount",{count:s.songCount}):null,l=a?t("playlist.duration",{duration:n}):null;return e.jsxs("div",{className:"truncate flex items-center gap-2",children:[e.jsx(Ys.LazyLoadImage,{effect:"opacity",src:k(s.coverArt,"playlist","300"),alt:s.name,className:"bg-accent w-12 min-w-12 h-12 aspect-square rounded shadow-custom-5 text-transparent"}),e.jsxs("div",{className:"truncate",children:[e.jsx("p",{className:"truncate",children:s.name}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx("span",{children:r}),a&&e.jsx(St,{className:"text-muted-foreground"}),e.jsx("span",{children:l})]})]})]})}async function xl(e){return await new Promise(e=>setTimeout(e,1e3)),await e()}const hl=async()=>await xl(x.library.getScanStatus),fl=async()=>await xl(x.library.startScan);function pl(){const{t:s}=Ve(),{isLms:t}=qe(),{data:n,isLoading:r,isFetching:i,refetch:o}=a({queryKey:["server-get-scan-status"],queryFn:hl}),c=n?we(n.lastScan).format("LLL"):"",{mutateAsync:d,isPending:u}=l({mutationKey:["server-start-scan"],mutationFn:fl,onSuccess:async()=>{Se.setState(e=>{e.data.songCount=null})}});const m=r||i||u,x=!m&&n&&!t;return e.jsxs(Kt,{heading:s("server.management"),children:[m&&e.jsx("div",{className:"flex justify-center items-center p-2 mb-2 h-[68px]",children:e.jsx(As,{className:"h-4 w-4 animate-spin"})}),x&&e.jsx("div",{className:"flex flex-col gap-2 p-2 mb-2",children:e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.count&&e.jsx(Q,{variant:"neutral",children:s("server.songCount",{count:parseInt(n.count)})}),n.folderCount&&e.jsx(Q,{variant:"neutral",children:s("server.folderCount",{count:parseInt(n.folderCount)})}),n.lastScan&&e.jsx(Q,{variant:"neutral",children:s("server.lastScan",{date:c})})]})}),e.jsx(Ht,{disabled:m,onSelect:()=>o(),children:s("server.buttons.refresh")}),e.jsx(Ht,{disabled:m,onSelect:()=>async function(){await d()}(),children:s("server.buttons.startScan")})]})}function gl({query:s,songs:t,runCommand:a}){const{t:n}=Ve(),r=pt(),{playSong:l}=S();return e.jsxs(Er,{children:[e.jsxs(Lr,{children:[e.jsx("span",{children:n("sidebar.songs")}),e.jsx(Rr,{onClick:()=>a(()=>r(C.SONGS.SEARCH(s))),children:n("generic.seeMore")})]}),e.jsx(Kt,{children:t.length>0&&t.map(s=>e.jsx(Ht,{value:`song-${s.id}`,className:"border mb-1",onSelect:()=>{a(()=>r(C.ALBUM.PAGE(s.albumId)))},children:e.jsx(zr,{coverArt:s.coverArt,coverArtType:"song",title:s.title,artist:s.artist,onClick:()=>l(s)})},`song-${s.id}`))})]})}function jl({runCommand:s}){const{t:t}=Ve(),{theme:a,setTheme:n}=U();return e.jsx(Kt,{heading:t("theme.label"),children:e.jsx("div",{className:"grid grid-cols-4",children:K.map(t=>e.jsx(Ht,{onSelect:()=>s(()=>n(t)),disabled:t===a,children:e.jsxs("div",{className:"w-full h-full",children:[e.jsx(De,{theme:t}),e.jsx(Fe,{theme:t,isActive:t===a})]})},t))})})}function yl(){const{t:t}=Ve(),{open:n,setOpen:r}=Se(e=>e.command),l=yt(),i=vt(),[o,c]=s.useState(""),[d,u]=s.useState(["HOME"]),[h,f]=s.useState("Aonsoku"),p=d[d.length-1],g="HOME"===p,j=Boolean(function(e){let s=e.length;for(let t=e.length-1;t>=0;t--){const a=e.charCodeAt(t);a>127&&a<=2047?s++:a>2047&&a<=65535&&(s+=2),a>=56320&&a<=57343&&t--}return s}(o)>=3&&"PLAYLISTS"!==p),{data:y}=a({queryKey:[qt.album.single,i.albumId],queryFn:()=>x.albums.getOne(i.albumId),enabled:Boolean(i.albumId),staleTime:ut(5)}),{data:b}=a({queryKey:[qt.artist.single,i.artistId],queryFn:()=>x.artists.getOne(i.artistId),enabled:Boolean(i.artistId),staleTime:ut(5)}),{data:N}=a({queryKey:[qt.playlist.single,i.playlistId],queryFn:()=>x.playlists.getOne(i.playlistId),enabled:Boolean(i.playlistId),staleTime:ut(5)}),{data:w}=a({queryKey:[qt.podcast.one,i.podcastId],queryFn:()=>ea(i.podcastId),enabled:Boolean(i.podcastId),staleTime:ut(5)});s.useEffect(()=>{const e=l.pathname;"/"!==e?"/library/artists"!==e?"/library/songs"!==e?"/library/albums"!==e?"/library/playlists"!==e?"/library/radios"!==e?"/library/podcasts"!==e&&"/library/episodes/latest"!==e?e.startsWith("/library/artists/")&&b?f(b.name):e.startsWith("/library/albums/")&&y?f(y.name):e.startsWith("/library/playlists/")&&N?f(N.name):e.startsWith("/library/podcasts/")&&w?f(w.title||w.description||t("sidebar.podcasts")):e.startsWith("/library/episodes/")?f(t("sidebar.podcasts")):f("/server-config"!==e?"Aonsoku":t("menu.server")):f(t("sidebar.podcasts")):f(t("sidebar.radios")):f(t("sidebar.playlists")):f(t("sidebar.albums")):f(t("sidebar.songs")):f(t("sidebar.artists")):f("Aonsoku")},[l.pathname,y,b,N,w,t]);const{data:k}=a({queryKey:[qt.search,o],queryFn:()=>x.search.get({query:o,albumCount:4,artistCount:4,songCount:4}),enabled:j,staleTime:ut(5)}),C=k?.album??[],S=k?.artist??[],P=k?.song??[],A=Boolean(o&&C.length>0),I=Boolean(o&&S.length>0),E=Boolean(o&&P.length>0);Nt(["/","mod+f","mod+k"],()=>r(!n),{preventDefault:!0});const L=s.useCallback(()=>{c(""),u(["HOME"])},[]),R=s.useCallback(e=>{r(!1),L(),e()},[L,r]),M=Ut(e=>{c(e)},500);const z=s.useCallback(()=>{u(e=>{const s=[...e];return s.splice(-1,1),s})},[]),T=Boolean(j&&!A&&!I&&!E);return e.jsxs(e.Fragment,{children:[e.jsxs(v,{variant:"outline",className:"w-full px-2 gap-2 h-8 overflow-hidden md:relative hidden md:flex",onClick:()=>r(!0),children:[e.jsx(Ks,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("span",{className:"inline-flex text-muted-foreground text-xs",children:h}),e.jsx("div",{className:"absolute right-2",children:e.jsx(dr,{text:"/"})})]}),e.jsx(v,{variant:"outline",className:"w-full h-fit flex flex-col justify-center items-center gap-1 md:hidden",onClick:()=>r(!0),children:e.jsx(Ks,{className:"w-4 h-4"})}),e.jsx(Yt,{open:n,onOpenChange:e=>{g?(r(e),L()):z()},children:e.jsxs(Qt,{shouldFilter:"PLAYLISTS"===p,id:"main-command",children:[e.jsx(Zt,{"data-testid":"command-menu-input",placeholder:t("PLAYLISTS"===p?"options.playlist.search":"command.inputPlaceholder"),autoCorrect:"false",autoCapitalize:"false",spellCheck:"false",onValueChange:e=>function(e){"PLAYLISTS"===p?c(e):M(e)}(e),onKeyDown:function(e){"/"===e.key&&e.preventDefault()}}),e.jsx(m,{className:"max-h-[500px] 2xl:max-h-[700px]",children:e.jsxs(Jt,{className:"max-h-fit pr-1",children:[e.jsx(Xt,{children:t("command.noResults")}),T&&e.jsx("div",{className:"flex justify-center items-center p-4 mt-2 mx-2 bg-accent/40 rounded border border-border",children:e.jsx("p",{className:"text-sm",children:t("command.noResults")})}),A&&e.jsx(Tr,{query:o,albums:C,runCommand:R}),E&&e.jsx(gl,{query:o,songs:P,runCommand:R}),I&&e.jsx(Or,{artists:S,runCommand:R}),g&&e.jsx(dl,{pages:d,setPages:u,runCommand:R}),"GOTO"===p&&e.jsx(il,{runCommand:R}),"THEME"===p&&e.jsx(jl,{runCommand:R}),"PLAYLISTS"===p&&e.jsx(ul,{runCommand:R}),"SERVER"===p&&e.jsx(pl,{})]})}),e.jsxs("div",{className:"flex justify-end p-2 h-10 gap-1 border-t",children:[e.jsx(dr,{text:"ESC",className:"text-sm"}),e.jsx(dr,{text:"↓",className:"text-sm"}),e.jsx(dr,{text:"↑",className:"text-sm"}),e.jsx(dr,{text:"↵",className:"text-sm"})]})]})})]})}function vl({item:s}){const a=yt(),{t:n}=Ve();function r(e){return a.pathname===e}return e.jsxs(e.Fragment,{children:[e.jsx(Qs,{to:s.route,className:t("w-full",r(s.route)&&"pointer-events-none"),onClick:()=>{da({name:s.id})},children:e.jsx($,{text:n(s.title),side:"right",delay:50,children:e.jsx(v,{variant:r(s.route)?"secondary":"ghost",className:"w-full h-fit flex flex-col justify-center items-center gap-1",children:e.jsx(s.icon,{className:"w-4 h-4"})})})}),"podcasts"===s.id&&e.jsx(Gr,{isActive:r(C.EPISODES.LATEST)})]})}const bl=[...rl,...ll];function Nl(){const{pathname:t}=yt();return s.useEffect(()=>{t&&ua()},[t]),e.jsx("main",{className:"flex h-full pl-mini-sidebar xl:pl-sidebar pt-header pb-player",children:e.jsx(m,{id:"main-scroll-area",className:"w-full bg-background-foreground",children:e.jsx(bt,{})})})}const wl=s.memo(function(){const{isFullscreen:t}=Z(),a=s.memo(yl);Ar();const n="windowControlsOverlay"in navigator&&!0===navigator.windowControlsOverlay?.visible,r=function(){const[e,t]=s.useState({visible:!1,titlebarAreaRect:null});return s.useEffect(()=>{const e=navigator.windowControlsOverlay;if(!e)return;const s=()=>{t({visible:e.visible,titlebarAreaRect:e.visible?e.getTitlebarAreaRect():null})};s();const a=()=>{s()};return e.addEventListener("geometrychange",a),()=>{e.removeEventListener("geometrychange",a)}},[]),e}(),l=X(),[i,o]=s.useState({left:0,right:0});s.useEffect(()=>{if(r.visible&&r.titlebarAreaRect){const e=r.titlebarAreaRect,s=e.x,t=window.innerWidth-(e.x+e.width);o({left:s,right:t})}else o({left:0,right:0})},[r.visible,r.titlebarAreaRect]);const c=!t&&(l||n),d=ze&&c,u=c&&(l&&(Be||Y)||n&&i.right>0),m=d?n&&i.left>0?i.left:70:0,x=u?n&&i.right>0?i.right:Be?122:94:0;return e.jsxs("header",{className:"w-full grid grid-cols-header h-header px-4 fixed top-0 right-0 left-0 z-20 bg-background border-b electron-drag",children:[e.jsxs("div",{className:"flex items-center",children:[m>10&&e.jsx("div",{style:{width:m-10+"px"},className:"flex-shrink-0"}),e.jsx("div",{className:"w-8 h-8",children:e.jsx(Qs,{to:"/",children:e.jsx(v,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-md",children:e.jsx(Hs,{className:"w-4 h-4",strokeWidth:1.5})})})}),e.jsxs("div",{className:"md:hidden flex justify-center items-center px-4 gap-2 w-full",children:[e.jsx(or,{}),e.jsx(a,{})]})]}),e.jsx("div",{className:"col-span-2 flex items-center justify-center",children:e.jsxs("div",{className:"hidden md:flex justify-center items-center px-4 gap-2 w-full",children:[e.jsx(or,{}),e.jsx(a,{})]})}),e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsx(Pr,{}),e.jsx(Sr,{}),x>10&&e.jsx("div",{style:{width:x-10+"px"},className:"flex-shrink-0"})]})]})}),kl=s.memo(function(){const{hideRadiosSection:s}=Ge(),{active:t}=We();return e.jsx("aside",{className:"flex xl:hidden flex-col items-center justify-start gap-1 min-w-mini-sidebar max-w-mini-sidebar border-r fixed top-header left-0 bottom-0 pb-player bg-background z-10 p-2",children:bl.map(a=>s&&"radios"===a.id?null:t||"podcasts"!==a.id?e.jsx(vl,{item:a},a.route):null)})}),Cl=s.memo(function({className:s}){const{t:t}=Ve();return e.jsxs("aside",{children:[e.jsxs("div",{className:h("hidden xl:flex flex-col min-w-sidebar max-w-sidebar border-r fixed top-header left-0 bottom-0 pb-player bg-background z-10",s),children:[e.jsx("div",{className:"space-y-4 py-4 pt-4",children:e.jsxs(Hr,{children:[e.jsx(Yr,{children:t("sidebar.library")}),e.jsx("div",{children:e.jsx(al,{list:ll})})]})}),e.jsx(Kr,{})]}),e.jsx(Fr,{})]})}),Sl=s.memo(function(){const t=s.useRef(null),a=s.useRef(null),n=s.useRef(null),[r,l]=s.useState(!1),[i,o]=s.useState(!1),{setAudioPlayerRef:u,setCurrentDuration:m,setProgress:x,setPlayingState:h,handleSongEnded:f,getCurrentProgress:p,getCurrentPodcastProgress:g,togglePlayPause:j,playNextSong:y}=S(),{currentList:b,currentSongIndex:N,radioList:w,podcastList:k}=c(),C=z(),{isSong:P,isRadio:A,isPodcast:I}=re(),E=O(),L=d(),R=pe(),{replayGainType:M,replayGainPreAmp:T,replayGainDefaultGain:F}=le(),{hasNext:B}=q(),W=G(),V=b[N],$=w[N],_=k[N],U=s.useCallback(()=>A?a:I?n:t,[I,A]);s.useEffect(()=>{(P||V)&&(R||null===L&&t.current&&u(t.current))},[L,t,R,P,u,V]),s.useEffect(()=>{const e=()=>{l(window.innerWidth<640)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const K=s.useCallback(()=>{const e=U().current;if(e)if(P&&V?m(V.duration):I&&_&&m(_.duration),I){const s=g();ne.info("[Player] - Resuming episode from:",{seconds:s}),x(s),e.currentTime=s}else{const s=p();e.currentTime=s}},[U,I,P,_,V,m,g,x,p]),H=s.useCallback(()=>{const e=U().current;if(!e)return;const s=Math.floor(e.currentTime);x(s),W&&W>0&&ce.setPositionState(W,s,e.playbackRate)},[U,x,W]),Y=s.useCallback(()=>{const e=U().current;e&&(e.volume=ge()/100)},[U]),Q=s.useCallback(()=>{I&&_&&xt.saveEpisodeProgress(_.id,_.duration).then(()=>{ne.info("Complete progress sent:",_.duration)}).catch(e=>{ne.error("Error sending complete progress",e)})},[I,_]),Z=s.useCallback(e=>{if(!r||window.innerWidth>=640)return;const s=e.target,t=null!==s.closest("button"),a=null!==s.closest('[role="slider"]');t||a||o(!0)},[r]);return e.jsxs("footer",{className:"border-t h-[--player-height] w-full flex items-center fixed bottom-0 left-0 right-0 z-40 bg-background",onClick:Z,children:[e.jsxs("div",{className:"w-full h-full grid grid-cols-[1fr_auto] gap-3 px-3 sm:grid-cols-player sm:gap-2 sm:px-4",children:[e.jsxs("div",{className:"flex items-center gap-1 w-full sm:gap-2",children:[P&&e.jsx(Kn,{song:V,isFullscreenOpen:i,setIsFullscreenOpen:o}),A&&e.jsx(Hn,{radio:$}),I&&e.jsx(Yn,{podcast:_})]}),e.jsxs("div",{className:"hidden sm:col-span-2 sm:flex flex-col justify-center items-center px-4 gap-1",children:[e.jsx(Qn,{song:V,radio:$,podcast:_,audioRef:U()}),(P||I)&&e.jsx(Zn,{audioRef:U()})]}),e.jsxs("div",{className:"flex sm:hidden items-center gap-1",children:[e.jsx(v,{variant:"ghost",disabled:!V&&!$&&!I,onClick:j,"data-testid":"player-button-"+(C?"pause":"play"),className:"size-10 p-0",children:C?e.jsx(ms,{className:"text-foreground fill-foreground size-5"}):e.jsx(xs,{className:"text-foreground fill-foreground size-5"})}),e.jsx(v,{variant:"ghost",disabled:!V&&!$&&!_||!B&&E!==D.All,onClick:y,"data-testid":"player-button-next-mobile",className:"size-10 p-0",children:e.jsx(hs,{className:"text-foreground fill-foreground size-5"})})]}),e.jsx("div",{className:"hidden sm:flex items-center w-full justify-end",children:e.jsxs("div",{className:"flex items-center gap-1",children:[P&&e.jsxs(e.Fragment,{children:[e.jsx(Jn,{disabled:!V}),e.jsx(ar,{disabled:!V}),e.jsx(Xn,{disabled:!V})]}),I&&e.jsx(tr,{}),(A||I)&&e.jsx(er,{disabled:!$&&!_}),e.jsx(sr,{audioRef:U(),disabled:!V&&!$&&!_}),P&&je&&e.jsx(nr,{})]})})]}),P&&V&&!R&&e.jsx(rr,{replayGain:function(){const e=T,s=F;if(!V||!V.replayGain)return{gain:s,peak:1,preAmp:e};if("album"===M){const{albumGain:t=s,albumPeak:a=1}=V.replayGain;return{gain:t,peak:a,preAmp:e}}const{trackGain:t=s,trackPeak:a=1}=V.replayGain;return{gain:t,peak:a,preAmp:e}}(),src:ye(V.id),autoPlay:C,audioRef:t,loop:E===D.One,onPlay:()=>h(!0),onPause:()=>h(!1),onLoadedMetadata:K,onTimeUpdate:H,onEnded:f,onLoadStart:Y,"data-testid":"player-song-audio"}),A&&$&&!R&&e.jsx(rr,{src:$.streamUrl,autoPlay:C,audioRef:a,onPlay:()=>h(!0),onPause:()=>h(!1),onLoadStart:Y,"data-testid":"player-radio-audio"}),I&&_&&!R&&e.jsx(rr,{src:ht(_.audio_url),autoPlay:C,audioRef:n,preload:"auto",onPlay:()=>h(!0),onPause:()=>h(!1),onLoadedMetadata:K,onTimeUpdate:H,onEnded:()=>{Q(),f()},onLoadStart:Y,"data-testid":"player-podcast-audio"})]})}),Pl=s.memo(function(){const{t:s}=Ve(),{songId:n,modalOpen:r,reset:l}=rt(),{data:i,isLoading:o}=a({queryKey:[qt.song.info,n],queryFn:()=>x.songs.getSong(n),enabled:r}),c=!!i&&"string"==typeof i.albumId,{data:d,isLoading:u}=a({queryKey:[qt.album.single,i?.albumId],queryFn:()=>x.albums.getOne(i?.albumId??""),enabled:c});function h(){l()}function f(){if(!i)return[];const e=[];return i.genre&&e.push(i.genre),i.genres&&i.genres.forEach(({name:s})=>{e.includes(s)||e.push(s)}),e}return e.jsx(ve,{open:r,onOpenChange:function(e){e||l()},children:e.jsxs(be,{className:"max-w-[620px] p-0 gap-0 overflow-hidden","aria-describedby":void 0,children:[e.jsx(Ne,{className:"border-b p-6",children:e.jsx(E,{children:s("songInfo.title")})}),(o||u)&&e.jsx("div",{className:"flex w-full h-32 items-center justify-center p-6",children:e.jsx(As,{className:"mr-2 h-4 w-4 animate-spin"})}),!i&&!o&&e.jsx("div",{className:"flex w-full h-32 items-center justify-center p-6",children:e.jsx("p",{children:s("songInfo.error")})}),i&&!o&&e.jsx(m,{className:"p-4",children:e.jsxs("div",{className:"max-h-[500px]",children:[e.jsx(ir,{title:"path",children:e.jsx("code",{className:"font-mono text-xs bg-muted border px-2 py-1 rounded flex gap-2 items-center",children:i.path})}),e.jsx(ir,{title:"title",children:i.title}),e.jsx(ir,{title:"album",children:e.jsx(Qs,{to:C.ALBUM.PAGE(i.albumId),className:"text-foreground hover:underline",onClick:h,children:i.album})}),i.albumArtists&&e.jsx(ir,{title:"albumArtist",children:i.albumArtists.map(({id:s,name:t},a)=>e.jsxs(e.Fragment,{children:[e.jsx(Qs,{to:C.ARTIST.PAGE(s),className:"text-foreground hover:underline",onClick:h,children:t}),a<i.albumArtists.length-1&&e.jsx(St,{className:"mx-0"})]},s))}),i.artists&&e.jsx(ir,{title:"artist",children:i.artists.map(({id:s,name:t},a)=>e.jsxs(e.Fragment,{children:[e.jsx(Qs,{to:C.ARTIST.PAGE(s),className:"text-foreground hover:underline",onClick:h,children:t}),a<i.artists.length-1&&e.jsx(St,{className:"mx-0"})]},s))}),!i.artists&&e.jsx(ir,{title:"artist",children:e.jsx(Qs,{to:C.ARTIST.PAGE(i.artistId??""),className:t("text-foreground",i.artistId?"hover:underline":"pointer-events-none"),onClick:()=>{i.artistId&&h()},children:i.artist})}),i.contributors&&i.contributors.length>1&&e.jsx(ir,{title:"contributors",children:i.contributors.map((s,t)=>e.jsxs("p",{className:"w-full",children:[e.jsxs("span",{className:"capitalize",children:[s.role,":"]}),e.jsx("span",{className:"text-foreground ml-1",children:s.artist.name})]},s.artist.name+t))}),e.jsx(ir,{title:"year",children:i.year}),e.jsx(ir,{title:"discNumber",children:i.discNumber??1}),e.jsx(ir,{title:"track",children:i.track}),d&&!u&&e.jsx(e.Fragment,{children:d.recordLabels&&d.recordLabels.length>0&&e.jsx(ir,{title:"recordLabel",children:d.recordLabels.slice(0,st).map(s=>e.jsx("p",{className:"w-full",children:s.name},s.name))})}),f().length>0&&e.jsx(ir,{title:"genres",children:f().map(s=>e.jsx(Qs,{to:C.ALBUMS.GENRE(s),onClick:h,children:e.jsx(Q,{variant:"neutral",children:s})},s))}),e.jsx(ir,{title:"duration",children:ct(i.duration??0)}),e.jsx(ir,{title:"size",children:lr(i.size??0)}),e.jsx(ir,{title:"bpm",children:i.bpm??0}),e.jsxs(ir,{title:"bitrate",children:[i.bitRate," kbps"]}),e.jsx(ir,{title:"codec",children:e.jsx(Q,{children:i.suffix.toUpperCase()})}),e.jsx(ir,{title:"plays",children:i.playCount??0}),e.jsx(ir,{title:"lastPlayed",children:i.played?e.jsx(e.Fragment,{children:function(){if(!i)return"";const e=we().from(we(i.played),!0);return s("table.lastPlayed",{date:e})}()}):e.jsx(is,{className:"w-4 h-4 -ml-0.5 text-red-500"})}),e.jsx(ir,{title:"favorite",children:i.starred?e.jsx(Is,{className:"w-4 h-4 -ml-0.5 text-primary"}):e.jsx(is,{className:"w-4 h-4 -ml-0.5 text-red-500"})}),i.replayGain&&e.jsxs(e.Fragment,{children:[e.jsxs(ir,{title:"trackGain",children:[i.replayGain.trackGain??0," dB"]}),e.jsx(ir,{title:"trackPeak",children:i.replayGain.trackPeak??1}),e.jsxs(ir,{title:"albumGain",children:[i.replayGain.albumGain??0," dB"]}),e.jsx(ir,{title:"albumPeak",children:i.replayGain.albumPeak??1})]}),i.channelCount&&e.jsx(ir,{title:"channelCount",children:i.channelCount}),i.samplingRate&&e.jsxs(ir,{title:"samplingRate",children:[i.samplingRate/1e3," Hz"]}),e.jsx(ir,{title:"bitDepth",children:i.bitDepth??0})]})})]})})}),Al=s.memo(function(){const{t:s}=Ve(),t=pt(),a=gt(),{playlistId:n,confirmDialogState:i,setConfirmDialogState:o}=nt(),c=r(),d=l({mutationFn:x.playlists.remove,onSuccess:()=>{c.invalidateQueries({queryKey:[qt.playlist.all]}),Pt.success(s("playlist.form.delete.toast.success")),o(!1),function(){const e=a.find(e=>"playlist"===e.id);(e?.params.playlistId??"")===n&&t(C.LIBRARY.HOME)}()},onError:()=>{Pt.error(s("playlist.form.delete.toast.error"))}});return e.jsx(It,{open:i,children:e.jsxs(Et,{children:[e.jsxs(Lt,{children:[e.jsx(Rt,{children:s("playlist.form.delete.title")}),e.jsx(Mt,{children:s("playlist.form.delete.description")})]}),e.jsxs(zt,{children:[e.jsx(Tt,{onClick:()=>o(!1),children:s("logout.dialog.cancel")}),e.jsx(Ot,{onClick:async function(e){e.preventDefault(),await d.mutateAsync(n)},children:s("logout.dialog.confirm")})]})]})})}),Il=s.memo(function(){const{currentSongColor:a,useSongColorOnQueue:n,currentSongColorIntensity:r}=y(),{mainDrawerState:l,closeDrawer:i}=w(),{queueState:o}=L(),{lyricsState:c}=R(),d=s.useMemo(()=>{if(n&&a)return M(a,r)},[a,n,r]);return e.jsx(Ma,{open:l,onClose:i,fixed:!0,handleOnly:!0,disablePreventScroll:!0,dismissible:!0,modal:!1,children:e.jsx(Da,{className:"main-drawer rounded-t-none border-none select-none cursor-default outline-none",showHandle:!1,"aria-describedby":void 0,children:e.jsxs("div",{className:t("flex flex-col w-full h-content","transition-[background-image,background-color] duration-1000",a&&"default-gradient"),style:{backgroundColor:d},children:[e.jsxs("div",{className:"flex w-full h-14 min-h-14 px-[6%] items-center justify-end gap-2",children:[e.jsx(va,{}),e.jsx(v,{variant:"ghost",className:"w-10 h-10 rounded-full p-0 hover:bg-foreground/20",onClick:i,children:e.jsx(cs,{})})]}),e.jsxs("div",{className:"flex w-full h-full mt-8 px-[6%] mb-0",children:[e.jsx(Aa,{}),e.jsxs("div",{className:"flex flex-1 justify-center relative",children:[e.jsx(Ba,{active:o,children:e.jsx(Ra,{})}),e.jsx(Ba,{active:c,children:e.jsx(ma,{})})]})]})]})})})});function El(){return e.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[e.jsx(wl,{}),e.jsx(kl,{}),e.jsx(Cl,{}),e.jsx(Sl,{}),e.jsx(Nl,{}),e.jsx(Pl,{}),e.jsx(Al,{}),e.jsx(Il,{})]})}export{El as default};
