import{o as e}from"./leac-BhF3pvOC.js";import{m as n,a as t,b as a,c as r,o as i,d as s,f as c,l as o,t as m,e as p,g as f,h as u,i as l,r as d}from"./peberminta-BAyYsZUV.js";const y="(?:\\n|\\r\\n|\\r|\\f)",x="[^\\x00-\\x7F]",$="(?:\\\\[0-9a-f]{1,6}(?:\\r\\n|[ \\n\\r\\t\\f])?)",g="(?:\\\\[^\\n\\r\\f0-9a-f])",h=`(?:[_a-z0-9-]|${x}|${$}|${g})`,w=`(?:${h}+)`,v=`(?:[-]?${`(?:[_a-z]|${x}|${$}|${g})`}${h}*)`,E=`'([^\\n\\r\\f\\\\']|\\\\${y}|${x}|${$}|${g})*'`,b=`"([^\\n\\r\\f\\\\"]|\\\\${y}|${x}|${$}|${g})*"`,A=e([{name:"ws",regex:new RegExp("(?:[ \\t\\r\\n\\f]*)")},{name:"hash",regex:new RegExp(`#${w}`,"i")},{name:"ident",regex:new RegExp(v,"i")},{name:"str1",regex:new RegExp(E,"i")},{name:"str2",regex:new RegExp(b,"i")},{name:"*"},{name:"."},{name:","},{name:"["},{name:"]"},{name:"="},{name:">"},{name:"|"},{name:"+"},{name:"~"},{name:"^"},{name:"$"}]),k=e([{name:"unicode",regex:new RegExp($,"i")},{name:"escape",regex:new RegExp(g,"i")},{name:"any",regex:new RegExp("[\\s\\S]","i")}]);function R([e,n,t],[a,r,i]){return[e+a,n+r,t+i]}function S(e){return e.reduce(R,[0,0,0])}const T=t(a(r(m(e=>"unicode"===e.name?String.fromCodePoint(parseInt(e.text.slice(1),16)):void 0),m(e=>"escape"===e.name?e.text.slice(1):void 0),m(e=>"any"===e.name?e.text:void 0))),e=>e.join(""));function P(e){const n=k(e);return T({tokens:n.tokens,options:void 0},0).value}function j(e){return m(n=>n.name===e||void 0)}const z=m(e=>"ws"===e.name?null:void 0),V=i(z,null);function _(e){return n(V,e,V)}const F=m(e=>"ident"===e.name?P(e.text):void 0),I=m(e=>"hash"===e.name?P(e.text.slice(1)):void 0),C=m(e=>e.name.startsWith("str")?P(e.text.slice(1,-1)):void 0),L=l(i(F,""),j("|")),N=s(p(L,F,(e,n)=>({name:n,namespace:e})),t(F,e=>({name:e,namespace:null}))),W=s(p(L,j("*"),e=>({type:"universal",namespace:e,specificity:[0,0,0]})),t(j("*"),()=>({type:"universal",namespace:null,specificity:[0,0,0]}))),Z=t(N,({name:e,namespace:n})=>({type:"tag",name:e,namespace:n,specificity:[0,0,1]})),q=p(j("."),F,(e,n)=>({type:"class",name:n,specificity:[0,1,0]})),B=t(I,e=>({type:"id",name:e,specificity:[1,0,0]})),D=m(e=>{if("ident"===e.name){if("i"===e.text||"I"===e.text)return"i";if("s"===e.text||"S"===e.text)return"s"}}),G=s(p(C,i(d(V,D),null),(e,n)=>({value:e,modifier:n})),p(F,i(d(z,D),null),(e,n)=>({value:e,modifier:n}))),H=r(t(j("="),()=>"="),p(j("~"),j("="),()=>"~="),p(j("|"),j("="),()=>"|="),p(j("^"),j("="),()=>"^="),p(j("$"),j("="),()=>"$="),p(j("*"),j("="),()=>"*=")),J=s(u(j("["),_(N),j("]"),(e,{name:n,namespace:t})=>({type:"attrPresence",name:n,namespace:t,specificity:[0,1,0]})),n(j("["),u(_(N),H,_(G),({name:e,namespace:n},t,{value:a,modifier:r})=>({type:"attrValue",name:e,namespace:n,matcher:t,value:a,modifier:r,specificity:[0,1,0]})),j("]"))),K=s(W,Z),M=r(B,q,J),O=t(s(c(K,a(M)),f(M)),e=>({type:"compound",list:e,specificity:S(e.map(e=>e.specificity))})),Q=s(_(r(t(j(">"),()=>">"),t(j("+"),()=>"+"),t(j("~"),()=>"~"),p(j("|"),j("|"),()=>"||"))),t(z,()=>" ")),U=o(O,t(Q,e=>(n,t)=>({type:"compound",list:[...t.list,{type:"combinator",combinator:e,left:n,specificity:n.specificity}],specificity:R(n.specificity,t.specificity)})),O);function X(e,n,t=1){return`${e.replace(/(\t)|(\r)|(\n)/g,(e,n,t)=>n?"␉":t?"␍":"␊")}\n${"".padEnd(n)}${"^".repeat(t)}`}function Y(e){return function(e,n){if(!("string"==typeof n||n instanceof String))throw new Error("Expected a selector string. Actual input is not a string!");const t=A(n);if(!t.complete)throw new Error(`The input "${n}" was only partially tokenized, stopped at offset ${t.offset}!\n`+X(n,t.offset));const a=_(e)({tokens:t.tokens,options:void 0},0);if(!a.matched)throw new Error(`No match for "${n}" input!`);if(a.position<t.tokens.length){const e=t.tokens[a.position];throw new Error(`The input "${n}" was only partially parsed, stopped at offset ${e.offset}!\n`+X(n,e.offset,e.len))}return a.value}(U,e)}function ee(e){if(!e.type)throw new Error("This is not an AST node.");switch(e.type){case"universal":return ne(e.namespace)+"*";case"tag":return ne(e.namespace)+ae(e.name);case"class":return"."+ae(e.name);case"id":return"#"+ae(e.name);case"attrPresence":return`[${ne(e.namespace)}${ae(e.name)}]`;case"attrValue":return`[${ne(e.namespace)}${ae(e.name)}${e.matcher}"${n=e.value,n.replace(/(")|(\\)|(\x00)|([\x01-\x1f]|\x7f)/g,(e,n,t,a,r)=>n?'\\"':t?"\\\\":a?"�":te(r))}"${e.modifier?e.modifier:""}]`;case"combinator":return ee(e.left)+e.combinator;case"compound":return e.list.reduce((e,n)=>"combinator"===n.type?ee(n)+e:e+ee(n),"");case"list":return e.list.map(ee).join(",")}var n}function ne(e){return e||""===e?ae(e)+"|":""}function te(e){return`\\${e.codePointAt(0).toString(16)} `}function ae(e){return e.replace(/(^[0-9])|(^-[0-9])|(^-$)|([-0-9a-zA-Z_]|[^\x00-\x7F])|(\x00)|([\x01-\x1f]|\x7f)|([\s\S])/g,(e,n,t,a,r,i,s,c)=>n?te(n):t?"-"+te(t.slice(1)):a?"\\-":r||(i?"�":s?te(s):"\\"+c))}function re(e){if(!e.type)throw new Error("This is not an AST node.");switch(e.type){case"compound":e.list.forEach(re),e.list.sort((e,n)=>ce(ie(e),ie(n)));break;case"combinator":re(e.left);break;case"list":e.list.forEach(re),e.list.sort((e,n)=>ee(e)<ee(n)?-1:1)}return e}function ie(e){switch(e.type){case"universal":case"tag":return[1];case"id":return[2];case"class":return[3,e.name];case"attrPresence":return[4,ee(e)];case"attrValue":return[5,ee(e)];case"combinator":return[15,ee(e)]}}function se(e,n){return ce(e,n)}function ce(e,n){if(!Array.isArray(e)||!Array.isArray(n))throw new Error("Arguments must be arrays.");const t=e.length<n.length?e.length:n.length;for(let a=0;a<t;a++)if(e[a]!==n[a])return e[a]<n[a]?-1:1;return e.length-n.length}export{se as c,re as n,Y as p,ee as s};
