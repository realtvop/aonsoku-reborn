import{o as t}from"./lodash-DSAJ3Ow_.js";import{ah as s}from"./index-Dw_5HS3q.js";function e(t){const e=t.startsWith("/")?t.substring(1):t;return new URL(`/api/${e}`,function(){const{serviceUrl:t}=s.getState().podcasts;return t}())}function r(){const t=s.getState(),{useDefaultUser:e,customUser:r,customUrl:n}=t.podcasts,{username:o,url:a}=t.data;return e?{"APP-USERNAME":o,"APP-SERVER-URL":a}:{"APP-USERNAME":r,"APP-SERVER-URL":n}}async function n(s,n){try{const o=e(s);if(n.query)for(const[t,s]of Object.entries(n.query))void 0!==s&&o.searchParams.append(t,s.toString());const a=t(n,"query");a.headers={...r(),...n.headers};const c=await fetch(o,a);if(!c.ok){let t=`Request failed with status ${c.status}: ${c.statusText}`;try{const s=await c.json();s.message&&(t=`${c.status} - ${s.message}`)}catch{}throw console.error(t),new Error(t)}return 204===c.status?null:await c.json()}catch(o){return console.error("Error in podcastClient:",o),null}}function o(t){return t}const a={getAll:async function(t){const s={...t};return await n("/podcasts",{method:"GET",query:s})},getOne:async function(t,s){const e=s?{...s}:{};return await n(`/podcasts/${t}`,{method:"GET",query:e})},create:async function(t){return await n("/podcasts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},unfollow:async function(t){try{return await n(`/podcasts/${t}`,{method:"DELETE"}),{success:!0}}catch(s){return s instanceof Error?{success:!1,error:s.message}:{success:!1,error:"An unexpected error occurred"}}},search:async function(t){const s={...t};return await n("/podcasts/search",{method:"GET",query:s})},getEpisode:async function(t){return await n(`/episodes/${t}`,{method:"GET"})},getLatest:async function(){return await n("/episodes/latest",{method:"GET"})},searchEpisodes:async function(t,s){const e=s?{...s}:{},r=`/episodes/podcast/${t}/search`;return await n(r,{method:"GET",query:e})},saveEpisodeProgress:async function(t,s){const e=`/episodes/${t}/progress`;return await n(e,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({progress:s})})}};export{o as g,a as p};
