import{j as t}from"./react-BohqOKG4.js";import{l as e}from"./parseTexts-Bb18-_77.js";import{I as s,D as o}from"./data-table-C37ukUF7.js";import{C as r,s as i}from"./album-QeQcH2md.js";import{u as n,c as a,d as l}from"./@tanstack-3eZgfo06.js";import{b as m,ay as u,a5 as c,l as d,aw as p,az as j,R as b,aA as g,aB as f}from"./index-Dw_5HS3q.js";import{q as y}from"./queryKeys-DxXuT4IC.js";import{A as x}from"./actions-CD5wk-PF.js";import{O as h}from"./equalizer-bars-BP_G2EY6.js";import{c as v,A as I}from"./play-button-BMYlYUiF.js";import{u as k}from"./react-i18next-CJXO39OJ.js";import{R as w}from"./song-title-ClQcdcyq.js";import{P as A}from"./preview-list-BZKLP10E.js";import S from"./error-page-BuqrGUN1.js";import{s as L}from"./songs-columns-DLWRqf9R.js";import{a as T}from"./convertSecondsToTime-B1d9sDyx.js";import{h as F}from"./react-router-C-_aAzNf.js";import"./crypto-js-jXt9otfP.js";import"./html-to-text-CBZxtrEf.js";import"./@selderee-RfmdOesI.js";import"./selderee-BSueesG9.js";import"./parseley-BjfzG1td.js";import"./leac-BhF3pvOC.js";import"./peberminta-BAyYsZUV.js";import"./domhandler-BfnXUw5w.js";import"./domelementtype-wvvL8fxI.js";import"./htmlparser2-BkjpP7DB.js";import"./entities-C7W22rEe.js";import"./deepmerge-Clcdar8H.js";import"./dom-serializer-BRtYF6lV.js";import"./linkify-it-CKPG3_41.js";import"./uc.micro-CVDs0LYO.js";import"./@chriscodesthings-bGFwLvh6.js";import"./clsx-BeLtu-UY.js";import"./react-lazy-load-image-component-DTPOgetJ.js";import"./react-router-dom-DLqO9Z-p.js";import"./react-dom-DeCT9Zg9.js";import"./scheduler-CuPG8W_I.js";import"./@remix-run-C5FxfqAA.js";import"./dot-Ccno5lbS.js";import"./lightbox-B7s_JddE.js";import"./yet-another-react-lightbox-DMOFwxG4.js";import"./react-device-detect-CHs-JbVH.js";import"./ua-parser-js-oxSasMdn.js";import"./react-hotkeys-hook-qKPfarcW.js";import"./options-hS6iO596.js";import"./lucide-react-DrCvGt71.js";import"./@radix-ui-LgTM4vlv.js";import"./aria-hidden-DyxP-6dL.js";import"./react-remove-scroll-yCREhh_0.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BNI7vDx9.js";import"./react-style-singleton-C1oTdtRg.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-DQWw4Coi.js";import"./use-callback-ref-DIudPNPV.js";import"./@floating-ui-VDk0qcgD.js";import"./use-sync-external-store-C4iHanJs.js";import"./react-toastify-Dcxz3wpx.js";import"./i18next-CM37CVQ3.js";import"./i18next-browser-languagedetector-F0gxWJsw.js";import"./tailwind-extended-shadows-merge-DdKC4l0c.js";import"./tailwind-merge-5Glu2Zmz.js";import"./class-variance-authority-DO3vQtTq.js";import"./lodash-DSAJ3Ow_.js";import"./zustand-Bqgea8iK.js";import"./immer-Dwi4ZIhD.js";import"./dayjs-BG2b1roC.js";import"./idb-keyval-PpvEIwUC.js";import"./fast-average-color-Dy3p1ZbH.js";import"./@hookform-CXDBdaWi.js";import"./react-hook-form-C23o4OKy.js";import"./use-debounce-CVLZIJWc.js";import"./zod-DxP4i6Pi.js";import"./react-country-flag-DV3c0LTu.js";import"./cmdk-DpOb1GNg.js";import"./command-9rYDq5Wc.js";import"./cover-image-zpWg5P0A.js";import"./card-_SOi_N1H.js";import"./embla-carousel-react-C1VFpNTw.js";import"./embla-carousel-reactive-utils-P2_yCQ-B.js";import"./embla-carousel-B8ffWQHD.js";import"./action-button-BoxuniMX.js";import"./like-button-BExMQkwT.js";import"./data-table-column-header-Bz-4KByJ.js";function C({comment:s}){const o=e(s);return t.jsx("div",{className:"mt-8 text-sm text-muted-foreground p-4 bg-muted rounded-md border border-border",children:t.jsx("p",{className:"html whitespace-pre-line",dangerouslySetInnerHTML:{__html:o}})})}function q({album:e}){const{playNext:s,playLast:o,startDownload:r,addToPlaylist:i,createNewPlaylist:n}=v();return t.jsxs(t.Fragment,{children:[t.jsxs(u,{children:[t.jsx(h.PlayNext,{onClick:function(){s(e.song,{albumId:e.id})}}),t.jsx(h.PlayLast,{onClick:function(){o(e.song,{albumId:e.id})}})]}),t.jsx(c,{}),t.jsx(h.AddToPlaylistOption,{variant:"dropdown",children:t.jsx(I,{type:"dropdown",newPlaylistFn:function(){const t=e.song.map(t=>t.id);n(e.name,t)},addToPlaylistFn:function(t){const s=e.song.map(t=>t.id);i(t,s)}})}),t.jsx(c,{}),t.jsx(u,{children:t.jsx(h.Download,{onClick:function(){r(e.id)}})})]})}function N({album:e,showInfoButton:s}){const{t:o}=k(),{setSongList:r}=d(),{showInfoPanel:i,toggleShowInfoPanel:n}=p(),u=void 0!==e.starred,c=a(),j=l({mutationFn:m.star.handleStarItem,onSuccess:()=>{c.invalidateQueries({queryKey:[y.album.single,e.id]})}});const b={play:o("playlist.buttons.play",{name:e.name}),shuffle:o("playlist.buttons.shuffle",{name:e.name}),options:o("playlist.buttons.options",{name:e.name}),like:()=>o(u?"album.buttons.dislike":"album.buttons.like",{name:e.name}),info:()=>o(i?"generic.hideDetails":"generic.showDetails")};return t.jsxs(x.Container,{children:[t.jsx(x.Button,{tooltip:b.play,buttonStyle:"primary",onClick:()=>r(e.song,0,!1,{albumId:e.id}),children:t.jsx(x.PlayIcon,{})}),e.song.length>1&&t.jsx(x.Button,{tooltip:b.shuffle,onClick:()=>r(e.song,0,!0,{albumId:e.id}),children:t.jsx(x.ShuffleIcon,{})}),t.jsx(x.Button,{tooltip:b.like(),onClick:function(){e&&j.mutate({id:e.id,starred:u})},children:t.jsx(x.LikeIcon,{isStarred:u})}),s&&t.jsx(x.Button,{tooltip:b.info(),onClick:n,children:t.jsx(x.InfoIcon,{})}),t.jsx(x.Dropdown,{tooltip:b.options,options:t.jsx(q,{album:e})})]})}function P({album:e}){const{data:s}=(o=e.id,n({queryKey:[y.album.info,o],queryFn:()=>m.albums.getInfo(o),enabled:!!o}));var o;const i=void 0!==s&&void 0!==s.notes;return t.jsxs(t.Fragment,{children:[t.jsx(N,{album:e,showInfoButton:i}),i&&t.jsx(r,{title:e.name,bio:s.notes,lastFmUrl:s.lastFmUrl})]})}function B({album:e}){if(!e.recordLabels)return null;if(0===e.recordLabels.length)return null;const s=e.recordLabels.slice(0,w);return t.jsx("div",{className:"w-full mt-8 text-muted-foreground text-[0.6875rem] font-normal",children:s.map(s=>t.jsx("p",{children:`â„— ${e.year} ${s.name}`},s.name))})}function R(){const{albumId:e}=F(),{setSongList:r}=d(),{t:a}=k(),{data:l,isLoading:u,isFetched:c}=(t=>n({queryKey:[y.album.single,t],queryFn:()=>m.albums.getOne(t)}))(e),{data:p,isLoading:x}=(h=l?.artistId||"",n({queryKey:[y.album.moreAlbums,h],queryFn:()=>m.artists.getOne(h),enabled:!!h}));var h;const{data:v,isLoading:I}=(w=l?.genre||"",n({queryKey:[y.album.genreAlbums,w],queryFn:()=>m.albums.getAlbumList({type:"byGenre",genre:w,size:16}),enabled:!!w}));var w;const q=p?.album;if(u)return t.jsx(j,{});if(c&&!l)return t.jsx(S,{status:404,statusText:a("error.notFound")});if(!l)return t.jsx(j,{});const N=L(),R=l.duration?T(l.duration):null,D=[{content:l.year?.toString()??null,type:"text"},{content:l.genre??null,type:"link",link:b.ALBUMS.GENRE(l.genre)},{content:l.songCount?a("playlist.songCount",{count:l.songCount}):null,type:"text"},{content:R?a("playlist.duration",{duration:R}):null,type:"text"}];function z(t,e=!1){if(0===t.length||!l)return null;let s=t.filter(t=>t.id!==l.id);return e&&(s=i(s)),s.length>16&&(s=s.slice(0,16)),0===s.length?null:s}const K=q?z(q,!0):null,U=v?.list&&l.genre?z(v.list):null,M=l.song.length>0?l.song[0].comment:null;return t.jsxs("div",{className:"w-full",children:[t.jsx(s,{type:a("album.headline"),title:l.name,subtitle:l.artist,artistId:l.artistId,artists:l.artists,coverArtId:l.coverArt,coverArtType:"album",coverArtSize:"700",coverArtAlt:l.name,badges:D}),t.jsxs(g,{children:[t.jsx(P,{album:l}),t.jsx(o,{columns:N,data:l.song,handlePlaySong:t=>r(l.song,t.index,!1,{albumId:l.id}),columnFilter:["trackNumber","title","duration","playCount","played","bitRate","contentType","select"],showDiscNumber:!0,variant:"modern"}),M&&t.jsx(C,{comment:M}),t.jsx(B,{album:l}),t.jsxs("div",{className:"mt-4",children:[x&&t.jsx(f,{}),K&&!x&&l.artistId&&t.jsx(A,{list:K,showMore:!0,title:a("album.more.listTitle"),moreTitle:a("album.more.discography"),moreRoute:b.ALBUMS.ARTIST(l.artistId,l.artist)}),I&&t.jsx(f,{}),!I&&U&&t.jsx(A,{list:U,moreRoute:b.ALBUMS.GENRE(l.genre),title:a("album.more.genreTitle",{genre:l.genre})})]})]})]})}export{R as default};
