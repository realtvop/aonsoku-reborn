import{j as s,r as e}from"./react-BohqOKG4.js";import{e as t,b as r,c as o,d as a,u as i}from"./@tanstack-3eZgfo06.js";import{aC as n,b6 as l,b0 as c,aD as d,b7 as m,aA as p,b8 as j,aF as u,R as h,F as x,B as f,i as g,b9 as y}from"./index-Dw_5HS3q.js";import{u as b}from"./react-router-dom-DLqO9Z-p.js";import{E as v}from"./episode-card-B3VqFz9P.js";import{b as w,c as N,g as F}from"./podcasts-CYE4JVOZ.js";import{q as P}from"./queryKeys-DxXuT4IC.js";import{g as S}from"./scrollPageToTop-WHsCYcia.js";import{E as k}from"./episodes-filters-OaOobcWY.js";import{u as q}from"./react-i18next-CJXO39OJ.js";import{ag as T,Y as _,ah as z,ai as D,G as I}from"./lucide-react-DrCvGt71.js";import{h as E,b as L}from"./react-router-C-_aAzNf.js";import{D as R}from"./dot-Ccno5lbS.js";import{p as A}from"./parseTexts-Bb18-_77.js";import{P as C,a as K,R as M,T as Q,S as Y,D as B,b as G}from"./texts-BeXZSqzY.js";import{B as O}from"./react-toastify-Dcxz3wpx.js";import{A as H,h as V,a as J,b as U,c as W,d as X,e as Z,f as $,g as ss}from"./alert-dialog-Dv-UtMUK.js";import{p as es}from"./podcasts-CyXJRW_v.js";import ts from"./error-page-BuqrGUN1.js";import"./crypto-js-jXt9otfP.js";import"./react-dom-DeCT9Zg9.js";import"./scheduler-CuPG8W_I.js";import"./react-lazy-load-image-component-DTPOgetJ.js";import"./i18next-CM37CVQ3.js";import"./i18next-browser-languagedetector-F0gxWJsw.js";import"./react-device-detect-CHs-JbVH.js";import"./ua-parser-js-oxSasMdn.js";import"./clsx-BeLtu-UY.js";import"./tailwind-extended-shadows-merge-DdKC4l0c.js";import"./tailwind-merge-5Glu2Zmz.js";import"./@radix-ui-LgTM4vlv.js";import"./aria-hidden-DyxP-6dL.js";import"./react-remove-scroll-yCREhh_0.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BNI7vDx9.js";import"./react-style-singleton-C1oTdtRg.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-DQWw4Coi.js";import"./use-callback-ref-DIudPNPV.js";import"./@floating-ui-VDk0qcgD.js";import"./use-sync-external-store-C4iHanJs.js";import"./class-variance-authority-DO3vQtTq.js";import"./lodash-DSAJ3Ow_.js";import"./zustand-Bqgea8iK.js";import"./immer-Dwi4ZIhD.js";import"./dayjs-BG2b1roC.js";import"./idb-keyval-PpvEIwUC.js";import"./fast-average-color-Dy3p1ZbH.js";import"./@hookform-CXDBdaWi.js";import"./react-hook-form-C23o4OKy.js";import"./use-debounce-CVLZIJWc.js";import"./zod-DxP4i6Pi.js";import"./react-country-flag-DV3c0LTu.js";import"./@remix-run-C5FxfqAA.js";import"./equalizer-bars-BP_G2EY6.js";import"./use-podcast-playing-DKljUg_d.js";import"./convertSecondsToTime-B1d9sDyx.js";import"./expandable-input-BTLclRgg.js";import"./html-to-text-CBZxtrEf.js";import"./@selderee-RfmdOesI.js";import"./selderee-BSueesG9.js";import"./parseley-BjfzG1td.js";import"./leac-BhF3pvOC.js";import"./peberminta-BAyYsZUV.js";import"./domhandler-BfnXUw5w.js";import"./domelementtype-wvvL8fxI.js";import"./htmlparser2-BkjpP7DB.js";import"./entities-C7W22rEe.js";import"./deepmerge-Clcdar8H.js";import"./dom-serializer-BRtYF6lV.js";import"./linkify-it-CKPG3_41.js";import"./uc.micro-CVDs0LYO.js";import"./lightbox-B7s_JddE.js";import"./yet-another-react-lightbox-DMOFwxG4.js";function rs(){const{t:e}=q();return s.jsx("div",{className:"w-full px-8 mt-4",children:s.jsxs("div",{className:"w-full h-64 flex flex-col items-center justify-center gap-2 text-muted-foreground border border-dashed rounded-md",children:[s.jsxs("div",{className:"relative flex items-center justify-center",children:[s.jsx(T,{className:"w-6 h-6 rotate-90 absolute"}),s.jsx(_,{className:"w-6 h-6"})]}),s.jsx("p",{children:e("podcasts.list.notFoundMessage")})]})})}const os=e.memo(k),{Query:as,MainFilter:is}=d,ns=s=>({position:"absolute",width:"100%",top:s});function ls({title:e,podcastId:t}){const{t:r}=q(),i=L(),n=o(),l=a({mutationFn:es.unfollow,onSuccess:()=>{n.invalidateQueries({queryKey:[P.podcast.all]}),O.success(r("podcasts.header.unfollow.toasts.success")),i(h.LIBRARY.PODCASTS)},onError:()=>{O.error(r("podcasts.header.unfollow.toasts.error"))}});return s.jsxs(H,{children:[s.jsx(x,{text:r("podcasts.header.unfollow.tooltip",{title:e}),children:s.jsx(V,{asChild:!0,children:s.jsx(f,{size:"icon",className:"rounded-full p-0 aspect-square",children:s.jsx(z,{className:"w-4 h-4 fill-primary-foreground"})})})}),s.jsxs(J,{children:[s.jsxs(U,{children:[s.jsx(W,{children:r("podcasts.header.unfollow.dialog.title")}),s.jsx(X,{children:r("podcasts.header.unfollow.dialog.description")})]}),s.jsxs(Z,{children:[s.jsx($,{children:r("logout.dialog.cancel")}),s.jsx(ss,{onClick:async function(s){s.preventDefault(),await l.mutateAsync(t)},children:r("logout.dialog.confirm")})]})]})]})}const cs=e.memo(function({podcast:e}){const{t:t}=q();return s.jsxs(C,{children:[s.jsx(K,{src:e.image_url,alt:e.title}),s.jsxs(M,{children:[s.jsxs("div",{className:"flex gap-3 items-center",children:[s.jsx(Q,{children:e.title}),s.jsx(ls,{title:e.title,podcastId:e.id})]}),s.jsx(Y,{children:e.author}),s.jsx(g,{}),s.jsx(B,{children:A(e.description)}),s.jsxs(G.Root,{children:[s.jsx(G.Text,{children:t("podcasts.header.episodeCount",{count:e.episode_count})}),s.jsx(R,{}),s.jsxs(G.Link,{href:e.feed_url,children:[s.jsx(D,{className:"w-4 h-4"}),t("podcasts.header.feed")]}),e.link&&s.jsxs(s.Fragment,{children:[s.jsx(R,{}),s.jsxs(G.Link,{href:e.link,children:[s.jsx(I,{className:"w-4 h-4"}),t("podcasts.header.website")]})]})]})]})]})}),ds=e.memo(function(){const{podcastId:o}=E(),[a]=b(),{getSearchParam:i}=new n(a),d=e.useRef(null),{PublishedAt:h}=l,{Desc:x}=c,f=i(is,""),g=i("orderBy",h),y=i("sort",x),F=i(as,"");e.useEffect(()=>{d.current=S()},[]);const{data:k,fetchNextPage:q,hasNextPage:T,isLoading:_,isFetching:z,isFetchingNextPage:D}=t({queryKey:[P.episode.all,o,g,y,f,F],queryFn:async({pageParam:s=1})=>f===u.Search&&""!==F?w(o,{query:F,order_by:g,sort:y,page:s,per_page:40,filter_by:"title"}):N(o,{order_by:g,sort:y,page:s,per_page:40}),initialPageParam:1,getNextPageParam:s=>s.nextOffset}),I=k?k.pages.flatMap(s=>s.episodes):[],L=e.useMemo(()=>{if(k&&k.pages.length>0){const s=k.pages[0].count;if(s)return s}return T?I.length+1:I.length},[k,I.length,T]),R=r({count:L,getScrollElement:()=>d.current,estimateSize:()=>124,overscan:5}),A=R.getVirtualItems();return e.useEffect(()=>{const[s]=[...A].reverse();if(!s||z)return;s.index>=I.length-1&&T&&!D&&q()},[I.length,q,T,z,D,A]),_?s.jsx(m,{}):k&&0!==I.length?s.jsxs("div",{children:[s.jsx(os,{}),s.jsx(p,{className:"px-4",children:s.jsx("div",{style:{height:R.getTotalSize(),position:"relative"},children:A.map(e=>{if(e.index>I.length-1)return s.jsx("div",{style:ns(e.start),children:s.jsx(j,{})},e.index);const t=I[e.index];return s.jsx(v,{episode:t,style:ns(e.start)},e.index)})})})]}):s.jsx(rs,{})});function ms(){const{podcastId:e}=E(),{data:t,isFetched:r,isLoading:o}=i({queryKey:[P.podcast.one,e],queryFn:()=>F(e)});return o?s.jsx(y,{}):r&&!t?s.jsx(ts,{status:404,statusText:"Not Found"}):t?s.jsxs("div",{className:"h-full",children:[s.jsx(cs,{podcast:t}),s.jsx(ds,{})]}):s.jsx(y,{})}export{ms as default};
