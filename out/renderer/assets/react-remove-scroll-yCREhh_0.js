import{_ as e,a as t,b as n}from"./tslib-Bc9CN1Ef.js";import{r}from"./react-BohqOKG4.js";import{z as o,f as a,R as c}from"./react-remove-scroll-bar-BNI7vDx9.js";import{c as l,e as i}from"./use-sidecar-DQWw4Coi.js";import{u}from"./use-callback-ref-DIudPNPV.js";import{s}from"./react-style-singleton-C1oTdtRg.js";var f=l(),d=function(){},v=r.forwardRef(function(n,o){var a=r.useRef(null),c=r.useState({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:d}),l=c[0],i=c[1],s=n.forwardProps,v=n.children,h=n.className,m=n.removeScrollBar,p=n.enabled,w=n.shards,g=n.sideCar,b=n.noRelative,E=n.noIsolation,y=n.inert,R=n.allowPinchZoom,C=n.as,k=void 0===C?"div":C,S=n.gapMode,N=e(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),L=g,M=u([a,o]),T=t(t({},N),l);return r.createElement(r.Fragment,null,p&&r.createElement(L,{sideCar:f,removeScrollBar:m,shards:w,noRelative:b,noIsolation:E,inert:y,setCallbacks:i,allowPinchZoom:!!R,lockRef:a,gapMode:S}),s?r.cloneElement(r.Children.only(v),t(t({},T),{ref:M})):r.createElement(k,t({},T,{className:h,ref:M}),v))});v.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},v.classNames={fullWidth:a,zeroRight:o};var h=!1;if("undefined"!=typeof window)try{var m=Object.defineProperty({},"passive",{get:function(){return h=!0,!0}});window.addEventListener("test",m,m),window.removeEventListener("test",m,m)}catch(P){h=!1}var p=!!h&&{passive:!1},w=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===n[t])},g=function(e,t){var n=t.ownerDocument,r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),b(e,r)){var o=E(e,r);if(o[1]>o[2])return!0}r=r.parentNode}while(r&&r!==n.body);return!1},b=function(e,t){return"v"===e?function(e){return w(e,"overflowY")}(t):function(e){return w(e,"overflowX")}(t)},E=function(e,t){return"v"===e?[(n=t).scrollTop,n.scrollHeight,n.clientHeight]:function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t);var n},y=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},R=function(e){return[e.deltaX,e.deltaY]},C=function(e){return e&&"current"in e?e.current:e},k=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},S=0,N=[];function L(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const M=i(f,function(e){var t=r.useRef([]),o=r.useRef([0,0]),a=r.useRef(),l=r.useState(S++)[0],i=r.useState(s)[0],u=r.useRef(e);r.useEffect(function(){u.current=e},[e]),r.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(l));var t=n([e.lockRef.current],(e.shards||[]).map(C),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(l))}),function(){document.body.classList.remove("block-interactivity-".concat(l)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(l))})}}},[e.inert,e.lockRef.current,e.shards]);var f=r.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!u.current.allowPinchZoom;var n,r=y(e),c=o.current,l="deltaX"in e?e.deltaX:c[0]-r[0],i="deltaY"in e?e.deltaY:c[1]-r[1],s=e.target,f=Math.abs(l)>Math.abs(i)?"h":"v";if("touches"in e&&"h"===f&&"range"===s.type)return!1;var d=g(f,s);if(!d)return!0;if(d?n=f:(n="v"===f?"h":"v",d=g(f,s)),!d)return!1;if(!a.current&&"changedTouches"in e&&(l||i)&&(a.current=n),!n)return!0;var v=a.current||n;return function(e,t,n,r){var o=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),a=o*r,c=n.target,l=t.contains(c),i=!1,u=a>0,s=0,f=0;do{if(!c)break;var d=E(e,c),v=d[0],h=d[1]-d[2]-o*v;(v||h)&&b(e,c)&&(s+=h,f+=v);var m=c.parentNode;c=m&&m.nodeType===Node.DOCUMENT_FRAGMENT_NODE?m.host:m}while(!l&&c!==document.body||l&&(t.contains(c)||t===c));return(u&&Math.abs(s)<1||!u&&Math.abs(f)<1)&&(i=!0),i}(v,t,e,"h"===v?l:i)},[]),d=r.useCallback(function(e){var n=e;if(N.length&&N[N.length-1]===i){var r="deltaY"in n?R(n):y(n),o=t.current.filter(function(e){return e.name===n.type&&(e.target===n.target||n.target===e.shadowParent)&&(t=e.delta,o=r,t[0]===o[0]&&t[1]===o[1]);var t,o})[0];if(o&&o.should)n.cancelable&&n.preventDefault();else if(!o){var a=(u.current.shards||[]).map(C).filter(Boolean).filter(function(e){return e.contains(n.target)});(a.length>0?f(n,a[0]):!u.current.noIsolation)&&n.cancelable&&n.preventDefault()}}},[]),v=r.useCallback(function(e,n,r,o){var a={name:e,delta:n,target:r,should:o,shadowParent:L(r)};t.current.push(a),setTimeout(function(){t.current=t.current.filter(function(e){return e!==a})},1)},[]),h=r.useCallback(function(e){o.current=y(e),a.current=void 0},[]),m=r.useCallback(function(t){v(t.type,R(t),t.target,f(t,e.lockRef.current))},[]),w=r.useCallback(function(t){v(t.type,y(t),t.target,f(t,e.lockRef.current))},[]);r.useEffect(function(){return N.push(i),e.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:w}),document.addEventListener("wheel",d,p),document.addEventListener("touchmove",d,p),document.addEventListener("touchstart",h,p),function(){N=N.filter(function(e){return e!==i}),document.removeEventListener("wheel",d,p),document.removeEventListener("touchmove",d,p),document.removeEventListener("touchstart",h,p)}},[]);var M=e.removeScrollBar,T=e.inert;return r.createElement(r.Fragment,null,T?r.createElement(i,{styles:k(l)}):null,M?r.createElement(c,{noRelative:e.noRelative,gapMode:e.gapMode}):null)});var T=r.forwardRef(function(e,n){return r.createElement(v,t({},e,{ref:n,sideCar:M}))});T.classNames=v.classNames;export{T as R};
