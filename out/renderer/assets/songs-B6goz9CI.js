import{b as t,b1 as e,b0 as s}from"./index-Dw_5HS3q.js";const n={songs:[],nextOffset:null};function o(t,n,o){const a=o===s.Asc;return t.sort((t,s)=>{let o=0;switch(n){case e.LastAdded:o=new Date(t.created).getTime()-new Date(s.created).getTime();break;case e.Artist:o=(t.artist||"").localeCompare(s.artist||"");break;case e.Title:o=(t.title||"").localeCompare(s.title||"");break;case e.Album:o=(t.album||"").localeCompare(s.album||"");break;default:o=new Date(t.created).getTime()-new Date(s.created).getTime()}return a?o:-o})}let a=null;async function r(r){const u=r.orderBy||e.LastAdded,l=r.sort||s.Desc;if(r.query&&""!==r.query.trim()){const e=await t.search.get({artistCount:0,albumCount:0,query:r.query,songCount:r.songCount,songOffset:r.songOffset});if(!e)return n;if(!e.song)return n;const s=o(e.song,u,l);let a=null;return s.length>=r.songCount&&(a=r.songOffset+r.songCount),{songs:s,nextOffset:a}}const g=await async function(n=e.LastAdded,r=s.Desc){const u=Date.now();if(a&&a.timestamp&&u-a.timestamp<3e5)return o(a.songs,n,r);const l=await t.search.get({query:"",artistCount:0,albumCount:0,songCount:999999,songOffset:0});return l&&l.song?(a={songs:l.song,timestamp:u},o(l.song,n,r)):[]}(u,l);if(0===g.length)return n;const i=r.songOffset,c=i+r.songCount,f=g.slice(i,c);let m=null;return c<g.length&&(m=c),{songs:f,nextOffset:m}}async function u(a,r={}){const u=r.orderBy||e.LastAdded,l=r.sort||s.Desc,g=await t.artists.getOne(a);if(!g||!g.album)return n;return{songs:o((await Promise.all(g.album.map(e=>t.albums.getOne(e.id)))).flatMap(t=>t?t.song:[]),u,l),nextOffset:null}}async function l(){const e=await t.songs.getFavoriteSongs();return console.log(e),e&&e.song?{songs:e.song,nextOffset:null}:{songs:[],nextOffset:null}}export{u as a,l as g,r as s};
