import{j as e}from"./react-BohqOKG4.js";import{l as t,k as a,B as s,R as r,M as i,b as o,b3 as l,aB as d}from"./index-Dw_5HS3q.js";import{A as n}from"./embla-carousel-autoplay-CET5eQU-.js";import{c as m}from"./clsx-BeLtu-UY.js";import{l as c}from"./react-device-detect-CHs-JbVH.js";import{b as u}from"./react-lazy-load-image-component-DTPOgetJ.js";import{L as p}from"./react-router-dom-DLqO9Z-p.js";import{c as j,b as g}from"./convertSecondsToTime-B1d9sDyx.js";import{n as x}from"./lucide-react-DrCvGt71.js";import{a as b,b as h,c as f,P as y}from"./preview-list-BZKLP10E.js";import{u as v}from"./@tanstack-3eZgfo06.js";import{q as N}from"./queryKeys-DxXuT4IC.js";import{u as L}from"./react-i18next-CJXO39OJ.js";import"./crypto-js-jXt9otfP.js";import"./react-dom-DeCT9Zg9.js";import"./scheduler-CuPG8W_I.js";import"./react-toastify-Dcxz3wpx.js";import"./i18next-CM37CVQ3.js";import"./i18next-browser-languagedetector-F0gxWJsw.js";import"./tailwind-extended-shadows-merge-DdKC4l0c.js";import"./tailwind-merge-5Glu2Zmz.js";import"./@radix-ui-LgTM4vlv.js";import"./aria-hidden-DyxP-6dL.js";import"./react-remove-scroll-yCREhh_0.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BNI7vDx9.js";import"./react-style-singleton-C1oTdtRg.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-DQWw4Coi.js";import"./use-callback-ref-DIudPNPV.js";import"./@floating-ui-VDk0qcgD.js";import"./use-sync-external-store-C4iHanJs.js";import"./class-variance-authority-DO3vQtTq.js";import"./lodash-DSAJ3Ow_.js";import"./zustand-Bqgea8iK.js";import"./immer-Dwi4ZIhD.js";import"./dayjs-BG2b1roC.js";import"./idb-keyval-PpvEIwUC.js";import"./fast-average-color-Dy3p1ZbH.js";import"./@hookform-CXDBdaWi.js";import"./react-hook-form-C23o4OKy.js";import"./use-debounce-CVLZIJWc.js";import"./zod-DxP4i6Pi.js";import"./react-country-flag-DV3c0LTu.js";import"./@remix-run-C5FxfqAA.js";import"./react-router-C-_aAzNf.js";import"./ua-parser-js-oxSasMdn.js";import"./card-_SOi_N1H.js";import"./embla-carousel-react-C1VFpNTw.js";import"./embla-carousel-reactive-utils-P2_yCQ-B.js";import"./embla-carousel-B8ffWQHD.js";function A({song:l}){const{setSongList:d}=t();const n=a(l.coverArt,"song","400");return e.jsxs("div",{className:m("w-full h-[100px] sm:h-[250px] 2xl:h-[300px] relative",c.isFirefox&&"bg-black/60"),children:[e.jsx("div",{"data-testid":"header-bg",className:"absolute -inset-10 bg-cover bg-center z-0 bg-skeleton",style:{backgroundImage:`url(${n})`,filter:c.isFirefox?"blur(24px)":void 0}}),e.jsx("div",{className:m("w-full h-full bg-gradient-to-b from-background/40 to-background/80 absolute z-10",!c.isFirefox&&"backdrop-blur-xl"),children:e.jsxs("div",{className:"flex h-full p-4 2xl:p-6 gap-4",children:[e.jsxs("div",{className:"h-full aspect-square relative group bg-skeleton rounded-lg","data-testid":"header-image-container",children:[e.jsx(u.LazyLoadImage,{src:n,alt:l.title,effect:"opacity",width:"100%",height:"100%",className:"aspect-square rounded-lg object-cover bg-center absolute inset-0 z-0","data-testid":"header-image"}),e.jsx("div",{className:"w-full h-full flex items-center justify-center rounded-lg bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-colors duration-300 absolute inset-0 z-10",children:e.jsx(s,{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-full w-14 h-14",variant:"outline",onClick:()=>async function(e){const t=await o.albums.getOne(e.albumId);if(t){const a=t.song.findIndex(t=>t.id===e.id);d(t.song,a,!1,{albumId:t.id})}}(l),"data-testid":"header-play-button",children:e.jsx(x,{className:"fill-foreground"})})})]}),e.jsxs("div",{className:"flex flex-1 h-full flex-col justify-end",children:[e.jsx(p,{to:r.ALBUM.PAGE(l.albumId),className:"w-fit",children:e.jsx("h1",{"data-testid":"header-title",className:"w-full scroll-m-20 text-xl sm:text-3xl 2xl:text-4xl font-bold tracking-tight mb-0 2xl:mb-1 hover:underline line-clamp-2",children:l.title})}),l.artistId?e.jsx(p,{to:r.ARTIST.PAGE(l.artistId),className:"w-fit",children:e.jsx("h4",{"data-testid":"header-artist",className:"scroll-m-20 text-base sm:text-lg 2xl:text-xl font-semibold tracking-tight opacity-70 hover:underline",children:l.artist})}):e.jsx("h4",{"data-testid":"header-artist",className:"scroll-m-20 text-base sm:text-lg 2xl:text-xl font-semibold tracking-tight opacity-70",children:l.artist}),e.jsxs("div",{className:"hidden sm:flex gap-2 mt-1 2xl:mt-2",children:[void 0!==l.genre&&e.jsx(p,{to:r.ALBUMS.GENRE(l.genre),className:"flex",children:e.jsx(i,{variant:"neutral",className:"border","data-testid":"header-genre",children:l.genre})}),l.year&&e.jsx(i,{variant:"neutral",className:"border","data-testid":"header-year",children:l.year}),e.jsx(i,{variant:"neutral",className:"border","data-testid":"header-duration",children:j(l.duration)})]})]})]})})]})}function k({songs:t}){return 0===t.length?null:e.jsx(b,{className:"w-full border rounded-lg overflow-hidden z-10",opts:{loop:!0},plugins:[n({delay:1e4})],"data-testid":"header-carousel",children:e.jsx(h,{className:"ml-0 flex transform-gpu",style:{borderRadius:"calc(var(--radius) - 2px)"},children:t.map((t,a)=>e.jsx(f,{className:"pl-0 basis-full maskImage-carousel-item","data-testid":`carousel-header-song-${a}`,children:e.jsx(A,{song:t})},t.id))})})}function w(){const{t:t}=L(),{data:a,isLoading:s,isFetching:i}=v({queryKey:[N.song.random],queryFn:()=>o.songs.getRandomSongs({size:10})}),n=v({queryKey:[N.album.recentlyPlayed],queryFn:()=>o.albums.getAlbumList({size:16,type:"recent"}),refetchInterval:g(2)}),m=v({queryKey:[N.album.mostPlayed],queryFn:()=>o.albums.getAlbumList({size:16,type:"frequent"})}),c=v({queryKey:[N.album.recentlyAdded],queryFn:()=>o.albums.getAlbumList({size:16,type:"newest"})}),u=v({queryKey:[N.album.random],queryFn:()=>o.albums.getAlbumList({size:16,type:"random"})}),p=[{title:t("home.recentlyPlayed"),data:n.data,loader:n.isLoading,route:r.ALBUMS.RECENTLY_PLAYED},{title:t("home.mostPlayed"),data:m.data,loader:m.isLoading,route:r.ALBUMS.MOST_PLAYED},{title:t("home.recentlyAdded"),data:c.data,loader:c.isLoading,route:r.ALBUMS.RECENTLY_ADDED},{title:t("home.explore"),data:u.data,loader:u.isLoading,route:r.ALBUMS.RANDOM}];return e.jsxs("div",{className:"w-full px-8 py-6",children:[i||s?e.jsx(l,{}):e.jsx(k,{songs:a||[]}),p.map(t=>t.loader?e.jsx(d,{},t.title):t.data&&t.data?.list?e.jsx(y,{title:t.title,moreRoute:t.route,list:t.data.list},t.title):null)]})}export{w as default};
