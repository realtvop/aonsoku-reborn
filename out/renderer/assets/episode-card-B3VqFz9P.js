import{j as e,r as s}from"./react-BohqOKG4.js";import{c as a}from"./clsx-BeLtu-UY.js";import{b as o}from"./react-lazy-load-image-component-DTPOgetJ.js";import{L as i}from"./react-router-dom-DLqO9Z-p.js";import{u as t,O as r,E as n}from"./equalizer-bars-BP_G2EY6.js";import{a1 as d,a2 as l,B as c,a3 as p,R as m,P as u,a5 as x,i as f}from"./index-Dw_5HS3q.js";import{d as g,a as j,c as h,u as y,b as P}from"./use-podcast-playing-DKljUg_d.js";import{p as w}from"./parseTexts-Bb18-_77.js";import{af as v,aj as b,m as N,n as k}from"./lucide-react-DrCvGt71.js";import{c as E,d as C}from"./@tanstack-3eZgfo06.js";import{p as D}from"./podcasts-CyXJRW_v.js";import{q as z}from"./queryKeys-DxXuT4IC.js";import{b as S}from"./react-router-C-_aAzNf.js";import{u as q}from"./react-i18next-CJXO39OJ.js";function A({featured:s=!1,children:o}){return e.jsxs(d,{children:[e.jsx(l,{asChild:!0,className:"outline-none focus-visible:ring-0 focus-visible:ring-transparent ring-0 ring-offset-transparent",children:e.jsx(c,{variant:"ghost",size:"icon",className:a("w-8 h-8 p-1 rounded-full data-[state=open]:bg-accent",!s&&"hover:bg-background"),onClick:e=>e.stopPropagation(),children:e.jsx(v,{className:"w-3 h-3"})})}),o&&e.jsx(p,{align:"end",onClick:e=>e.stopPropagation(),children:o})]})}function _({episode:s,latest:a}){const{handlePlayNext:o,handlePlayLast:i}=g({id:s.id}),{handleDownload:n,markAsPlayedMutation:d,gotoEpisode:l,gotoPodcast:c}=function({episode:e}){const s=S(),a=E(),{downloadBrowser:o,downloadDesktop:i}=t();return{handleDownload:function(){u()?i(e.audio_url,e.id):o(e.audio_url,e.id)},markAsPlayedMutation:C({mutationFn:()=>D.saveEpisodeProgress(e.id,e.duration),onSuccess:()=>{Promise.all([a.invalidateQueries({queryKey:[z.episode.latest]}),a.invalidateQueries({queryKey:[z.episode.all,e.podcast_id]})])}}),gotoPodcast:function(){s(m.PODCASTS.PAGE(e.podcast_id))},gotoEpisode:function(){s(m.EPISODES.PAGE(e.id))}}}({episode:s});return e.jsxs(e.Fragment,{children:[e.jsx(r.PlayNext,{variant:"dropdown",onClick:e=>{e.stopPropagation(),o()}}),e.jsx(r.PlayLast,{variant:"dropdown",onClick:e=>{e.stopPropagation(),i()}}),e.jsx(r.MarkAsPlayed,{variant:"dropdown",onClick:e=>{e.stopPropagation(),d.mutate()}}),a&&e.jsxs(e.Fragment,{children:[e.jsx(x,{}),e.jsx(r.GotoPodcast,{variant:"dropdown",type:"episode",onClick:e=>{e.stopPropagation(),l()}}),e.jsx(r.GotoPodcast,{variant:"dropdown",type:"podcast",onClick:e=>{e.stopPropagation(),c()}})]}),e.jsx(x,{}),e.jsx(r.Download,{variant:"dropdown",onClick:e=>{e.stopPropagation(),n()}})]})}const I=s.memo(function({episode:s}){return e.jsxs("div",{className:a("w-[100px] h-[100px] min-w-[100px] min-h-[100px]","bg-skeleton aspect-square bg-cover bg-center","rounded-md overflow-hidden border border-border","shadow-custom-3 relative"),onClick:e=>{e.stopPropagation(),e.preventDefault()},children:[e.jsx(K,{effect:"opacity",src:s.image_url,alt:s.title,width:"100%",height:"100%",className:"aspect-square object-cover w-full h-full"}),e.jsx("div",{className:"w-full h-full absolute z-20 inset-0 flex items-center justify-center group/play cursor-pointer",children:e.jsx(M,{episodeId:s.id})})]})}),F=s.memo(function({episode:s}){const{isPlaying:o,isEpisodePlaying:i}=j({id:s.id}),{episodeReleaseDate:t}=h(s.published_at);return e.jsxs("div",{className:"flex flex-col flex-1 space-y-1 min-w-64",children:[e.jsxs("div",{className:"flex gap-1 items-center max-h-4",children:[i&&o&&e.jsx(n,{size:14,className:"text-muted-foreground mb-1"}),e.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase w-fit",children:t})]}),e.jsx("h4",{className:a("text-sm font-medium w-fit max-w-full truncate",i&&"text-primary"),children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:w(s.description)})]})}),G=s.memo(A),L=s.memo(_),T=s.memo(function({episode:s}){const{t:a}=q(),{duration:o,playback:i}=s,{episodeDuration:t,hasPlaybackData:r,isEpisodeCompleted:n,remainingTimeText:d,listeningProgressPercentage:l}=y({duration:o,playback:i});if(!r)return e.jsx("span",{children:t});if(n)return e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{children:a("podcasts.list.progress.completed")})]});return e.jsxs(e.Fragment,{children:[e.jsx("span",{children:a("podcasts.list.progress.remainingTime",{time:d})}),e.jsx("div",{className:"w-3/6 h-1 rounded-full relative bg-secondary overflow-hidden",children:e.jsx("div",{className:"absolute z-10 bg-primary h-full",style:{width:`${l}%`}})})]})});function O({episode:s,latest:a=!1,...o}){return e.jsxs("div",{className:"group/row",...o,children:[e.jsxs(i,{to:m.EPISODES.PAGE(s.id),className:"flex gap-2 items-center px-4 py-3 rounded-lg max-w-full group-hover/row:bg-foreground/20",children:[e.jsx(I,{episode:s}),e.jsx(F,{episode:s}),e.jsx("div",{className:"min-w-[14%] flex flex-col gap-1 items-center justify-center text-xs text-muted-foreground",children:e.jsx(T,{episode:s})}),e.jsx("div",{className:"min-w-16 flex items-center justify-end",children:e.jsx(G,{children:e.jsx(L,{episode:s,latest:a})})})]}),e.jsx("div",{className:"px-4",children:e.jsx(f,{})})]})}const K=s.memo(o.LazyLoadImage),M=s.memo(function({episodeId:s}){const{isPlaying:a,isEpisodePlaying:o,isNotPlaying:i}=j({id:s}),{handlePlayEpisode:t}=P({id:s});return e.jsxs(c,{variant:"ghost",size:"icon",className:"rounded-full bg-background/60 backdrop-blur-md opacity-0 group-hover/row:opacity-100 transition-opacity group-hover/play:bg-background",onClick:t,children:[o&&a&&e.jsx(N,{className:"w-4 h-4 fill-foreground"}),i&&e.jsx(k,{className:"w-4 h-4 fill-foreground"})]})});export{O as E,A as P,_ as a};
