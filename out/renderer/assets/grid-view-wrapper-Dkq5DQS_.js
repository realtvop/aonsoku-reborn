import{r as e,j as t}from"./react-BohqOKG4.js";import{u as r}from"./@virtual-grid-CgdFuaQH.js";import{g as n,s as i}from"./gridTools-sj1_E2oR.js";import{g as s}from"./scrollPageToTop-WHsCYcia.js";import{b as o}from"./@tanstack-3eZgfo06.js";function u({list:u,children:a,titleHeight:c=40,gap:l=16,padding:m=32,defaultWidth:f=181,type:h}){const d=e.useRef(null),[g,p]=e.useState(4),[w,v]=e.useState({width:f,height:f+c}),y=e.useRef(!1),j=e.useRef(!1),T=e.useRef(!1),z=location.pathname+location.search,x=e.useMemo(()=>Math.ceil(u.length/g),[g,u.length]),E=e.useCallback(()=>{if(!d.current)return{width:f,height:f+c};const e=(d.current.offsetWidth-2*m-(g-1)*l)/g;return{width:e,height:e+c}},[f,l,g,m,c]);e.useLayoutEffect(()=>{d.current=s();const e=()=>{const e=window.innerWidth;p(e>=1536?8:e>=1024?6:4);const t=E();v(t)};let t;const r=()=>{t&&cancelAnimationFrame(t),t=requestAnimationFrame(e)};return e(),window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r),cancelAnimationFrame(t)}},[E]);const I=r({scrollRef:d,count:u.length,totalCount:u.length,columns:g,rows:x,size:w,padding:{x:m},gap:l,overscan:5}),L=o(I.rowVirtualizer),R=o(I.columnVirtualizer);return e.useLayoutEffect(()=>{L.measure(),R.measure(),T.current=!0},[L,R,I.virtualItemHeight,I.virtualItemWidth]),e.useLayoutEffect(()=>{if(!T.current||y.current)return;const e=n({name:h});if(!e)return void(y.current=!0);const t=e[z]??0;t<=0?y.current=!0:(setTimeout(()=>{L.scrollToOffset(t),y.current=!0,setTimeout(()=>{j.current=!1},100)},50),j.current=!0)},[z,L,h]),e.useEffect(()=>{if(j.current||!y.current||!z)return;const e=L.scrollOffset??0;e<=0||i({name:h,offsetTop:e,routeKey:z})},[z,L.scrollOffset,h]),t.jsx("div",{style:{width:R.getTotalSize(),height:L.getTotalSize(),position:"relative"},children:L.getVirtualItems().map(r=>t.jsx(e.Fragment,{children:R.getVirtualItems().map(e=>{const n=I.getVirtualItem({row:r,column:e});if(!n)return null;const i=u[n.index];return t.jsx("div",{style:n.style,children:a(i)},e.key)})},r.key))})}export{u as G};
