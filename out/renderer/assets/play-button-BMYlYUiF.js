import{j as a}from"./react-BohqOKG4.js";import{u as s,C as t,O as e,a as n,b as o,c as i,d as l,E as r}from"./equalizer-bars-BP_G2EY6.js";import{c,d,u as p}from"./@tanstack-3eZgfo06.js";import{l as m,b as u,b2 as x,P as y,a6 as g,S as f,Y as h,t as j,u as v,B as P}from"./index-Dw_5HS3q.js";import{c as w,s as N,d as S,i as b}from"./zustand-Bqgea8iK.js";import{q as k}from"./queryKeys-DxXuT4IC.js";import{f as I}from"./react-router-C-_aAzNf.js";import{h as C}from"./cmdk-DpOb1GNg.js";import{u as F}from"./react-i18next-CJXO39OJ.js";import{c as D,d as O,e as A,f as T,C as L}from"./command-9rYDq5Wc.js";import{d as q,n as z,m as K}from"./lucide-react-DrCvGt71.js";const R=w()(N(S(b(a=>({playlistDialogState:!1,data:{},setPlaylistDialogState:s=>{a(a=>{a.playlistDialogState=s})},setData:s=>{a(a=>{a.data=s})},removeSong:{confirmDialogState:!1,setConfirmDialogState:s=>{a(a=>{a.removeSong.confirmDialogState=s})},actionData:{playlistId:"",songIndexes:[]},setActionData:s=>{a(a=>{a.removeSong.actionData=s})}},removePlaylist:{confirmDialogState:!1,setConfirmDialogState:s=>{a(a=>{a.removePlaylist.confirmDialogState=s})},playlistId:"",setPlaylistId:s=>{a(a=>{a.removePlaylist.playlistId=s})}}})),{name:"playlists_store"}))),M=()=>R(a=>a),Q=()=>R(a=>a.removeSong),W=()=>R(a=>a.removePlaylist),B=w()(N(S(b(a=>({songInfo:{songId:"",setSongId:s=>{a(a=>{a.songInfo.songId=s})},modalOpen:!1,setModalOpen:s=>{a(a=>{a.songInfo.modalOpen=s})},reset:()=>{a(a=>{a.songInfo.songId="",a.songInfo.modalOpen=!1})}}})),{name:"ui_store"}))),E=()=>B(a=>a.songInfo);function Y(){const{setNextOnQueue:a,setLastOnQueue:t,setSongList:e}=m(),{downloadBrowser:n,downloadDesktop:o}=s(),{setActionData:i,setConfirmDialogState:l}=Q(),r=I(),{setSongId:p,setModalOpen:g}=E(),f=r.find(a=>"playlist"===a.id),h=f?.params.playlistId??"",j=c();const v=d({mutationFn:u.playlists.update,onSuccess:()=>{f&&j.invalidateQueries({queryKey:[k.playlist.single,h]})}});const P=d({mutationFn:u.playlists.createWithDetails,onSuccess:()=>{j.invalidateQueries({queryKey:[k.playlist.all]})}});return{play:function(a,s){e(a,0,!1,s)},playNext:function(s,t){a(s,t)},playLast:function(a,s){t(a,s)},startDownload:function(a){const s=x(a);y()?o(s,a):n(s)},addToPlaylist:async function(a,s){await v.mutateAsync({playlistId:a,songIdToAdd:s})},createNewPlaylist:async function(a,s){await P.mutateAsync({name:a,comment:"",isPublic:"false",songIdToAdd:s})},removeSongFromPlaylist:function(a){i({playlistId:h,songIndexes:a}),l(!0)},openSongInfo:function(a){p(a),g(!0)},isOnPlaylistPage:f,playlistId:h}}function _(){const{t:s}=F();return a.jsx("div",{className:"w-full flex justify-center items-center py-2 px-4 text-sm rounded-md bg-secondary",children:a.jsx("span",{children:s("sidebar.emptyPlaylist")})})}function G(){const{t:s}=F();return a.jsx("div",{className:"w-full flex justify-center items-center py-2 px-4 text-sm rounded bg-accent",children:a.jsx("span",{children:s("options.playlist.notFound")})})}function H({newPlaylistFn:s,addToPlaylistFn:e,type:n="dropdown"}){const{t:o}=F(),{data:i}=p({queryKey:[k.playlist.all],queryFn:u.playlists.getAll});return a.jsx(a.Fragment,{children:a.jsxs(D,{children:[a.jsx(O,{placeholder:o("options.playlist.search"),onKeyDown:function(a){(["ArrowLeft","ArrowRight","Escape"].includes(a.key)||1===a.key.length)&&a.stopPropagation()}}),a.jsx("div",{className:"p-1 border-b",children:"dropdown"===n?a.jsxs(g,{className:"flex p-1 items-center h-10",onClick:s,autoFocus:!1,children:[a.jsx(q,{className:"w-4 h-4 mr-2 ml-1"}),a.jsx("span",{children:o("options.playlist.create")})]}):a.jsxs(t,{className:"flex p-1 items-center h-10",onClick:s,autoFocus:!1,children:[a.jsx(q,{className:"w-4 h-4 mr-2 ml-1"}),a.jsx("span",{children:o("options.playlist.create")})]})}),a.jsx(f,{className:"h-[300px]",type:"always",children:a.jsxs(A,{className:"max-h-fit max-w-[298px]",children:[a.jsx(T,{className:"p-1",children:a.jsx(G,{})}),a.jsx(L,{children:i&&i.map(s=>a.jsx(C,{value:s.name,className:"mr-1.5",children:"dropdown"===n?a.jsx(g,{className:"truncate h-10",onClick:()=>e(s.id),children:a.jsx("span",{className:"truncate pl-1",children:s.name})}):a.jsx(t,{className:"truncate h-10",onClick:()=>e(s.id),children:a.jsx("span",{className:"truncate pl-1",children:s.name})})},s.id))})]})})]})})}function J({variant:s,song:t,index:o}){const{playNext:i,playLast:l,createNewPlaylist:r,addToPlaylist:c,removeSongFromPlaylist:d,startDownload:p,openSongInfo:m,isOnPlaylistPage:u}=Y(),x=[o.toString()];return a.jsxs(a.Fragment,{children:[a.jsx(e.PlayNext,{variant:s,onClick:a=>{a.stopPropagation(),i([t])}}),a.jsx(e.PlayLast,{variant:s,onClick:a=>{a.stopPropagation(),l([t])}}),a.jsx(n,{}),a.jsx(e.AddToPlaylistOption,{variant:s,children:a.jsx(H,{type:s,newPlaylistFn:()=>r(t.title,t.id),addToPlaylistFn:a=>c(a,t.id)})}),u&&a.jsx(e.RemoveFromPlaylist,{variant:s,onClick:a=>{a.stopPropagation(),d(x)}}),a.jsx(n,{}),a.jsx(e.Download,{variant:s,onClick:a=>{a.stopPropagation(),p(t.id)}}),a.jsx(n,{}),a.jsx(e.SongInfo,{variant:s,onClick:a=>{a.stopPropagation(),m(t.id)}})]})}function U({table:s}){const{t:o}=F(),i=Y(),{rows:l}=s.getFilteredSelectedRowModel(),r=1===l.length,c=l.map(a=>a.original),d=c[0];function p(a){a(),s.resetRowSelection()}return a.jsxs(a.Fragment,{children:[a.jsx(e.PlayNext,{variant:"context",onClick:a=>{a.stopPropagation(),async function(){p(()=>i.playNext(c))}()}}),a.jsx(e.PlayLast,{variant:"context",onClick:a=>{a.stopPropagation(),async function(){p(()=>i.playLast(c))}()}}),a.jsx(n,{}),a.jsx(e.AddToPlaylistOption,{variant:"context",children:a.jsx(H,{type:"context",newPlaylistFn:async function(){const a=c.map(a=>a.id);p(()=>i.createNewPlaylist(d.title,a))},addToPlaylistFn:async function(a){const s=c.map(a=>a.id);p(()=>i.addToPlaylist(a,s))}})}),i.isOnPlaylistPage&&a.jsx(e.RemoveFromPlaylist,{variant:"context",onClick:a=>{a.stopPropagation(),function(){const a=l.map(a=>a.index.toString());p(()=>i.removeSongFromPlaylist(a))}()}}),r&&a.jsxs(a.Fragment,{children:[a.jsx(n,{}),a.jsx(e.Download,{variant:"context",onClick:a=>{a.stopPropagation(),async function(){r&&p(()=>i.startDownload(d.id))}()}}),a.jsx(n,{}),a.jsx(e.SongInfo,{variant:"context",onClick:a=>{a.stopPropagation(),r&&p(()=>i.openSongInfo(d.id))}})]}),a.jsx(n,{}),a.jsx(t,{disabled:!0,inset:!0,children:o("table.menu.selectedCount",{count:l.length})})]})}function V(a,s){const t=Math.min(a,s),e=Math.max(a,s),n={};for(let o=t;o<=e;o++)n[o]=!0;return n}function X({children:s,options:t,onOpenChange:e}){const n=void 0!==t;return a.jsxs(o,{modal:!1,onOpenChange:e,children:[a.jsx(i,{asChild:!0,disabled:!n,children:s}),n&&a.jsx(l,{className:"min-w-56",children:t})]})}function Z({trackNumber:s,trackId:t,handlePlayButton:e}){const{checkActiveSong:n,togglePlayPause:o}=m(),{isSong:i,isRadio:l}=h(),c=j(),{radioList:d,currentSongIndex:p}=v(),u=()=>i?n(t):!!l&&d[p].id===t;return a.jsxs("div",{className:"w-full h-full text-center text-foreground flex items-center justify-center",children:[u()&&!c&&a.jsx("div",{className:"w-8 flex items-center",children:a.jsx(P,{className:"w-8 h-8 rounded-full group hover:bg-background hover:shadow-sm border-0",size:"icon",variant:"outline",onClick:a=>{a.stopPropagation(),o()},children:a.jsx(z,{className:"w-3 h-3 opacity-70 group-hover:opacity-100 text-foreground fill-foreground transition-opacity",strokeWidth:4})})}),u()&&c&&a.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[a.jsx("div",{className:"absolute opacity-100 group-hover/tablerow:opacity-0 w-8 h-8 flex items-center",children:a.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:a.jsx(r,{size:18,className:"mb-1"})})}),a.jsx("div",{className:"absolute opacity-0 group-hover/tablerow:opacity-100 flex justify-center",children:a.jsx(P,{className:"w-8 h-8 rounded-full group hover:bg-background hover:shadow-sm border-0",size:"icon",variant:"outline",onClick:a=>{a.stopPropagation(),o()},children:a.jsx(K,{className:"w-4 h-4 opacity-70 group-hover:opacity-100 text-foreground fill-foreground transition-opacity",strokeWidth:1})})})]}),!u()&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"group-hover/tablerow:hidden w-8 h-8 flex items-center justify-center",children:s}),a.jsx("div",{className:"hidden group-hover/tablerow:block",children:a.jsx(P,{className:"w-8 h-8 rounded-full group hover:bg-background hover:shadow-sm border-0",size:"icon",variant:"outline",onClick:a=>{a.stopPropagation(),e()},children:a.jsx(z,{className:"w-3 h-3 opacity-70 group-hover:opacity-100 text-foreground fill-foreground transition-opacity",strokeWidth:4})})})]})]})}export{H as A,X as C,_ as E,Z as P,U as S,E as a,M as b,Y as c,Q as d,J as e,V as f,W as u};
