import{j as e,r as s}from"./react-BohqOKG4.js";import{c as a,d as r,u as t}from"./@tanstack-3eZgfo06.js";import{c as o}from"./clsx-BeLtu-UY.js";import{S as i,H as l}from"./header-title-BpiRIAyn.js";import{E as n}from"./empty-wrapper-DCqAaDSN.js";import{B as c,ab as m,ac as d,ad as j,D as h,al as x,ar as u,b as f,ay as p,a6 as g,Y as y,u as b,l as w,aX as v,aA as N}from"./index-Dw_5HS3q.js";import{c as S,s as U,d as k,i as D}from"./zustand-Bqgea8iK.js";import{u as C}from"./react-i18next-CJXO39OJ.js";import{t as P}from"./@hookform-CXDBdaWi.js";import{u as K}from"./react-hook-form-C23o4OKy.js";import{B as q}from"./react-toastify-Dcxz3wpx.js";import{F as z,a as F,b as A,c as E,d as R,e as W}from"./form-Db6hBv4K.js";import{q as I}from"./queryKeys-DxXuT4IC.js";import{o as L,s as O,l as _}from"./zod-DxP4i6Pi.js";import{A as B,a as H,b as Q,c as T,d as J,e as V,f as X,g as Y}from"./alert-dialog-Dv-UtMUK.js";import{D as $}from"./data-table-list-CEoMo1BX.js";import{T as G}from"./action-button-BoxuniMX.js";import{ac as M,ad as Z,t as ee,d as se}from"./lucide-react-DrCvGt71.js";import{P as ae}from"./play-button-BMYlYUiF.js";import{D as re}from"./data-table-column-header-Bz-4KByJ.js";import{i as te}from"./i18next-CM37CVQ3.js";import"./crypto-js-jXt9otfP.js";import"./react-dom-DeCT9Zg9.js";import"./scheduler-CuPG8W_I.js";import"./react-lazy-load-image-component-DTPOgetJ.js";import"./i18next-browser-languagedetector-F0gxWJsw.js";import"./react-router-dom-DLqO9Z-p.js";import"./react-router-C-_aAzNf.js";import"./@remix-run-C5FxfqAA.js";import"./react-device-detect-CHs-JbVH.js";import"./ua-parser-js-oxSasMdn.js";import"./tailwind-extended-shadows-merge-DdKC4l0c.js";import"./tailwind-merge-5Glu2Zmz.js";import"./@radix-ui-LgTM4vlv.js";import"./aria-hidden-DyxP-6dL.js";import"./react-remove-scroll-yCREhh_0.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BNI7vDx9.js";import"./react-style-singleton-C1oTdtRg.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-DQWw4Coi.js";import"./use-callback-ref-DIudPNPV.js";import"./@floating-ui-VDk0qcgD.js";import"./use-sync-external-store-C4iHanJs.js";import"./class-variance-authority-DO3vQtTq.js";import"./lodash-DSAJ3Ow_.js";import"./immer-Dwi4ZIhD.js";import"./dayjs-BG2b1roC.js";import"./idb-keyval-PpvEIwUC.js";import"./fast-average-color-Dy3p1ZbH.js";import"./use-debounce-CVLZIJWc.js";import"./react-country-flag-DV3c0LTu.js";import"./react-hotkeys-hook-qKPfarcW.js";import"./equalizer-bars-BP_G2EY6.js";import"./cmdk-DpOb1GNg.js";import"./command-9rYDq5Wc.js";const oe=S()(U(k(D(e=>({data:{},dialogState:!1,confirmDeleteState:!1,setData:s=>{e(e=>{e.data=s})},setDialogState:s=>{e(e=>{e.dialogState=s})},setConfirmDeleteState:s=>{e(e=>{e.confirmDeleteState=s})}})),{name:"radios_store"}))),ie=()=>oe(e=>e);function le(){const{t:s}=C(),{setDialogState:a,setData:r}=ie();return e.jsxs("div",{className:"text-center max-w-[500px]",children:[e.jsx("h3",{className:"text-2xl font-semibold tracking-tight",children:s("radios.empty.title")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("radios.empty.info")}),e.jsx(c,{size:"sm",variant:"default",className:"mt-4",onClick:function(){r({}),a(!0)},children:e.jsx("span",{children:s("radios.addRadio")})})]})}const ne=L({name:O().min(3,{message:"radios.form.validations.name"}),homePageUrl:O().url({message:"radios.form.validations.url"}).min(10,{message:"radios.form.validations.homepageUrlLength"}).refine(e=>/^https?:\/\//.test(e),{message:"login.form.validations.protocol"}).or(_("")),streamUrl:O().url({message:"radios.form.validations.url"}).min(10,{message:"radios.form.validations.streamUrlLength"}).refine(e=>/^https?:\/\//.test(e),{message:"login.form.validations.protocol"})}),ce={name:"",homePageUrl:"",streamUrl:""};function me(){const{t:t}=C(),{data:o,setData:i,dialogState:l,setDialogState:n}=ie(),p=0===Object.keys(o).length,g=K({resolver:P(ne),defaultValues:ce});s.useEffect(()=>{p?g.reset(ce):g.reset({name:o.name??"",homePageUrl:o.homePageUrl??"",streamUrl:o.streamUrl??""})},[o,g,p]);const y=a(),b=r({mutationFn:f.radios.create,onSuccess:()=>{y.invalidateQueries({queryKey:[I.radio.all]}),q.success(t("radios.form.create.toast.success"))},onError:()=>{q.error(t("radios.form.create.toast.error"))}}),w=r({mutationFn:f.radios.update,onSuccess:()=>{y.invalidateQueries({queryKey:[I.radio.all]}),q.success(t("radios.form.edit.toast.success"))},onError:()=>{q.success(t("radios.form.edit.toast.error"))}});function v(){i({})}return e.jsx(m,{defaultOpen:!1,open:l,onOpenChange:e=>{e||v(),n(e)},children:e.jsx(d,{className:"max-w-[500px]","aria-describedby":void 0,children:e.jsx(z,{...g,children:e.jsxs("form",{onSubmit:g.handleSubmit(async function({name:e,homePageUrl:s,streamUrl:a}){p?await b.mutateAsync({name:e,homePageUrl:s,streamUrl:a}):await w.mutateAsync({id:o.id,name:e,homePageUrl:s,streamUrl:a}),n(!1),v()}),children:[e.jsx(j,{children:e.jsx(h,{children:t(`radios.form.${p?"create":"edit"}.title`)})}),e.jsxs("div",{className:"my-4 space-y-4",children:[e.jsx(F,{control:g.control,name:"name",render:({field:s})=>e.jsxs(A,{children:[e.jsx(E,{className:"required",children:t("radios.table.name")}),e.jsx(R,{children:e.jsx(x,{...s,id:"radio-name"})}),e.jsx(W,{})]})}),e.jsx(F,{control:g.control,name:"homePageUrl",render:({field:s})=>e.jsxs(A,{children:[e.jsx(E,{children:t("radios.table.homepage")}),e.jsx(R,{children:e.jsx(x,{...s,id:"radio-home-page-url",autoCorrect:"false",autoCapitalize:"false",spellCheck:"false"})}),e.jsx(W,{})]})}),e.jsx(F,{control:g.control,name:"streamUrl",render:({field:s})=>e.jsxs(A,{children:[e.jsx(E,{className:"required",children:t("radios.table.stream")}),e.jsx(R,{children:e.jsx(x,{...s,id:"radio-stream-url",autoCorrect:"false",autoCapitalize:"false",spellCheck:"false"})}),e.jsx(W,{})]})})]}),e.jsx(u,{children:e.jsx(c,{type:"submit",children:t(`radios.form.${p?"create":"edit"}.button`)})})]})})})})}function de(){const{t:s}=C(),{data:t,setData:o,confirmDeleteState:i,setConfirmDeleteState:l}=ie(),n=a(),c=r({mutationFn:f.radios.remove,onSuccess:()=>{n.invalidateQueries({queryKey:[I.radio.all]}),q.success(s("radios.form.delete.toast.success")),l(!1),o({})},onError:()=>{q.error(s("radios.form.delete.toast.error"))}});return e.jsx(B,{open:i,children:e.jsxs(H,{children:[e.jsxs(Q,{children:[e.jsx(T,{children:s("radios.form.delete.title")}),e.jsx(J,{children:s("radios.form.delete.description")})]}),e.jsxs(V,{children:[e.jsx(X,{onClick:()=>l(!1),children:s("logout.dialog.cancel")}),e.jsx(Y,{onClick:async function(e){e.preventDefault(),await c.mutateAsync(t.id)},children:s("logout.dialog.confirm")})]})]})})}function je({row:s}){const{t:a}=C(),{setDialogState:r,setData:t,setConfirmDeleteState:o}=ie();return e.jsx(G,{optionsMenuItems:e.jsxs(p,{children:[e.jsxs(g,{onClick:function(){t(s),r(!0)},children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:a("radios.table.actions.edit")})]}),e.jsxs(g,{onClick:async function(){t(s),o(!0)},children:[e.jsx(Z,{className:"mr-2 h-4 w-4 fill-red-300 text-red-500"}),e.jsx("span",{className:"text-red-500",children:a("radios.table.actions.delete")})]})]})})}function he({name:s}){const{isRadio:a}=y(),{radioList:r,currentSongIndex:t}=b();const i=!(!a||!r)&&r[t].name===s;return e.jsxs("div",{className:"flex gap-2 items-center min-w-[200px] 2xl:min-w-[350px]",children:[e.jsx("div",{className:"flex justify-center items-center w-[40px] h-[40px] min-w-[40px] min-h-[40px] rounded shadow bg-foreground/20 dark:bg-accent",children:e.jsx(ee,{className:"w-5 h-5 text-foreground",strokeWidth:1.75})}),e.jsx("div",{className:o("flex flex-col justify-center items-center",i&&"text-primary"),children:e.jsx("p",{children:s})})]})}function xe(){const{setDialogState:s,setData:a}=ie(),{t:r}=C(),{setPlayRadio:m}=w(),{data:d,isLoading:j}=t({queryKey:[I.radio.all],queryFn:f.radios.getAll}),h=[{id:"index",accessorKey:"index",style:{width:48,minWidth:"48px"},header:()=>e.jsx("div",{className:"w-full text-center",children:"#"}),cell:({row:s,table:a})=>{const r=s.index+1,t=s.original;return e.jsx(ae,{trackNumber:r,trackId:t.id,handlePlayButton:()=>a.options.meta?.handlePlaySong?.(s)})}},{id:"name",accessorKey:"name",enableSorting:!0,sortingFn:"customSortFn",style:{flex:1,minWidth:250},header:({column:s,table:a})=>e.jsx(re,{column:s,table:a,children:te.t("radios.table.name")}),cell:({row:s})=>e.jsx(he,{name:s.original.name})},{id:"homePageUrl",accessorKey:"homePageUrl",style:{width:"25%",maxWidth:"25%"},header:te.t("radios.table.homepage"),cell:({row:s})=>{const{homePageUrl:a}=s.original;return a?e.jsx("div",{className:"truncate",children:e.jsx("p",{className:"truncate text-primary",children:e.jsx("a",{href:a,target:"_blank",rel:"nofollow noreferrer",className:"hover:underline",children:a})})}):""}},{id:"streamUrl",accessorKey:"streamUrl",style:{width:"25%",maxWidth:"25%",marginRight:"1rem"},header:te.t("radios.table.stream"),cell:({row:s})=>e.jsx("div",{className:"truncate",children:e.jsx("p",{className:"truncate",children:s.original.streamUrl})})},{id:"actions",accessorKey:"actions",style:{width:48,maxWidth:48},header:"",cell:({row:s})=>e.jsx(je,{row:s.original})}];if(j)return e.jsx(v,{});const x=d&&d.length>0;return e.jsxs("div",{className:o("w-full","h-content"),children:[e.jsx(i,{showGlassEffect:!1,fixed:!1,className:"relative w-full justify-between items-center",children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(l,{title:r("sidebar.radios"),count:d?.length??0}),e.jsxs(c,{size:"sm",variant:"default",className:"px-4",onClick:function(){a({}),s(!0)},children:[e.jsx(se,{className:"w-5 h-5 -ml-[3px]"}),e.jsx("span",{className:"ml-2",children:r("radios.addRadio")})]})]})}),x&&e.jsx("div",{className:"w-full h-[calc(100%-80px)]",children:e.jsx($,{columns:h,data:d,handlePlaySong:e=>m(d,e.index),allowRowSelection:!1,dataType:"radio"})}),!x&&e.jsx(N,{className:"pt-[--shadow-header-distance] h-full",children:e.jsx(n,{children:e.jsx(le,{})})}),e.jsx(me,{}),e.jsx(de,{})]})}export{xe as default};
